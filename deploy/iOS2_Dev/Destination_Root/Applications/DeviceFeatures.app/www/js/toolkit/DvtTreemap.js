var DvtBaseTreemap=function(a,b,c){this.Init(a,b,c)};DvtObj.createSubclass(DvtBaseTreemap,DvtBaseTreeView,"DvtBaseTreemap");DvtBaseTreemap._BUFFER_SPACE=7;DvtBaseTreemap._MIN_BUFFER_SPACE=2;DvtBaseTreemap._BACKGROUND_FILL_COLOR="#EBEFF5";DvtBaseTreemap._BACKGROUND_BORDER_COLOR="#DBE0EA";DvtBaseTreemap._BACKGROUND_INLINE_DEFAULT="background-color:"+DvtBaseTreemap._BACKGROUND_FILL_COLOR+";border-color:"+DvtBaseTreemap._BACKGROUND_BORDER_COLOR+";border-width:2px";
DvtBaseTreemap.prototype.Init=function(a,b,c){DvtBaseTreemap.superclass.Init.call(this,a,b,c);this.Defaults=new DvtTreemapDefaults};DvtBaseTreemap.prototype.Parse=function(a){return(new DvtTreemapParser(this)).parse(a)};DvtBaseTreemap.prototype.ApplyParsedProperties=function(a){DvtBaseTreemap.superclass.ApplyParsedProperties.call(this,a);this._layout=a.layout;this._groupGaps=a.groupGaps;this._layout&&this._layout.setSorting(this.Sorting);this._isolatedNodes=[];this._processInitialIsolate(a.isolateRowKey)};
DvtBaseTreemap.prototype.Layout=function(a){var b=Math.max(Math.ceil(DvtBaseTreemap._BUFFER_SPACE*Math.min(a.w,a.h)/400),DvtBaseTreemap._MIN_BUFFER_SPACE);a.x+=b;a.y+=b;a.w-=2*b;a.h-=2*b;b=this._layout.getGapSize(this,1);a.x+=b;a.w-=2*b;this.LayoutBreadcrumbs(a);this.LayoutLegend(a);a.x-=b;a.w+=2*b;b=this._isolatedNodes.length;if(0<b&&this._isolateRestoreLayout)this._layout.layout(this,this._isolatedNodes[b-1],a.x,a.y,a.w,a.h,!0);else{this._root&&this._layout.layout(this,this._root,a.x,a.y,a.w,a.h,
!1);for(var c=0;c<b;c++)this._layout.layout(this,this._isolatedNodes[c],a.x,a.y,a.w,a.h,!0)}};
DvtBaseTreemap.prototype.Render=function(a){this.RenderBackground(a,DvtBaseTreemap._BACKGROUND_INLINE_DEFAULT);this.RenderBreadcrumbs(a);this.RenderLegend(a);if(this.HasValidData()){this._groupTextLayer=new DvtContainer(this.getCtx());a.addChild(this._groupTextLayer);this._isolatedNode?this._isolatedNode.render(a):this._root.hasChildren()?this._root.renderChildren(a):this._root.render(a);this._isolatedLayer=new DvtContainer(this.getCtx());a.addChild(this._isolatedLayer);this._selectedLayer=new DvtContainer(this.getCtx());
a.addChild(this._selectedLayer);a.addChild(this._groupTextLayer);this._hoverEffect=new DvtPolyline(this.getCtx(),[]);this._hoverEffect.setVisible(!1);this._hoverEffect.setMouseEnabled(!1);this._hoverEffect.setPixelHinting(!0);a.addChild(this._hoverEffect);for(a=0;a<this._isolatedNodes.length;a++)this._isolatedLayer.addChild(this._isolatedNodes[a].getDisplayable())}else this.RenderEmptyText(a)};
DvtBaseTreemap.prototype.OnAnimationEnd=function(){this.AnimationStopped||(this._container.removeChildren(),this.Layout(new DvtRectangle(0,0,this.Width,this.Height)),this.Render(this._container),this.ReselectNodes());DvtBaseTreemap.superclass.OnAnimationEnd.call(this)};
DvtBaseTreemap.prototype.ReselectNodes=function(){for(var a=this._selectionHandler?this._selectionHandler.getSelection():[],b=0;b<a.length;b++)if(0<this._isolatedNodes.length){var c=this._isolatedNodes[this._isolatedNodes.length-1];(a[b]==c||a[b].isDescendantOf(c))&&a[b].setSelected(!0)}else a[b].setSelected(!0)};DvtBaseTreemap.prototype.CreateKeyboardHandler=function(a){return new DvtTreemapKeyboardHandler(a)};
DvtBaseTreemap.prototype.CreateEventManager=function(a,b,c,d){return new DvtTreemapEventManager(a,b,c,d)};DvtBaseTreemap.prototype.GetInitialFocusedItem=function(a){var b=this.__getLastIsolatedNode();return b?this.__getDefaultNavigable(b.getLeafNodes()):a?this.__getDefaultNavigable(a.getLeafNodes()):null};DvtBaseTreemap.prototype.__showHoverEffect=function(a,b){this._hoverEffect.setPoints(a);this._hoverEffect.setStroke(b);this._hoverEffect.setVisible(!0)};
DvtBaseTreemap.prototype.__hideHoverEffect=function(){this._hoverEffect.setVisible(!1)};DvtBaseTreemap.prototype.__getGroupTextLayer=function(){return this._groupTextLayer};DvtBaseTreemap.prototype.__moveToSelectedLayer=function(a){for(var b=0,c=this._selectedLayer.getNumChildren(),d=0;d<c;d++){var e=this._selectedLayer.getChildAt(d);a.zIndex>e.zIndex&&(b=d+1)}b<c?this._selectedLayer.addChildAt(a,b):this._selectedLayer.addChild(a)};
DvtBaseTreemap.prototype.__getNodeUnderPoint=function(a,b){return 0<this._isolatedNodes.length?this._isolatedNodes[this._isolatedNodes.length-1].getNodeUnderPoint(a,b):this._root.getNodeUnderPoint(a,b)};
DvtBaseTreemap.prototype.__isolate=function(a){var b=this.__getEventManager().getFocus();b&&b.hideKeyboardFocusEffect();this._isolatedNodes.push(a);this.__dispatchEvent(new DvtTreemapIsolateEvent(a.getId()));this._isolateRestoreLayout=!0;this.Layout(new DvtRectangle(0,0,this.Width,this.Height));this._isolateRestoreLayout=!1;this._isolatedLayer.addChild(a.getDisplayable());this._renderIsolateRestore(a)};
DvtBaseTreemap.prototype.__restore=function(){var a=this._isolatedNodes.pop(),b=this.__getEventManager().getFocus();b&&b.hideKeyboardFocusEffect();this.__setNavigableIdToFocus(a.getId());this.__dispatchEvent(new DvtTreemapIsolateEvent);this._isolateRestoreLayout=!0;this.Layout(new DvtRectangle(0,0,this.Width,this.Height));this._isolateRestoreLayout=!1;this._renderIsolateRestore(a)};
DvtBaseTreemap.prototype.__getLastIsolatedNode=function(){return this._isolatedNodes&&0<this._isolatedNodes.length?this._isolatedNodes[this._isolatedNodes.length-1]:null};
DvtBaseTreemap.prototype._renderIsolateRestore=function(a){if(this.AnimationOnDataChange){for(var b=this._selectionHandler?this._selectionHandler.getSelection():[],c=0;c<b.length;c++)b[c].setSelected(!1);a=a.getIsolateAnimation();this.Animation=new DvtParallelPlayable(this.getCtx(),a);this.Animation.setOnEnd(this.OnAnimationEnd,this);this._eventHandler.removeListeners(this);this.Animation.play()}else this.render(null,this.Width,this.Height,!0)};
DvtBaseTreemap.prototype._processInitialIsolate=function(a){if(a&&this._root){var b=this._root.getDescendantNodes();b.push(this._root);for(var c=0;c<b.length;c++)if(b[c].getId()==a){this._isolatedNodes.push(b[c]);break}}};DvtBaseTreemap.prototype.__getGroupGaps=function(){return this._groupGaps};DvtBaseTreemap.prototype.__getDefaultNavigable=function(a){var b=this._eventHandler.getKeyboardHandler();return b?b.getDefaultNavigable(a):a&&0<a.length?a[0]:null};
DvtBaseTreemap.prototype.getShapesForViewSwitcher=function(a){var b={};if(this._root)for(var c=[this._root];0<c.length;){var d=c.splice(0,1)[0],e=d.getId(),g=d.getDisplayable();if(e&&g&&(b[e]=g,b[e+"_text"]=d._text,d._borderTL&&(b[e+"_borderTL"]=d._borderTL),d._borderBR&&(b[e+"_borderBR"]=d._borderBR),d._border&&(b[e+"_border"]=d._border),a&&(e=d.GetParent()))){var h=e.getDisplayable(),e=null;if(e=h?h.getParent():this._container)h=e.getChildIndex(h),d._border&&e.addChildAt(d._border,h+1),d._borderBR&&
e.addChildAt(d._borderBR,h+1),d._borderTL&&e.addChildAt(d._borderTL,h+1),d._text&&e.addChildAt(d._text,h+1),e.addChildAt(g,h+1)}(d=d.getChildNodes())&&(c=c.concat(d))}return b};var DvtTreemap=function(){};DvtObj.createSubclass(DvtTreemap,DvtBaseTreemap,"DvtTreemap");DvtTreemap.newInstance=function(a,b,c){var d=new DvtTreemap;d.Init(a,b,c);return d};DvtTreemap.getDefaults=function(a){return(new DvtTreemapDefaults).getDefaults(a)};
DvtTreemap.prototype.render=function(a,b,c,d){a?(this.Options=this.Defaults.calcOptions(a),DvtAgent.isEnvironmentBrowser()||(this.Options.animationOnDisplay="none",this.Options.animationOnDataChange="none")):this.Options||(this.Options=this.GetDefaults());a=d?null:(new DvtTreemapJsonUtils(this.getCtx())).toXml(this.Options);DvtTreemap.superclass.render.call(this,a,b,c)};var DvtTreemapParser=function(a){this.Init(a)};DvtObj.createSubclass(DvtTreemapParser,DvtBaseTreeParser,"DvtTreemapParser");
DvtTreemapParser.ATTR_LAYOUT="layout";DvtTreemapParser.ATTR_GROUP_GAPS="gg";DvtTreemapParser.ATTR_ISOLATE_ROW_KEY="irk";DvtTreemapParser.LAYOUT_SQUARIFY="s";DvtTreemapParser.LAYOUT_SLICE_AND_DICE_HORIZ="h";DvtTreemapParser.LAYOUT_SLICE_AND_DICE_VERT="v";DvtTreemapParser.ATTR_GROUP_LABEL_DISPLAY="gld";DvtTreemapParser.ATTR_LABEL_H_ALIGN="ha";DvtTreemapParser.ATTR_LABEL_V_ALIGN="va";DvtTreemapParser.ATTR_HEADER_TITLE_H_ALIGN="hha";DvtTreemapParser.ATTR_HEADER_LABEL_STYLE="hls";
DvtTreemapParser.ATTR_HEADER_ISOLATE="hi";DvtTreemapParser.ATTR_HEADER_USE_NODE_COLOR="unc";DvtTreemapParser.GROUP_GAPS_ALL="a";DvtTreemapParser.GROUP_GAPS_OUTER="o";DvtTreemapParser.GROUP_GAPS_NONE="n";DvtTreemapParser.prototype.CreateNode=function(a,b,c){return new DvtTreemapNode(a,b,c)};
DvtTreemapParser.prototype.ParseRootAttributes=function(a){var b=DvtTreemapParser.superclass.ParseRootAttributes.call(this,a),c=a.getAttr(DvtTreemapParser.ATTR_LAYOUT);b.layout=c==DvtTreemapParser.LAYOUT_SLICE_AND_DICE_HORIZ?new DvtSliceAndDiceLayout(!0):c==DvtTreemapParser.LAYOUT_SLICE_AND_DICE_VERT?new DvtSliceAndDiceLayout(!1):new DvtSquarifyingLayout;b.groupGaps=a.getAttr(DvtTreemapParser.ATTR_GROUP_GAPS);b.groupGaps||(b.groupGaps=DvtTreemapParser.GROUP_GAPS_OUTER);b.isolateRowKey=a.getAttr(DvtTreemapParser.ATTR_ISOLATE_ROW_KEY);
this._isolateRowKey=b.isolateRowKey;return b};
DvtTreemapParser.prototype.ParseNodeAttributes=function(a){var b=DvtTreemapParser.superclass.ParseNodeAttributes.call(this,a);b.groupLabelDisplay=a.getAttr(DvtTreemapParser.ATTR_GROUP_LABEL_DISPLAY);b.labelHalign=a.getAttr(DvtTreemapParser.ATTR_LABEL_H_ALIGN);b.labelValign=a.getAttr(DvtTreemapParser.ATTR_LABEL_V_ALIGN);b.isolate=a.getAttr(DvtTreemapParser.ATTR_HEADER_ISOLATE);b.headerUseNodeColor=a.getAttr(DvtTreemapParser.ATTR_HEADER_USE_NODE_COLOR);b.headerHalign=a.getAttr(DvtTreemapParser.ATTR_HEADER_TITLE_H_ALIGN);
if(a=a.getAttr(DvtTreemapParser.ATTR_HEADER_LABEL_STYLE))b.headerLabelStyle=new DvtCSSStyle(a);this._isolateRowKey==b.id&&(b.isIsolated=!0);return b};DvtTreemapParser.prototype.ParseAdditionalNodeStyles=function(a,b,c,d){d[DvtTreemapNode.NODE_HOVER_COLOR_STYLE]=b.getStyle("border-color");d[DvtTreemapNode.NODE_SELECTED_OUTER_COLOR_STYLE]=c.getStyle(DvtCSSStyle.OUTER_COLOR);d[DvtTreemapNode.NODE_SELECTED_INNER_COLOR_STYLE]=c.getStyle(DvtCSSStyle.INNER_COLOR)};
DvtTreemapParser.prototype.ParseAdditionalStyles=function(a,b){var c=new DvtCSSStyle(a.getAttr("nodeHeader"));b[DvtTreemapNode.HEADER_TEXT_DEFAULT_STYLE]=c;b[DvtTreemapNode.HEADER_BACKGROUND_STYLE]=c;var d=c.clone().merge(new DvtCSSStyle(a.getAttr("nodeHeader-hover")));b[DvtTreemapNode.HEADER_TEXT_HOVER_DEFAULT_STYLE]=d;b[DvtTreemapNode.HEADER_BACKGROUND_HOVER_STYLE]=d;var e=c.clone().merge(new DvtCSSStyle(a.getAttr("nodeHeader-selected")));b[DvtTreemapNode.HEADER_TEXT_SELECTED_DEFAULT_STYLE]=e;b[DvtTreemapNode.HEADER_BACKGROUND_SELECTED_STYLE]=
e;c=c.clone().merge(new DvtCSSStyle(a.getAttr("nodeHeaderDrill")));b[DvtTreemapNode.HEADER_DRILL_TEXT_DEFAULT_STYLE]=c;b[DvtTreemapNode.HEADER_DRILL_TEXT_HOVER_DEFAULT_STYLE]=c.clone().merge(new DvtCSSStyle(a.getAttr("nodeHeaderDrill-hover")));b[DvtTreemapNode.HEADER_DRILL_TEXT_SELECTED_DEFAULT_STYLE]=c.clone().merge(new DvtCSSStyle(a.getAttr("nodeHeaderDrill-selected")));b[DvtTreemapNode.HEADER_HOVER_OUTER_COLOR_STYLE]=d.getStyle(DvtCSSStyle.OUTER_COLOR);b[DvtTreemapNode.HEADER_HOVER_INNER_COLOR_STYLE]=
d.getStyle(DvtCSSStyle.INNER_COLOR);b[DvtTreemapNode.HEADER_SELECTED_OUTER_COLOR_STYLE]=e.getStyle(DvtCSSStyle.OUTER_COLOR);b[DvtTreemapNode.HEADER_SELECTED_INNER_COLOR_STYLE]=e.getStyle(DvtCSSStyle.INNER_COLOR)};
var DvtTreemapNode=function(a,b,c){this.Init(a,b,c);this._labelDisplay=b.labelDisplay?b.labelDisplay:DvtTreemapNode.DEFAULT_LABEL_DISPLAY;this._groupLabelDisplay=b.groupLabelDisplay?b.groupLabelDisplay:DvtTreemapNode.DEFAULT_GROUP_LABEL_DISPLAY;this._labelHalign=b.labelHalign?b.labelHalign:DvtTreemapNode.DEFAULT_NODE_H_ALIGN;this._labelValign=b.labelValign?b.labelValign:DvtTreemapNode.DEFAULT_NODE_V_ALIGN;this._headerHalign=b.headerHalign?b.headerHalign:DvtTreemapNode.DEFAULT_HEADER_H_ALIGN;this._headerLabelStyle=
b.headerLabelStyle;this._headerUseNodeColor="on"==b.headerUseNodeColor;this._isolate=b.isolate?b.isolate:"on";this._isIsolated=b.isIsolated};DvtObj.createSubclass(DvtTreemapNode,DvtBaseTreeNode,"DvtTreemapNode");DvtTreemapNode.TEXT_STYLE_HEADER="h";DvtTreemapNode.TEXT_STYLE_NODE="n";DvtTreemapNode.TEXT_STYLE_OFF="o";DvtTreemapNode.DEFAULT_LABEL_DISPLAY=DvtTreemapNode.TEXT_STYLE_NODE;DvtTreemapNode.DEFAULT_GROUP_LABEL_DISPLAY=DvtTreemapNode.TEXT_STYLE_HEADER;DvtTreemapNode.LABEL_ALIGN_CENTER="c";
DvtTreemapNode.LABEL_ALIGN_START="s";DvtTreemapNode.LABEL_ALIGN_END="e";DvtTreemapNode.LABEL_ALIGN_TOP="t";DvtTreemapNode.LABEL_ALIGN_BOTTOM="b";DvtTreemapNode.DEFAULT_NODE_H_ALIGN=DvtTreemapNode.LABEL_ALIGN_CENTER;DvtTreemapNode.DEFAULT_NODE_V_ALIGN=DvtTreemapNode.LABEL_ALIGN_CENTER;DvtTreemapNode.DEFAULT_HEADER_H_ALIGN=DvtTreemapNode.LABEL_ALIGN_START;DvtTreemapNode._DEFAULT_HEADER_TEXT_COLOR="#003D5B";DvtTreemapNode._HEADER_DRILLABLE_TEXT_COLOR="#003286";
DvtTreemapNode._HEADER_HOVER_TEXT_COLOR="#000000";DvtTreemapNode._HEADER_SELECTED_TEXT_COLOR=DvtTreemapNode._DEFAULT_HEADER_TEXT_COLOR;DvtTreemapNode._HEADER_TEXT_STYLE="font-weight:bold;";DvtTreemapNode.TEXT_BUFFER_HORIZ=4;DvtTreemapNode.TEXT_BUFFER_VERT=2;DvtTreemapNode.MIN_TEXT_BUFFER=2;DvtTreemapNode._LINE_FUDGE_FACTOR=1;DvtTreemapNode._ANIMATION_ISOLATE_DURATION=0.3;DvtTreemapNode._MIN_TITLE_BAR_HEIGHT=15;DvtTreemapNode._MIN_TITLE_BAR_HEIGHT_ISOLATE=15;
DvtTreemapNode.DEFAULT_HEADER_FILL_COLOR="#FFFFFF";DvtTreemapNode.DEFAULT_HEADER_BORDER_COLOR="#E1E6EE";DvtTreemapNode.DEFAULT_HEADER_BORDER_WIDTH=1;DvtTreemapNode.DEFAULT_HEADER_WITH_NODE_COLOR_ALPHA=0.5;DvtTreemapNode._ISOLATE_ICON_SIZE=12;DvtTreemapNode._ISOLATE_GAP_SIZE=1;DvtTreemapNode._ISOLATE_TOUCH_BUFFER=2;DvtTreemapNode.DEFAULT_HEADER_INLINE_STYLE="background-color:"+DvtTreemapNode.DEFAULT_HEADER_FILL_COLOR+";border-color:"+DvtTreemapNode.DEFAULT_HEADER_BORDER_COLOR+";";
DvtTreemapNode.DEFAULT_NODE_TOP_BORDER_COLOR="#FFFFFF";DvtTreemapNode.DEFAULT_NODE_BOTTOM_BORDER_COLOR="#000000";DvtTreemapNode.DEFAULT_NODE_BORDER_WIDTH=1;DvtTreemapNode.DEFAULT_NODE_BORDER_OPACITY=0.3;DvtTreemapNode.DEFAULT_NODE_PATTERN_BORDER_OPACITY=0.15;DvtTreemapNode.MIN_SIZE_FOR_BORDER=2*DvtTreemapNode.DEFAULT_NODE_BORDER_WIDTH;DvtTreemapNode.HEADER_HOVER_FILL_COLOR="#C4DCFF";DvtTreemapNode.DEFAULT_HEADER_HOVER_INLINE_STYLE="background-color:"+DvtTreemapNode.HEADER_HOVER_FILL_COLOR+";";
DvtTreemapNode.HEADER_SELECTED_FILL_COLOR="#9CACC9";DvtTreemapNode.DEFAULT_HEADER_SELECTED_INLINE_STYLE="background-color:"+DvtTreemapNode.HEADER_SELECTED_FILL_COLOR+";";DvtTreemapNode.GROUP_HOVER_OUTER_COLOR="#00AEFF";DvtTreemapNode.GROUP_HOVER_OUTER_OPACITY="1";DvtTreemapNode.GROUP_HOVER_INNER_COLOR="#C4DCFF";DvtTreemapNode.GROUP_HOVER_INNER_OPACITY=0.8;DvtTreemapNode.GROUP_HOVER_INNER_WIDTH=3;DvtTreemapNode.GROUP_SELECTED_OUTER_COLOR="#000000";DvtTreemapNode.GROUP_SELECTED_INNER_COLOR="#FFFFFF";
DvtTreemapNode.GROUP_SELECTED_OPACITY=1;DvtTreemapNode.NODE_HOVER_COLOR="#FFFFFF";DvtTreemapNode.NODE_HOVER_OPACITY=1;DvtTreemapNode.NODE_SELECTED_OUTER_COLOR="#000000";DvtTreemapNode.NODE_SELECTED_OUTER_OPACITY=1;DvtTreemapNode.NODE_SELECTED_INNER_COLOR="#FFFFFF";DvtTreemapNode.NODE_SELECTED_INNER_OPACITY=1;DvtTreemapNode.NODE_SELECTION_WIDTH=2;DvtTreemapNode.NODE_HOVER_COLOR_STYLE="NODE_HOVER_COLOR";DvtTreemapNode.NODE_SELECTED_OUTER_COLOR_STYLE="NODE_SELECTED_OUTER_COLOR";
DvtTreemapNode.NODE_SELECTED_INNER_COLOR_STYLE="NODE_SELECTED_INNER_COLOR";DvtTreemapNode.HEADER_TEXT_DEFAULT_STYLE="HEADER_TEXT_DEFAULT_STYLE";DvtTreemapNode.HEADER_TEXT_HOVER_DEFAULT_STYLE="HEADER_TEXT_HOVER_DEFAULT_STYLE";DvtTreemapNode.HEADER_TEXT_SELECTED_DEFAULT_STYLE="HEADER_TEXT_SELECTED_DEFAULT_STYLE";DvtTreemapNode.HEADER_DRILL_TEXT_DEFAULT_STYLE="HEADER_DRILL_TEXT_DEFAULT_STYLE";DvtTreemapNode.HEADER_DRILL_TEXT_HOVER_DEFAULT_STYLE="HEADER_DRILL_TEXT_HOVER_DEFAULT_STYLE";
DvtTreemapNode.HEADER_DRILL_TEXT_SELECTED_DEFAULT_STYLE="HEADER_DRILL_TEXT_SELECTED_DEFAULT_STYLE";DvtTreemapNode.HEADER_BACKGROUND_STYLE="HEADER_BACKGROUND_STYLE";DvtTreemapNode.HEADER_BACKGROUND_HOVER_STYLE="HEADER_BACKGROUND_HOVER_STYLE";DvtTreemapNode.HEADER_BACKGROUND_SELECTED_STYLE="HEADER_BACKGROUND_SELECTED_STYLE";DvtTreemapNode.HEADER_HOVER_OUTER_COLOR_STYLE="HEADER_HOVER_OUTER_COLOR_STYLE";DvtTreemapNode.HEADER_HOVER_INNER_COLOR_STYLE="HEADER_HOVER_INNER_COLOR_STYLE";
DvtTreemapNode.HEADER_SELECTED_OUTER_COLOR_STYLE="HEADER_SELECTED_OUTER_COLOR_STYLE";DvtTreemapNode.HEADER_SELECTED_INNER_COLOR_STYLE="HEADER_SELECTED_INNER_COLOR_STYLE";DvtTreemapNode.LEAF_NODE_TOP_BORDER_COLOR_STYLE="LEAF_NODE_TOP_BORDER_COLOR_STYLE";DvtTreemapNode.LEAF_NODE_BOTTOM_BORDER_COLOR_STYLE="LEAF_NODE_BOTTOM_BORDER_COLOR_STYLE";
DvtTreemapNode.prototype.render=function(a){if(this._hasLayout){this._shape=this._createShapeNode();a.addChild(this._shape);var b;this.hasChildren()?(this._childNodeGroup=new DvtContainer(this.getView().getCtx()),this._shape.addChild(this._childNodeGroup),this.renderChildren(this._childNodeGroup)):b=this.GetTemplate();if(b){var c=this.GetElAttributes(),d=this.GetAfContext();d.setELContext(c);var c=DvtTreemapNode.DEFAULT_NODE_BORDER_WIDTH+DvtTreemapNode._LINE_FUDGE_FACTOR,e=DvtTreemapNode.TEXT_BUFFER_HORIZ,
g=DvtTreemapNode.TEXT_BUFFER_VERT,h=this._width-2*e-c,k=this._height-2*g-c;0<h&&0<k&&(d.setAvailableWidth(h),d.setAvailableHeight(k),d.setFontSize(this.GetTextSize()),this._contentRoot=b=DvtAfComponentFactory.parseAndLayout(d,b,this._shape),DvtAgent.isRightToLeft(a.getCtx())?(a=b.getDimensions(),a=this._x+this._width-e-0.5*c-a.w):a=this._x+e+0.5*c,b.setTranslate(a,this._y+g+0.5*c))}else this._text=this._createTextNode(this._shape),null!=this._text&&this._pattern&&this._textStyle!=DvtTreemapNode.TEXT_STYLE_HEADER&&
(c=this._text.measureDimensions(),this._textBackground=new DvtRect(this.getView().getCtx(),c.x,c.y,c.w,c.h),this._textBackground.setSolidFill("#FFFFFF"),this._textBackground.setMouseEnabled(!1),this._shape.addChild(this._textBackground),this._addChildText(this._text));this._shape.setAriaRole("img");this._shape.setAriaProperty("label",this._datatip)}};
DvtTreemapNode.prototype.setSelected=function(a){if("off"!=this.Selectable&&(DvtTreemapNode.superclass.setSelected.call(this,a),this._shape))if(this.isSelected()){var a=this._x,b=this._y+DvtTreemapNode._LINE_FUDGE_FACTOR,c=this._width-DvtTreemapNode._LINE_FUDGE_FACTOR,d=this._height-DvtTreemapNode._LINE_FUDGE_FACTOR;DvtAgent.isPlatformWebkit()&&(b-=DvtTreemapNode._LINE_FUDGE_FACTOR);this._removeChildShape(this._selectionOuter);this._removeChildShape(this._selectionInner);this._selectionInner=this._selectionOuter=
null;this._selectionOuter=new DvtRect(this.getView().getCtx(),a,b,c,d);this._selectionOuter.setMouseEnabled(!1);this._selectionOuter.setFill(null);this._selectionOuter.setPixelHinting(!0);this._shape.addChild(this._selectionOuter);this._selectionInner=new DvtRect(this.getView().getCtx(),a+1,b+1,c-2,d-2);this._selectionInner.setMouseEnabled(!1);this._selectionInner.setFill(null);this._selectionInner.setPixelHinting(!0);this._shape.addChild(this._selectionInner);this._textStyle==DvtTreemapNode.TEXT_STYLE_HEADER?
(this.IsHover||this.isShowingKeyboardFocusEffect()?this.ApplyHeaderStyle(this._shape,this._innerShape,DvtTreemapNode.DEFAULT_HEADER_HOVER_INLINE_STYLE,DvtTreemapNode.HEADER_BACKGROUND_HOVER_STYLE):(this.ApplyHeaderStyle(this._shape,this._innerShape,DvtTreemapNode.DEFAULT_HEADER_SELECTED_INLINE_STYLE,DvtTreemapNode.HEADER_BACKGROUND_SELECTED_STYLE),this._text&&this.ApplyHeaderTextStyle(this._text,DvtTreemapNode.HEADER_TEXT_SELECTED_DEFAULT_STYLE,DvtTreemapNode._HEADER_SELECTED_TEXT_COLOR)),this._selectionOuter.setSolidStroke(this.getResolvedColor(DvtTreemapNode.GROUP_SELECTED_OUTER_COLOR,
DvtTreemapNode.HEADER_SELECTED_OUTER_COLOR_STYLE),DvtTreemapNode.GROUP_SELECTED_OPACITY),this._selectionInner.setSolidStroke(this.getResolvedColor(DvtTreemapNode.GROUP_SELECTED_INNER_COLOR,DvtTreemapNode.HEADER_SELECTED_INNER_COLOR_STYLE),DvtTreemapNode.GROUP_SELECTED_OPACITY)):(this._selectionOuter.setSolidStroke(this.getResolvedColor(DvtTreemapNode.NODE_SELECTED_OUTER_COLOR,DvtTreemapNode.NODE_SELECTED_OUTER_COLOR_STYLE),DvtTreemapNode.NODE_SELECTED_OUTER_OPACITY),this._selectionInner.setSolidStroke(this.getResolvedColor(DvtTreemapNode.NODE_SELECTED_INNER_COLOR,
DvtTreemapNode.NODE_SELECTED_INNER_COLOR_STYLE),DvtTreemapNode.NODE_SELECTED_INNER_OPACITY),DvtAgent.isBrowserSafari()||this._shape.addDrawEffect(DvtBaseTreeNode.__NODE_SELECTED_SHADOW),this.getView().__moveToSelectedLayer(this._shape))}else this._removeChildShape(this._selectionInner),this._selectionInner=null,this._textStyle==DvtTreemapNode.TEXT_STYLE_HEADER?(this.IsHover||this.isShowingKeyboardFocusEffect()?this.ApplyHeaderStyle(this._shape,this._innerShape,DvtTreemapNode.DEFAULT_HEADER_HOVER_INLINE_STYLE,
DvtTreemapNode.HEADER_BACKGROUND_HOVER_STYLE):(this.ApplyHeaderStyle(this._shape,this._innerShape,DvtTreemapNode.DEFAULT_HEADER_INLINE_STYLE,DvtTreemapNode.HEADER_BACKGROUND_STYLE),this._text&&(this.isDrillReplaceEnabled()?this.ApplyHeaderTextStyle(this._text,DvtTreemapNode.HEADER_TEXT_DEFAULT_STYLE,DvtTreemapNode._HEADER_DRILLABLE_TEXT_COLOR):this.ApplyHeaderTextStyle(this._text,DvtTreemapNode.HEADER_TEXT_DEFAULT_STYLE,DvtTreemapNode._DEFAULT_HEADER_TEXT_COLOR))),this._selectionOuter&&(this.IsHover||
this.isShowingKeyboardFocusEffect()?this._selectionOuter.setSolidStroke(this.getResolvedColor(DvtTreemapNode.GROUP_HOVER_OUTER_COLOR,DvtTreemapNode.HEADER_HOVER_OUTER_COLOR_STYLE),DvtTreemapNode.GROUP_HOVER_OUTER_OPACITY):(this._removeChildShape(this._selectionOuter),this._selectionOuter=null))):(this._shape.removeAllDrawEffects(),this._selectionOuter&&(this._removeChildShape(this._selectionOuter),this._selectionOuter=null),(a=this.GetParent())&&a._childNodeGroup&&a._childNodeGroup.addChild(this._shape))};
DvtTreemapNode.prototype.showHoverEffect=function(){if(this._shape&&this._hasLayout){var a=this._view.__getLastIsolatedNode();if(!(null!=a&&a!=this&&!this.isDescendantOf(a))){var a=[],b,c,d,e;this._textStyle==DvtTreemapNode.TEXT_STYLE_HEADER?(this.ApplyHeaderStyle(this._shape,this._innerShape,DvtTreemapNode.DEFAULT_HEADER_HOVER_INLINE_STYLE,DvtTreemapNode.HEADER_BACKGROUND_HOVER_STYLE),this._selectionOuter||(b=this._x,c=this._y+DvtTreemapNode._LINE_FUDGE_FACTOR,d=this._width-DvtTreemapNode._LINE_FUDGE_FACTOR,
e=this._height-DvtTreemapNode._LINE_FUDGE_FACTOR,DvtAgent.isPlatformWebkit()&&(c-=DvtTreemapNode._LINE_FUDGE_FACTOR),this._selectionOuter=new DvtRect(this.getView().getCtx(),b,c,d,e),this._selectionOuter.setMouseEnabled(!1),this._selectionOuter.setFill(null),this._selectionOuter.setPixelHinting(!0),this._shape.addChild(this._selectionOuter)),this.isSelected()?this._selectionOuter.setSolidStroke(this.getResolvedColor(DvtTreemapNode.GROUP_SELECTED_OUTER_COLOR,DvtTreemapNode.HEADER_SELECTED_OUTER_COLOR_STYLE),
DvtTreemapNode.GROUP_SELECTED_OUTER_OPACITY):this._selectionOuter.setSolidStroke(this.getResolvedColor(DvtTreemapNode.GROUP_HOVER_OUTER_COLOR,DvtTreemapNode.HEADER_HOVER_OUTER_COLOR_STYLE),DvtTreemapNode.GROUP_HOVER_OUTER_OPACITY),b=this._x+DvtTreemapNode.GROUP_HOVER_INNER_WIDTH/2+DvtTreemapNode._LINE_FUDGE_FACTOR,d=this._x+this._width-DvtTreemapNode.GROUP_HOVER_INNER_WIDTH/2-DvtTreemapNode._LINE_FUDGE_FACTOR,c=this._y+this._titleBarHeight,e=this._y+this._height-DvtTreemapNode.GROUP_HOVER_INNER_WIDTH/
2-DvtTreemapNode._LINE_FUDGE_FACTOR,a.push(d,c,d,e,b,e,b,c),b=new DvtSolidStroke(this.getResolvedColor(DvtTreemapNode.GROUP_HOVER_INNER_COLOR,DvtTreemapNode.HEADER_HOVER_INNER_COLOR_STYLE),DvtTreemapNode.GROUP_HOVER_INNER_OPACITY,DvtTreemapNode.GROUP_HOVER_INNER_WIDTH),this._text&&(this.isDrillReplaceEnabled()?this.ApplyHeaderTextStyle(this._text,DvtTreemapNode.HEADER_DRILL_TEXT_HOVER_DEFAULT_STYLE,DvtTreemapNode._HEADER_HOVER_TEXT_COLOR):this.ApplyHeaderTextStyle(this._text,DvtTreemapNode.HEADER_TEXT_HOVER_DEFAULT_STYLE,
DvtTreemapNode._HEADER_HOVER_TEXT_COLOR))):(b=this._x+DvtTreemapNode.NODE_SELECTION_WIDTH/2,d=this._x+this._width-DvtTreemapNode.NODE_SELECTION_WIDTH/2,c=this._y+DvtTreemapNode.NODE_SELECTION_WIDTH/2,e=this._y+this._height-DvtTreemapNode.NODE_SELECTION_WIDTH/2,a.push(this._x,c,d,c,d,e,b,e,b,c),b=new DvtSolidStroke(this.getResolvedColor(DvtTreemapNode.NODE_HOVER_COLOR,DvtTreemapNode.NODE_HOVER_COLOR_STYLE),DvtTreemapNode.NODE_HOVER_OPACITY,DvtTreemapNode.NODE_SELECTION_WIDTH));this.getView().__showHoverEffect(a,
b,this)}}};
DvtTreemapNode.prototype.hideHoverEffect=function(){this._shape&&this._hasLayout&&(this._textStyle==DvtTreemapNode.TEXT_STYLE_HEADER&&(this.isSelected()?(this.ApplyHeaderStyle(this._shape,this._innerShape,DvtTreemapNode.DEFAULT_HEADER_SELECTED_INLINE_STYLE,DvtTreemapNode.HEADER_BACKGROUND_SELECTED_STYLE),this._selectionOuter.setSolidStroke(this.getResolvedColor(DvtTreemapNode.GROUP_SELECTED_OUTER_COLOR,DvtTreemapNode.HEADER_SELECTED_OUTER_COLOR_STYLE),DvtTreemapNode.GROUP_SELECTED_OUTER_OPACITY),this._text&&
(this.isDrillReplaceEnabled()?this.ApplyHeaderTextStyle(this._text,DvtTreemapNode.HEADER_DRILL_TEXT_SELECTED_DEFAULT_STYLE,DvtTreemapNode._HEADER_SELECTED_TEXT_COLOR):this.ApplyHeaderTextStyle(this._text,DvtTreemapNode.HEADER_TEXT_SELECTED_DEFAULT_STYLE,DvtTreemapNode._HEADER_SELECTED_TEXT_COLOR))):(this.ApplyHeaderStyle(this._shape,this._innerShape,DvtTreemapNode.DEFAULT_HEADER_INLINE_STYLE,DvtTreemapNode.HEADER_BACKGROUND_STYLE),this._selectionOuter&&(this._shape.removeChild(this._selectionOuter),
this._selectionOuter=null),this._text&&(this.isDrillReplaceEnabled()?this.ApplyHeaderTextStyle(this._text,DvtTreemapNode.HEADER_DRILL_TEXT_DEFAULT_STYLE,DvtTreemapNode._HEADER_DRILLABLE_TEXT_COLOR):this.ApplyHeaderTextStyle(this._text,DvtTreemapNode.HEADER_TEXT_DEFAULT_STYLE,DvtTreemapNode._DEFAULT_HEADER_TEXT_COLOR)))),this.getView().__hideHoverEffect())};DvtTreemapNode.prototype.isIsolateEnabled=function(){return"on"==this._isolate&&this._textStyle==DvtTreemapNode.TEXT_STYLE_HEADER};
DvtTreemapNode.prototype.getPopupBounds=function(a){return!a||!a.getAlign()?DvtTreemapNode.superclass.getPopupBounds.call(this,a):new DvtRectangle(this._x,this._y,this._width,this._height)};
DvtTreemapNode.prototype.getNextNavigable=function(a){var b;if(a.type==DvtMouseEvent.CLICK)return DvtTreemapNode.superclass.getNextNavigable.call(this,a);b=a.keyCode;if(b==DvtKeyboardEvent.SPACE&&a.ctrlKey)return this;if(b==DvtKeyboardEvent.UP_ARROW&&a.altKey||b==DvtKeyboardEvent.CLOSE_BRACKET)(b=this.GetParent())&&b.getId()!=this.getView().getRootNode().getId()?(a=b,b.MarkAsLastVisitedChild()):a=this;else if(b==DvtKeyboardEvent.DOWN_ARROW&&a.altKey||b==DvtKeyboardEvent.OPEN_BRACKET)a=(a=this.GetLastVisitedChild())?
a:this.hasChildren()?this.getView().__getDefaultNavigable(this.getChildNodes()):this;else{var c=this.getView().__getLastIsolatedNode(),d=0;if(c)if(this==c)d=0;else{b=this.GetParent();for(d=1;c!=b;)d++,b=b.GetParent()}else{for(c=this;c.GetParent();)c=c.GetParent();d=this.GetDepth()}b=this.GetNodesAtDepth(c,d);a=DvtKeyboardHandler.getNextNavigable(this,a,b)}a.MarkAsLastVisitedChild();return a};
DvtTreemapNode.prototype.getKeyboardBoundingBox=function(){return new DvtRectangle(this._x,this._y,this._width,this._height)};DvtTreemapNode.prototype.setZIndex=function(a){this._zIndex=a};
DvtTreemapNode.prototype.setLayoutParams=function(a,b,c,d){if(!(0>=c||0>=d)){this._hasLayout=!0;this._oldState=this.GetAnimationParams();this._x=a;this._y=b;this._width=c?c:0;this._height=d?d:0;this._textStyle=this.hasChildren()?this._groupLabelDisplay:this._labelDisplay;this._textStr||(this._textStyle=DvtTreemapNode.TEXT_STYLE_OFF);if(this._textStyle==DvtTreemapNode.TEXT_STYLE_HEADER){this._titleBarHeight=DvtTreemapNode._MIN_TITLE_BAR_HEIGHT;a=new DvtOutputText(this.getView().getCtx(),this._textStr);
a.setFontSize(this.GetTextSize());this.ApplyHeaderTextStyle(a,DvtTreemapNode.HEADER_TEXT_DEFAULT_STYLE,DvtTreemapNode._DEFAULT_HEADER_TEXT_COLOR);a=DvtTextUtils.guessTextDimensions(a).h;this._titleBarHeight=Math.max(this._titleBarHeight,a);this.isIsolateEnabled()&&(this._titleBarHeight=Math.max(this._titleBarHeight,DvtTreemapNode._MIN_TITLE_BAR_HEIGHT_ISOLATE));a=this._x;b=this._y+this._titleBarHeight;c=this._width;d=this._height-this._titleBarHeight;if(0<=c&&0<=d)return new DvtRectangle(a,b,c,d);
this._textStyle=null}return new DvtRectangle(this._x,this._y,this._width,this._height)}};DvtTreemapNode.prototype.getNodeUnderPoint=function(a,b){if(this.contains(a,b)||!this._hasLayout){for(var c=this.getChildNodes(),d=0;d<c.length;d++)if(c[d].contains(a,b))return c[d].getNodeUnderPoint(a,b);if(this._hasLayout)return this}return null};DvtTreemapNode.prototype.contains=function(a,b){return a>=this._x&&a<=this._x+this._width&&b>=this._y&&b<=this._y+this._height};
DvtTreemapNode.prototype.GetAnimationParams=function(){var a=DvtColorUtils.getRed(this._color),b=DvtColorUtils.getGreen(this._color),c=DvtColorUtils.getBlue(this._color);return[this._x,this._y,this._width,this._height,a,b,c,this.hasChildren()?0:Math.random()]};DvtTreemapNode.prototype.SetAnimationParams=function(a){this.setLayoutParams(a[0],a[1],a[2],a[3]);var b=Math.round(a[4]),c=Math.round(a[5]),a=Math.round(a[6]);this._color=DvtColorUtils.makeRGB(b,c,a);this._updateShapes()};
DvtTreemapNode.prototype.getIsolateAnimation=function(){for(var a=[this._getIsolateAnimation()],b=this.getDescendantNodes(),c=0;c<b.length;c++)a.push(b[c]._getIsolateAnimation());return a};
DvtTreemapNode.prototype._getIsolateAnimation=function(){if(this._oldState){var a=new DvtCustomAnimation(this.getView().getCtx(),this,DvtTreemapNode._ANIMATION_ISOLATE_DURATION);a.getAnimator().addProp(DvtAnimator.TYPE_NUMBER_ARRAY,this,this.GetAnimationParams,this.SetAnimationParams,this.GetAnimationParams());this.SetAnimationParams(this._oldState);return a}return null};
DvtTreemapNode.prototype.animateUpdate=function(a,b){return 0==this.GetDepth()||b._hasLayout&&0<b._width&&0<b._height?DvtTreemapNode.superclass.animateUpdate.call(this,a,b):this.animateInsert(a)};
DvtTreemapNode.prototype._createShapeNode=function(){var a=this.getView().getCtx(),b;if(this._textStyle==DvtTreemapNode.TEXT_STYLE_HEADER)b=new DvtRect(a,this._x,this._y,this._width,this._height),this._innerShape=new DvtRect(a,this._x+1,this._y+1,this._width-2,this._height-2),this.ApplyHeaderStyle(b,this._innerShape,DvtTreemapNode.DEFAULT_HEADER_INLINE_STYLE,DvtTreemapNode.HEADER_BACKGROUND_STYLE),this._innerShape.setMouseEnabled(!1),b.addChild(this._innerShape),this._isIsolated&&(this._isolateButton=
this._createIsolateRestoreButton(b));else{var c=this.GetFill();b=new DvtRect(a,this._x,this._y,this._width,this._height);if((1E3>this.getView().__getNodeCount()||!DvtAgent.isTouchDevice())&&this._width>=DvtTreemapNode.MIN_SIZE_FOR_BORDER&&this._height>=DvtTreemapNode.MIN_SIZE_FOR_BORDER){new DvtSolidStroke(this.getResolvedColor(DvtTreemapNode.DEFAULT_NODE_TOP_BORDER_COLOR,DvtTreemapNode.LEAF_NODE_TOP_BORDER_COLOR_STYLE),DvtTreemapNode.DEFAULT_NODE_BORDER_OPACITY);new DvtSolidStroke(this.getResolvedColor(DvtTreemapNode.DEFAULT_NODE_BOTTOM_BORDER_COLOR,
DvtTreemapNode.LEAF_NODE_BOTTOM_BORDER_COLOR_STYLE),DvtTreemapNode.DEFAULT_NODE_BORDER_OPACITY);this._pattern&&new DvtSolidStroke(this._color,DvtTreemapNode.DEFAULT_NODE_PATTERN_BORDER_OPACITY);var d=this.getColor(),e=this.getResolvedColor(DvtTreemapNode.DEFAULT_NODE_TOP_BORDER_COLOR,DvtTreemapNode.LEAF_NODE_TOP_BORDER_COLOR_STYLE),e=DvtColorUtils.interpolateColor(e,d,1-DvtTreemapNode.DEFAULT_NODE_BORDER_OPACITY),g=this.getResolvedColor(DvtTreemapNode.DEFAULT_NODE_BOTTOM_BORDER_COLOR,DvtTreemapNode.LEAF_NODE_BOTTOM_BORDER_COLOR_STYLE),
g=DvtColorUtils.interpolateColor(g,d,1-DvtTreemapNode.DEFAULT_NODE_BORDER_OPACITY),d=Math.min(this._width,this._height);4<=d?(b.setSolidFill(g),this._topLeftShape=new DvtRect(a,this._x,this._y,this._width-1,this._height-1),this._topLeftShape.setSolidFill(e),this._topLeftShape.setMouseEnabled(!1),b.addChild(this._topLeftShape),this._fillShape=new DvtRect(a,this._x+1,this._y+1,this._width-2,this._height-2),this._fillShape.setFill(c),this._fillShape.setMouseEnabled(!1),b.addChild(this._fillShape)):2<=
d?(b.setSolidFill(g),this._fillShape=new DvtRect(a,this._x,this._y,this._width-1,this._height-1),this._fillShape.setFill(c),this._fillShape.setMouseEnabled(!1),b.addChild(this._fillShape)):b.setFill(c)}else b.setFill(c)}this.getView().__getEventManager().associate(b,this);null!=this.getView().__getNodeSelection()&&"off"!=this.Selectable?b.setSelectable(!0):b.setCursor("default");b.zIndex=this._zIndex;return b};
DvtTreemapNode.prototype._createIsolateRestoreButton=function(a){if(this._textStyle!=DvtTreemapNode.TEXT_STYLE_HEADER||!this.isIsolateEnabled())return null;var b=null,c=this._x,d=this._x+this._width-DvtTreemapNode._LINE_FUDGE_FACTOR,e=this._y+DvtTreemapNode._LINE_FUDGE_FACTOR,g=this._y+this._titleBarHeight;d-c-2*DvtTreemapNode._ISOLATE_GAP_SIZE>DvtTreemapNode._ISOLATE_ICON_SIZE&&(b=this._isIsolated?this._getRestoreButton():this._getIsolateButton(),c=DvtAgent.isRightToLeft(a.getCtx())?c+DvtTreemapNode._ISOLATE_GAP_SIZE:
d-DvtTreemapNode._ISOLATE_ICON_SIZE-DvtTreemapNode._ISOLATE_GAP_SIZE,b.setTranslate(c,(g+e-DvtTreemapNode._ISOLATE_ICON_SIZE)/2),a.addChild(b),DvtAgent.isTouchDevice()&&(a=new DvtRect(a.getCtx(),-DvtTreemapNode._ISOLATE_TOUCH_BUFFER,-DvtTreemapNode._ISOLATE_TOUCH_BUFFER,DvtTreemapNode._ISOLATE_ICON_SIZE+2*DvtTreemapNode._ISOLATE_TOUCH_BUFFER,DvtTreemapNode._ISOLATE_ICON_SIZE+2*DvtTreemapNode._ISOLATE_TOUCH_BUFFER),a.setInvisibleFill(),b.addChild(a)),"true"==this.getView().__getResources().alta?this.getView().__getEventManager().associate(b,
this):(a=this._isIsolated?this.getView().__getResources().restore:this.getView().__getResources().isolate,this.getView().__getEventManager().associate(b,new DvtBaseTreePeer(this,this.getId(),a))));return b};DvtTreemapNode.prototype._removeIsolateRestoreButton=function(){this._isolateButton&&(this._removeChildShape(this._isolateButton),this._isolateButton=null)};
DvtTreemapNode.prototype._createTextNode=function(a){var b=DvtAgent.isRightToLeft(a.getCtx());if(!this._textStr||!a||!this._textStyle||this._textStyle==DvtTreemapNode.TEXT_STYLE_OFF)return null;var c=this._height;if(this.GetTextSize()>c)return null;var d=this._textStyle==DvtTreemapNode.TEXT_STYLE_NODE?this._labelHalign:this._headerHalign;b&&(d==DvtTreemapNode.LABEL_ALIGN_START?d=DvtTreemapNode.LABEL_ALIGN_END:d==DvtTreemapNode.LABEL_ALIGN_END&&(d=DvtTreemapNode.LABEL_ALIGN_START));var e=this._width-
(DvtTreemapNode.TEXT_BUFFER_HORIZ+DvtTreemapNode.MIN_TEXT_BUFFER),g=0;this.isIsolateEnabled()&&(g=DvtTreemapNode._ISOLATE_ICON_SIZE+DvtTreemapNode._ISOLATE_GAP_SIZE,e=d==DvtTreemapNode.LABEL_ALIGN_CENTER?e-2*g:e-g);if(0>=e)return null;var h=new DvtOutputText(this.getView().getCtx(),this._textStr);h.setFontSize(this.GetTextSize());d==DvtTreemapNode.LABEL_ALIGN_START?(b?h.setX(this._x+DvtTreemapNode.TEXT_BUFFER_HORIZ+g):h.setX(this._x+DvtTreemapNode.TEXT_BUFFER_HORIZ),h.alignLeft()):d==DvtTreemapNode.LABEL_ALIGN_CENTER?
(h.setX(this._x+this._width/2),h.alignCenter()):d==DvtTreemapNode.LABEL_ALIGN_END&&(b?h.setX(this._x+this._width-DvtTreemapNode.TEXT_BUFFER_HORIZ):h.setX(this._x+this._width-DvtTreemapNode.TEXT_BUFFER_HORIZ-g),h.alignRight());this._textStyle==DvtTreemapNode.TEXT_STYLE_NODE?(c=this._height-2*DvtTreemapNode.TEXT_BUFFER_VERT,this._labelValign==DvtTreemapNode.LABEL_ALIGN_TOP?(h.setY(this._y+DvtTreemapNode.TEXT_BUFFER_VERT),h.alignTop()):this._labelValign==DvtTreemapNode.LABEL_ALIGN_CENTER?(h.setY(this._y+
this._height/2),h.alignMiddle()):this._labelValign==DvtTreemapNode.LABEL_ALIGN_BOTTOM&&(h.setY(this._y+this._height-DvtTreemapNode.TEXT_BUFFER_VERT),h.alignBottom()),this.ApplyLabelTextStyle(h)):this._textStyle==DvtTreemapNode.TEXT_STYLE_HEADER&&(b=DvtAgent.isPlatformWebkit()?DvtTreemapNode._LINE_FUDGE_FACTOR:0,h.setY(this._y+DvtTreemapNode.DEFAULT_HEADER_BORDER_WIDTH+this._titleBarHeight/2+b),h.alignMiddle(),this.ApplyHeaderTextStyle(h,DvtTreemapNode.HEADER_TEXT_DEFAULT_STYLE,DvtTreemapNode._DEFAULT_HEADER_TEXT_COLOR));
if(null!=h)return this._textStyle==DvtTreemapNode.TEXT_STYLE_HEADER&&this.isDrillReplaceEnabled()?(this.ApplyHeaderTextStyle(h,DvtTreemapNode.HEADER_DRILL_TEXT_DEFAULT_STYLE,DvtTreemapNode._HEADER_DRILLABLE_TEXT_COLOR),h.setCursor("pointer"),b=new DvtBaseTreePeer(this,this.getId(),null,this.getDatatip(),this.getDatatipColor()),b.setDrillable(!0),this.getView().__getEventManager().associate(h,b)):h.setMouseEnabled(!1),DvtTextUtils.fitText(h,e,c,a)?h:null};
DvtTreemapNode.prototype.ApplyHeaderStyle=function(a,b,c,d){var e=new DvtCSSStyle(c);e.merge(this._view.__getStyles()[d]);c=e.getStyle(DvtCSSStyle.BACKGROUND_COLOR);e=e.getStyle(DvtCSSStyle.BORDER_COLOR);this._headerUseNodeColor&&d==DvtTreemapNode.HEADER_BACKGROUND_STYLE?(d=this.getColor(),b.setSolidFill(d),e=DvtColorUtils.interpolateColor(e,d,1-DvtTreemapNode.DEFAULT_HEADER_WITH_NODE_COLOR_ALPHA),a.setSolidFill(e)):(a.setSolidFill(e),b.setSolidFill(c))};
DvtTreemapNode.prototype.ApplyHeaderTextStyle=function(a,b,c){this._headerUseNodeColor&&b==DvtTreemapNode.HEADER_TEXT_DEFAULT_STYLE?a.setSolidFill(DvtBaseTreeNode.GetNodeTextColor(this)):a.setSolidFill(c);c=[];1>=this.GetDepth()&&this.hasChildren()&&c.push(new DvtCSSStyle(DvtTreemapNode._HEADER_TEXT_STYLE));c.push(this._view.__getStyles()[b]);this._headerLabelStyle&&c.push(this._headerLabelStyle);a.setCSSStyle(DvtCSSStyle.mergeStyles(c))};
DvtTreemapNode.prototype.handleMouseOver=function(){this._isolateButton||(this._isolateButton=this._createIsolateRestoreButton(this._shape));DvtTreemapNode.superclass.handleMouseOver.call(this)};DvtTreemapNode.prototype.handleMouseOut=function(){!0!==this._isIsolated&&this._removeIsolateRestoreButton();DvtTreemapNode.superclass.handleMouseOut.call(this)};
DvtTreemapNode.prototype._updateShapes=function(){this._shape&&(this._shape.setRect(this._x,this._y,this._width,this._height),this._innerShape&&this._innerShape.setRect(this._x+1,this._y+1,this._width-2,this._height-2),(this._textStyle!=DvtTreemapNode.TEXT_STYLE_HEADER||this._headerUseNodeColor)&&this._shape.setFill(this.GetFill()),this.isSelected()&&this.setSelected(!1),this._removeChildShape(this._fillShape),this._removeChildShape(this._topLeftShape),this._topLeftShape=this._fillShape=null,this._removeIsolateRestoreButton(),
this.GetTemplate()?(this._removeChildShape(this._contentRoot),this._contentRoot=null):(this._removeChildShape(this._textBackground),this._textBackground=null,this._text&&this._text.getParent().removeChild(this._text),this._text=this._createTextNode(this._shape)))};DvtTreemapNode.prototype.getDropSiteFeedback=function(){return this._shape?new DvtRect(this.getView().getCtx(),this._shape.getX(),this._shape.getY(),this._shape.getWidth(),this._shape.getHeight()):null};
DvtTreemapNode.prototype._addChildText=function(a){this._textStyle==DvtTreemapNode.TEXT_STYLE_NODE&&this.hasChildren()?this.getView().__getGroupTextLayer().addChild(a):this._shape.addChild(a)};DvtTreemapNode.prototype._removeChildShape=function(a){a&&this._shape.removeChild(a)};
DvtTreemapNode.prototype._getIsolateButton=function(){var a=this.getView().getCtx(),b=this.getView().__getResources(),c=new DvtImage(a,b.maximizeUp,0,0,DvtTreemapNode._ISOLATE_ICON_SIZE,DvtTreemapNode._ISOLATE_ICON_SIZE),d=new DvtImage(a,b.maximizeOver,0,0,DvtTreemapNode._ISOLATE_ICON_SIZE,DvtTreemapNode._ISOLATE_ICON_SIZE),b=new DvtImage(a,b.maximizeDown,0,0,DvtTreemapNode._ISOLATE_ICON_SIZE,DvtTreemapNode._ISOLATE_ICON_SIZE);c.setInvisibleFill();d.setInvisibleFill();b.setInvisibleFill();a=new DvtButton(a,
c,d,b);a.addEvtListener(DvtMouseEvent.CLICK,this.__isolateNode,!1,this);return a};
DvtTreemapNode.prototype._getRestoreButton=function(){var a=this.getView().getCtx(),b=this.getView().__getResources(),c=new DvtImage(a,b.restoreUp,0,0,DvtTreemapNode._ISOLATE_ICON_SIZE,DvtTreemapNode._ISOLATE_ICON_SIZE),d=new DvtImage(a,b.restoreOver,0,0,DvtTreemapNode._ISOLATE_ICON_SIZE,DvtTreemapNode._ISOLATE_ICON_SIZE),b=new DvtImage(a,b.restoreDown,0,0,DvtTreemapNode._ISOLATE_ICON_SIZE,DvtTreemapNode._ISOLATE_ICON_SIZE);c.setInvisibleFill();d.setInvisibleFill();b.setInvisibleFill();a=new DvtButton(a,
c,d,b);a.addEvtListener(DvtMouseEvent.CLICK,this.__restoreNode,!1,this);return a};DvtTreemapNode.prototype.__isIsolated=function(){return this._isIsolated};DvtTreemapNode.prototype.__isolateNode=function(){this._isIsolated=!0;this.hideHoverEffect();this.getView().__isolate(this);this._removeIsolateRestoreButton()};DvtTreemapNode.prototype.__restoreNode=function(){this._isIsolated=!1;this.hideHoverEffect();this.getView().__restore();this._removeIsolateRestoreButton()};
DvtTreemapNode.prototype.getDatatip=function(a,b,c){return a&&a instanceof DvtButton?null:DvtTreemapNode.superclass.getDatatip.call(this,a,b,c)};DvtTreemapNode.prototype.getDatatipColor=function(a){return a&&a instanceof DvtButton?null:DvtTreemapNode.superclass.getDatatipColor.call(this,a)};DvtTreemapNode.prototype.getTooltip=function(a){return a&&a instanceof DvtButton?this._isIsolated?this.getView().__getResources().restore:this.getView().__getResources().isolate:null};
var DvtBaseTreemapLayout=function(){this.Init()};DvtObj.createSubclass(DvtBaseTreemapLayout,DvtObj,"DvtBaseTreemapLayout");DvtBaseTreemapLayout._GROUP_GAP=3;DvtBaseTreemapLayout.prototype.Init=function(){this._zIndex=0};DvtBaseTreemapLayout.prototype.layout=function(){};DvtBaseTreemapLayout.prototype.setSorting=function(a){this.Sorting=a};
DvtBaseTreemapLayout.prototype.setNodeBounds=function(a,b,c,d,e,g){a.setZIndex(this._zIndex);this._zIndex++;if(!g||!a.hasChildren()){var h=this.getGapSize(a.getView(),a.GetDepth()),g=Math.round(b+h),k=Math.round(c+h),m=Math.round(b+d-h)-g,h=Math.round(c+e-h)-k;if(a=a.setLayoutParams(g,k,m,h))return a}return new DvtRectangle(b,c,d,e)};
DvtBaseTreemapLayout.prototype.getGapSize=function(a,b){var c=a.__getGroupGaps();return c==DvtTreemapParser.GROUP_GAPS_OUTER?1==b&&2<=a.__getMaxDepth()?DvtBaseTreemapLayout._GROUP_GAP:0:c==DvtTreemapParser.GROUP_GAPS_ALL?b<a.__getMaxDepth()?DvtBaseTreemapLayout._GROUP_GAP:0:0};var DvtSquarifyingLayout=function(){this.Init()};DvtObj.createSubclass(DvtSquarifyingLayout,DvtBaseTreemapLayout,"DvtSquarifyingLayout");
DvtSquarifyingLayout.prototype.layout=function(a,b,c,d,e,g,h){this._layout(b,c,d,e,g,h?!1:!0)};DvtSquarifyingLayout.prototype._layout=function(a,b,c,d,e,g){b=this.setNodeBounds(a,b,c,d,e,g);a=a.getChildNodes();null!=a&&0<a.length&&(this._calcPixelSize(a,b.w*b.h),a=a.slice(0).sort(function(a,b){return a.getSize()-b.getSize()}),c=Math.min(b.w,b.h),b=new DvtRectangle(b.x,b.y,b.w,b.h),this._squarify(a,[],c,b,Infinity))};
DvtSquarifyingLayout.prototype._calcPixelSize=function(a,b){for(var c=0,d=0,d=0;d<a.length;d++)c+=0<a[d].getSize()?a[d].getSize():0;c=0==b?0:b/c;for(d=0;d<a.length;d++){var e=a[d];e.__pxSize=e.getSize()*c}};
DvtSquarifyingLayout.prototype._squarify=function(a,b,c,d,e){if(null==a||0==a.length)this._layoutRow(b,c,d);else for(;0<a.length;){var g=a.pop();if(0>g.__pxSize){this._layoutRow(b,c,d);break}b.push(g);var h=this._getWorst(b,c);if(h>e){a.push(g);b.pop();d=this._layoutRow(b,c,d);this._squarify(a,[],Math.min(d.w,d.h),d,Infinity);break}else if(0==a.length){this._layoutRow(b,c,d);break}else e=h}};
DvtSquarifyingLayout.prototype._getWorst=function(a,b){for(var c=0,d=Infinity,e=-Infinity,g=0;g<a.length;g++)c+=a[g].__pxSize,d=Math.min(d,a[g].__pxSize),e=Math.max(e,a[g].__pxSize);c*=c;g=b*b;return Math.max(g*e/c,c/(g*d))};
DvtSquarifyingLayout.prototype._layoutRow=function(a,b,c){var d=0,e;for(e=0;e<a.length;e++)d+=a[e].__pxSize;var g=c.x,h=c.y;if(b==c.w){d=0==b?0:d/b;for(e=0;e<a.length;e++)b=a[e].__pxSize/d,this._layout(a[e],g,h,b,d,!1),g+=b;return new DvtRectangle(c.x,c.y+d,c.w,c.h-d)}b=0==b?0:d/b;for(e=0;e<a.length;e++)d=a[e].__pxSize/b,this._layout(a[e],g,h,b,d,!1),h+=d;return new DvtRectangle(c.x+b,c.y,c.w-b,c.h)};var DvtSliceAndDiceLayout=function(a){this.Init();this._isHoriz=a};
DvtObj.createSubclass(DvtSliceAndDiceLayout,DvtBaseTreemapLayout,"DvtSliceAndDiceLayout");DvtSliceAndDiceLayout.prototype.layout=function(a,b,c,d,e,g,h){this._layout(this._isHoriz,a,b,c,d,e,g,h?!1:!0)};
DvtSliceAndDiceLayout.prototype._layout=function(a,b,c,d,e,g,h,k){d=this.setNodeBounds(c,d,e,g,h,k);c=c.getChildNodes();if(null!=c){var e=d.x,g=d.y,h=d.w,k=d.h,m=0,n;for(n=0;n<c.length;n++)m+=0<c[n].getSize()?c[n].getSize():0;this.Sorting==DvtBaseTreeParser.SORTING_ON&&(c=c.slice(0),c.sort(function(a,b){return b.getSize()-a.getSize()}));a&&DvtAgent.isRightToLeft(b.getCtx())&&(c=c.slice(0).reverse());for(n=0;n<c.length;n++){var o=c[n];if(!(0>=o.getSize())){var s=o.getSize()/m;a?h=d.w*s:k=d.h*s;this._layout(!a,
b,o,e,g,h,k,!1);a?e+=h:g+=k}}}};var DvtTreemapIsolateEvent=function(a){this.Init(DvtTreemapIsolateEvent.TYPE);this._id=a?a:null};DvtObj.createSubclass(DvtTreemapIsolateEvent,DvtBaseComponentEvent,"DvtTreemapIsolateEvent");DvtTreemapIsolateEvent.TYPE="treemapIsolate";DvtTreemapIsolateEvent.prototype.getId=function(){return this._id};var DvtTreemapKeyboardHandler=function(a){this.Init(a)};DvtObj.createSubclass(DvtTreemapKeyboardHandler,DvtBaseTreeKeyboardHandler,"DvtTreemapKeyboardHandler");
DvtTreemapKeyboardHandler.prototype.isNavigationEvent=function(a){var b=DvtTreemapKeyboardHandler.superclass.isNavigationEvent.call(this,a);if(!b&&(a=a.keyCode,a==DvtKeyboardEvent.OPEN_BRACKET||a==DvtKeyboardEvent.CLOSE_BRACKET))b=!0;return b};var DvtTreemapEventManager=function(a,b,c,d){DvtBaseTreeEventManager.call(this,a,b,c,d)};DvtObj.createSubclass(DvtTreemapEventManager,DvtBaseTreeEventManager,"DvtTreemapEventManager");
DvtTreemapEventManager.prototype.ProcessKeyboardEvent=function(a){var b=!0;if(a.keyCode==DvtKeyboardEvent.ENTER&&a.ctrlKey){var c=this.getFocus();c.isIsolateEnabled()&&(c.__isIsolated()?c.__restoreNode():c.__isolateNode());a.preventDefault()}else b=DvtTreemapEventManager.superclass.ProcessKeyboardEvent.call(this,a);return b};DvtTreemapEventManager.prototype.isClearMenuAllowed=function(){return!1};var DvtTreemapBundle=function(){};DvtObj.createSubclass(DvtTreemapBundle,DvtBundle,"DvtTreemapBundle");
DvtTreemapBundle._defaults={COLOR:"Color",SIZE:"Size"};DvtTreemapBundle.prototype.GetDefaultStringForKey=function(a){return DvtTreemapBundle._defaults[a]};DvtTreemapBundle.prototype.GetBundlePrefix=function(){return"DvtTreemapBundle"};var DvtTreemapDefaults=function(){this.Init({skyros:DvtTreemapDefaults.VERSION_1,alta:{}})};DvtObj.createSubclass(DvtTreemapDefaults,DvtBaseTreeDefaults,"DvtTreemapDefaults");DvtTreemapDefaults.VERSION_1={nodeDefaults:{header:{labelStyle:new DvtCSSStyle("font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 12px;")}}};
var DvtTreemapJsonUtils=function(a){this._context=a};DvtObj.createSubclass(DvtTreemapJsonUtils,DvtBaseTreeJsonUtils,"DvtTreemapJsonUtils");DvtTreemapJsonUtils.prototype.GetComponentName=function(){return"treemap"};
DvtTreemapJsonUtils.prototype.WriteComponentAttributes=function(a){var b=DvtTreemapJsonUtils.superclass.WriteComponentAttributes.call(this,a),b=b+this.WriteAttr("irk",a.isolatedNode),c=a.groupGaps;"all"==c?b+=this.WriteAttr("gg","a"):"none"==c&&(b+=this.WriteAttr("gg","n"));c=a.layout;"sliceAndDiceHorizontal"==c?b+=this.WriteAttr("layout","h"):"sliceAndDiceVertical"==c&&(b+=this.WriteAttr("layout","v"));a=a.animationOnDisplay;return b="auto"==a?b+this.WriteAttr("adi","alphaFade"):b+this.WriteAttr("adi",
a)};
DvtTreemapJsonUtils.prototype.WriteNodeAttributes=function(a,b){var c=DvtTreemapJsonUtils.superclass.WriteNodeAttributes.call(this,a,b);"off"==(b.labelDisplay?b.labelDisplay:a.nodeDefaults.labelDisplay)&&(c+=this.WriteAttr("ld","o"));var d=b.groupLabelDisplay?b.groupLabelDisplay:a.nodeDefaults.groupLabelDisplay;"node"==d?c+=this.WriteAttr("gld","n"):"off"==d&&(c+=this.WriteAttr("gld","o"));d=b.labelHalign?b.labelHalign:a.nodeDefaults.labelHalign;"start"==d?c+=this.WriteAttr("ha","s"):"end"==d&&(c+=
this.WriteAttr("ha","e"));d=b.labelValign?b.labelValign:a.nodeDefaults.labelValign;"top"==d?c+=this.WriteAttr("va","t"):"bottom"==d&&(c+=this.WriteAttr("va","b"));var d=b.header,c=c+this.WriteAttr("hls",d&&d.labelStyle?d.labelStyle:a.nodeDefaults.header.labelStyle),e=d&&d.labelHalign?d.labelHalign:a.nodeDefaults.header.labelHalign;"center"==e?c+=this.WriteAttr("hha","c"):"end"==e&&(c+=this.WriteAttr("hha","e"));"off"==(d&&d.isolate?d.isolate:a.nodeDefaults.header.isolate)&&(c+=this.WriteAttr("hi",
"off"));"on"==(d&&d.useNodeColor?d.useNodeColor:a.nodeDefaults.header.useNodeColor)&&(c+=this.WriteAttr("unc","on"));return c};
DvtTreemapJsonUtils.prototype.WriteResourcesElement=function(a){var b="<resources",c=new DvtTreemapBundle,b=b+this.WriteAttr("legendSize",c.getTranslatedString("SIZE")),b=b+this.WriteAttr("legendColor",c.getTranslatedString("COLOR")),a=a._resources,c=DvtAgent.isRightToLeft(this._context),b=b+this.WriteAttr("maximizeUp",c&&a.isolateRtl?a.isolateRtl:a.isolate),b=b+this.WriteAttr("maximizeDown",c&&a.isolateDownRtl?a.isolateDownRtl:a.isolateDown),b=b+this.WriteAttr("maximizeOver",c&&a.isolateOverRtl?
a.isolateOverRtl:a.isolateOver),b=b+this.WriteAttr("restoreUp",c&&a.restoreRtl?a.restoreRtl:a.restore),b=b+this.WriteAttr("restoreDown",c&&a.restoreDownRtl?a.restoreDownRtl:a.restoreDown),b=b+this.WriteAttr("restoreOver",c&&a.restoreOverRtl?a.restoreOverRtl:a.restoreOver),b=b+this.WriteAttr("alta","true");return b+"/>\n"};
DvtTreemapJsonUtils.prototype.WriteStyleElement=function(a){var b=DvtTreemapJsonUtils.superclass.WriteStyleElement.call(this,a),c=a.animationUpdateColor;c&&(b+=this.WriteAttr("top","-tr-animation-update-color: "+c));(c=a.nodeDefaults.hoverColor)&&(b+=this.WriteAttr("node-hover","border-color: "+c));var d=a.nodeDefaults.selectedInnerColor,c=a.nodeDefaults.selectedOuterColor,d=d?DvtCSSStyle.INNER_COLOR+":"+d+";":"";(d+=c?DvtCSSStyle.OUTER_COLOR+":"+c:"")&&(b+=this.WriteAttr("node-selected",d));c=a.nodeDefaults.header.backgroundColor;
d=a.nodeDefaults.header.borderColor;(c=(c?"background-color:"+c+";":"")+(d?"border-color:"+d:""))&&(b+=this.WriteAttr("nodeHeader",c));var e=a.nodeDefaults.header.hoverBackgroundColor,c=a.nodeDefaults.header.hoverInnerColor,d=a.nodeDefaults.header.hoverOuterColor,e=e?DvtCSSStyle.BACKGROUND_COLOR+":"+e+";":"",e=e+(c?DvtCSSStyle.INNER_COLOR+":"+c+";":"");(e+=d?DvtCSSStyle.OUTER_COLOR+":"+d:"")&&(b+=this.WriteAttr("nodeHeader-hover",e));d=a.nodeDefaults.header.selectedBackgroundColor;c=a.nodeDefaults.header.selectedInnerColor;
a=a.nodeDefaults.header.selectedOuterColor;d=d?DvtCSSStyle.BACKGROUND_COLOR+":"+d+";":"";d+=c?DvtCSSStyle.INNER_COLOR+":"+c+";":"";(d+=a?DvtCSSStyle.OUTER_COLOR+":"+a:"")&&(b+=this.WriteAttr("nodeHeader-selected",d));return b+"/>\n"};