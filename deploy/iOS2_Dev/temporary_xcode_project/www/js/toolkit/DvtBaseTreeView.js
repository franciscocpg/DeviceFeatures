var DvtBaseTreeView=function(){};DvtObj.createSubclass(DvtBaseTreeView,DvtBaseComponent,"DvtBaseTreeView");DvtBaseTreeView._EMPTY_TEXT_BUFFER=2;DvtBaseTreeView.BACKGROUND_STYLE="BACKGROUND_STYLE";DvtBaseTreeView.TEXT_STYLE="TEXT_STYLE";DvtBaseTreeView.ATTRIBUTE_TYPE_STYLE="ATTRIBUTE_TYPE_STYLE";DvtBaseTreeView.ATTRIBUTE_VALUE_STYLE="ATTRIBUTE_VALUE_STYLE";DvtBaseTreeView.DRILL_TEXT_STYLE="DRILL_TEXT_STYLE";DvtBaseTreeView.CURRENT_TEXT_STYLE="CURRENT_TEXT_STYLE";
DvtBaseTreeView.prototype.Init=function(a,b,c){DvtBaseTreeView.superclass.Init.call(this,a,b,c);this._eventHandler=this.CreateEventManager(this,a,this.__dispatchEvent,this);this._eventHandler.addListeners(this);this._dragSource=new DvtDragSource(a);this._dropTarget=new DvtBaseTreeDropTarget(this);this._eventHandler.setDragSource(this._dragSource);this._Automation=new DvtTreeAutomation(this);this.LastXml=this._legend=null;this._hasFocus=!1;this._navigableIdToFocus=null};
DvtBaseTreeView.prototype.render=function(a,b,c){this.Width=b;this.Height=c;this._eventHandler&&this._eventHandler.hideTooltip();this.Animation&&!a&&(a=this.LastXml);a&&(this.LastXml=a);a&&this.ApplyParsedProperties(this.Parse(a));c=new DvtRectangle(0,0,this.Width,this.Height);this.Layout(c);b=new DvtContainer(this.getCtx());this.addChild(b);this._templates&&(this._afContext=new DvtAfContext(this.getCtx(),this._eventHandler),this._afContext.setRmIfNotFit(!0));this.Render(b,c);this.Animation&&(this.AnimationStopped=
!0,this.Animation.stop());var d=new DvtRectangle(0,0,this.Width,this.Height),c=!1;this._container?this.AnimationOnDataChange&&a&&(DvtBlackBoxAnimationHandler.isSupported(this.AnimationOnDataChange)?(this.Animation=DvtBlackBoxAnimationHandler.getCombinedAnimation(this.getCtx(),this.AnimationOnDataChange,this._container,b,d,this.AnimationDuration),c=!0):this._oldRoot&&"auto"==this.AnimationOnDataChange&&(this._deleteContainer=this.GetDeleteContainer(),this.addChild(this._deleteContainer),d=new DvtBaseTreeAnimationHandler(this.getCtx(),
this._deleteContainer),d.animate(this._oldRoot,this._root,this._oldAncestors,this._ancestors),this.Animation=d.getAnimation())):this.Animation=this.GetDisplayAnimation(b,d);this._oldAncestors=this._oldRoot=null;this.Animation&&(this._eventHandler.removeListeners(this),this.Animation.setOnEnd(this.OnAnimationEnd,this),this.Animation.play());c?this._oldContainer=this._container:this._container&&this.removeChild(this._container);this._container=b;a?(this._processInitialSelections(),this._processInitialFocus(!this.Animation)):
this.ReselectNodes()};DvtBaseTreeView.prototype.Parse=function(){return null};DvtBaseTreeView.prototype.Layout=function(){};DvtBaseTreeView.prototype.Render=function(){};DvtBaseTreeView.prototype.RenderBackground=function(a){var b=new DvtRect(this.getCtx(),0,0,this.Width,this.Height);b.setInvisibleFill();a.addChild(b)};
DvtBaseTreeView.prototype.LayoutBreadcrumbs=function(a){if(this._ancestors&&0<this._ancestors.length){var b=this._root?this._root.getLabel():null;this._breadcrumbs&&this._eventHandler.removeComponentKeyboardHandler(this._breadcrumbs);this._breadcrumbs=DvtTreeBreadcrumbsRenderer.render(this,a,this._ancestors,b);this._eventHandler.addComponentKeyboardHandlerAt(this._breadcrumbs,0)}else this._eventHandler.removeComponentKeyboardHandler(this._breadcrumbs),this._breadcrumbs=null};
DvtBaseTreeView.prototype.RenderBreadcrumbs=function(a){this._breadcrumbs&&a.addChild(this._breadcrumbs)};
DvtBaseTreeView.prototype.LayoutLegend=function(a){var b=null;if(this._legendSource&&this._attrGroups)for(var c=0;c<this._attrGroups.length;c++){var d=this._attrGroups[c];if(d.id==this._legendSource){b=d.attrGroups;break}}if(this._sizeValueStr||this._colorValueStr||b)this._legend=DvtTreeLegendRenderer.render(this,a,this.__getResources().legendSize,this.__getResources().legendColor,this._sizeValueStr,this._colorValueStr,b)};
DvtBaseTreeView.prototype.RenderLegend=function(a){this._legend&&(a.addChild(this._legend),this._legend=null)};DvtBaseTreeView.prototype.RenderEmptyText=function(a){if(this._emptyText){var b=new DvtOutputText(this.getCtx(),this._emptyText,this.Width/2,this.Height/2);b.alignCenter();b.alignMiddle();DvtTextUtils.fitText(b,this.Width-2*DvtBaseTreeView._EMPTY_TEXT_BUFFER,this.Height-2*DvtBaseTreeView._EMPTY_TEXT_BUFFER,this);a.addChild(b)}};
DvtBaseTreeView.prototype.HasValidData=function(){return this._root&&0<this._root.getSize()};DvtBaseTreeView.prototype.GetDisplayAnimation=function(a,b){return DvtBlackBoxAnimationHandler.isSupported(this.AnimationOnDisplay)?DvtBlackBoxAnimationHandler.getInAnimation(this.getCtx(),this.AnimationOnDisplay,a,b,this.AnimationDuration):null};
DvtBaseTreeView.prototype.OnAnimationEnd=function(){this._deleteContainer&&(this.removeChild(this._deleteContainer),this._deleteContainer=null);this._oldContainer&&(this.removeChild(this._oldContainer),this._oldContainer=null);this.AnimationStopped=!1;this.Animation=null;this._eventHandler.addListeners(this);this._processInitialFocus(!0)};DvtBaseTreeView.prototype.GetDeleteContainer=function(){return new DvtContainer(this.getCtx())};DvtBaseTreeView.prototype.CreateKeyboardHandler=function(a){return new DvtBaseTreeKeyboardHandler(a)};
DvtBaseTreeView.prototype.CreateEventManager=function(a,b,c,d){return new DvtBaseTreeEventManager(a,b,c,d)};DvtBaseTreeView.prototype.GetInitialFocusedItem=function(a){return a};DvtBaseTreeView.prototype.__getEventManager=function(){return this._eventHandler};DvtBaseTreeView.prototype.__getResources=function(){return this._resources};DvtBaseTreeView.prototype.__getMaxDepth=function(){return this._maxDepth};DvtBaseTreeView.prototype.__getNodeCount=function(){return this._nodeCount};
DvtBaseTreeView._calcMaxDepth=function(a,b){var c=b,d=a.getChildNodes();if(d)for(var e=0;e<d.length;e++)var g=DvtBaseTreeView._calcMaxDepth(d[e],b+1),c=Math.max(c,g);return c};
DvtBaseTreeView.prototype.ApplyParsedProperties=function(a){this._oldRoot=this._root;this._oldAncestors=this._ancestors;this._nodeCount=a.nodeCount;this._resources=a.resources?a.resources:{};this._root=a.root;this._emptyText=a.emptyText;this._ancestors=a.ancestors;this._dropSiteFill=new DvtSolidFill(a.dropSiteFillColor,a.dropSiteOpacity);this._dropSiteStroke=new DvtSolidStroke(a.dropSiteBorderColor);this.AnimationOnDisplay=a.animationOnDisplay;this.AnimationOnDataChange=a.animationOnDataChange;this.AnimationDuration=
a.animationDuration;this.Sorting=a.sorting;this._styles=a.styles;this._nodeSelection=a.nodeSelection;a.templates&&(this._templates=a.templates);this._nodeSelection?(this._selectionHandler=new DvtSelectionHandler(a.nodeSelection),this._initialSelection=a.selectedIds):this._selectionHandler=null;this._eventHandler.setSelectionHandler(this._selectionHandler);this._eventHandler.setContextMenuHandler(a.contextMenuHandler);this._selectionHandler?this._eventHandler.setKeyboardHandler(this.CreateKeyboardHandler(this._eventHandler)):
this._eventHandler.setKeyboardHandler(null);this._root&&(this._maxDepth=DvtBaseTreeView._calcMaxDepth(this._root,0));this._attrGroups=a.attrGroups;this._legendSource=a.legendSource;this._sizeValueStr=a.sizeValueStr;this._colorValueStr=a.colorValueStr};DvtBaseTreeView.prototype.ReselectNodes=function(){for(var a=this._selectionHandler?this._selectionHandler.getSelection():[],b=0;b<a.length;b++)a[b].setSelected(!0)};
DvtBaseTreeView.prototype._processInitialSelections=function(){if(this._selectionHandler&&this._initialSelection){var a=[];this._addSelectableObjectsToArray(this._root,a);this._selectionHandler.processInitialSelections(this._initialSelection,a);this._initialSelection=null}};
DvtBaseTreeView.prototype._processInitialFocus=function(a){var b=null,c=this.__getNavigableIdToFocus();c&&(b=DvtBaseTreeNode.getNodeById(this._root,c),this._eventHandler.setFocus(b));a&&this.__setNavigableIdToFocus(null);b||(b=this.GetInitialFocusedItem(this._root),this._eventHandler.setFocus(b));a&&this.setFocused(this.isFocused())};DvtBaseTreeView.prototype.setFocused=function(a){this._hasFocus=a;this._eventHandler.setFocused(a)};DvtBaseTreeView.prototype.isFocused=function(){return this._hasFocus};
DvtBaseTreeView.prototype._addSelectableObjectsToArray=function(a,b){if(a){b.push(a);var c=a.getChildNodes();if(c)for(var d=0;d<c.length;d++)this._addSelectableObjectsToArray(c[d],b)}};DvtBaseTreeView.prototype.__getAnimationDuration=function(){return this.AnimationDuration};DvtBaseTreeView.prototype.__getTemplates=function(){return this._templates};DvtBaseTreeView.prototype.__getStyles=function(){return this._styles};DvtBaseTreeView.prototype.__getAfContext=function(){return this._afContext};
DvtBaseTreeView.prototype.__getNodeUnderPoint=function(a,b){return this._root.getNodeUnderPoint(a,b)};DvtBaseTreeView.prototype.__isDragAvailable=function(a){return this._selectionHandler?a[0]:null};DvtBaseTreeView.prototype.__getDragTransferable=function(a){a.isSelected()||(this._selectionHandler.processClick(a,!1),this._eventHandler.fireSelectionEvent());for(var a=[],b=this._selectionHandler.getSelection(),c=0;c<b.length;c++)a.push(b[c].getId());return a};
DvtBaseTreeView.prototype.__getDragFeedback=function(){for(var a=[],b=this._selectionHandler.getSelection(),c=0;c<b.length;c++)a.push(b[c].__getDisplayable());return a};
DvtBaseTreeView.prototype.__showDropSiteFeedback=function(a){this._dropSiteFeedback&&(this.removeChild(this._dropSiteFeedback),this._dropSiteFeedback=null);if(a&&(this._dropSiteFeedback=a.getDropSiteFeedback()))this._dropSiteFeedback.setFill(this._dropSiteFill),this._dropSiteFeedback.setStroke(this._dropSiteStroke),this.addChild(this._dropSiteFeedback);return this._dropSiteFeedback};
DvtBaseTreeView.prototype.__processBreadcrumbsEvent=function(a){a instanceof DvtBreadcrumbsDrillEvent?this.__drill(a.getId(),!1):this.__dispatchEvent(a)};DvtBaseTreeView.prototype.__drill=function(a,b){b&&this._root&&a==this._root.getId()&&this._ancestors&&0<this._ancestors.length?(this.__setNavigableIdToFocus(a),this.__dispatchEvent(new DvtDrillReplaceEvent(this._ancestors[0].id))):b||this.__dispatchEvent(new DvtDrillReplaceEvent(a));this.getCtx().getTooltipManager().hideTooltip()};
DvtBaseTreeView.prototype.getAutomation=function(){return this._Automation};DvtBaseTreeView.prototype.getLogicalObject=function(a){return this._eventHandler.GetLogicalObject(a)};DvtBaseTreeView.prototype.getRootNode=function(){return this._root};DvtBaseTreeView.prototype.__getNavigableIdToFocus=function(){return this._navigableIdToFocus};DvtBaseTreeView.prototype.__setNavigableIdToFocus=function(a){this._navigableIdToFocus=a};DvtBaseTreeView.prototype.__getNodeSelection=function(){return this._nodeSelection};
DvtBaseTreeView.prototype.isDragAvailable=function(a,b,c){return this._dragSource.isDragAvailable(c)};DvtBaseTreeView.prototype.getDragTransferable=function(a,b){return this._dragSource.getDragTransferable(a,b)};DvtBaseTreeView.prototype.getDragOverFeedback=function(a,b){return this._dragSource.getDragOverFeedback(a,b)};DvtBaseTreeView.prototype.getDragContext=function(a,b){return this._dragSource.getDragContext(a,b)};
DvtBaseTreeView.prototype.getDragOffset=function(a,b){return this._dragSource.getDragOffset(a,b)};DvtBaseTreeView.prototype.getPointerOffset=function(a,b){return this._dragSource.getPointerOffset(a,b)};DvtBaseTreeView.prototype.initiateDrag=function(){this._dragSource.initiateDrag()};DvtBaseTreeView.prototype.dragDropEnd=function(){this._dragSource.dragDropEnd()};DvtBaseTreeView.prototype.acceptDrag=function(a,b,c){return this._dropTarget.acceptDrag(a,b,c)};DvtBaseTreeView.prototype.dragEnter=function(){this._dropTarget.dragEnter()};
DvtBaseTreeView.prototype.dragExit=function(){this._dropTarget.dragExit()};DvtBaseTreeView.prototype.getDropSite=function(a,b){return this._dropTarget.getDropSite(a,b)};var DvtBaseTreeAnimationHandler=function(a,b){this.Init(a,b)};DvtObj.createSubclass(DvtBaseTreeAnimationHandler,DvtDataAnimationHandler,"DvtBaseTreeAnimationHandler");
DvtBaseTreeAnimationHandler.prototype.animate=function(a,b,c,d){this._bDrill=!1;this._oldRoot=a;this._oldAncestors=c;DvtBaseTreeAnimationHandler._isAncestor(d,a)||DvtBaseTreeAnimationHandler._isAncestor(c,b)?(this._bDrill=!0,c=a.getDescendantNodes(),d=b.getDescendantNodes(),c.push(a),d.push(b),this.constructAnimation(c,d)):this.constructAnimation([a],[b])};DvtBaseTreeAnimationHandler.prototype.isDrillAnimation=function(){return this._bDrill};
DvtBaseTreeAnimationHandler.prototype.isAncestorInsert=function(a){return this._bDrill?this._oldRoot.getId()==a.getId()||DvtBaseTreeAnimationHandler._isAncestor(this._oldAncestors,a):!1};DvtBaseTreeAnimationHandler._isAncestor=function(a,b){if(!b||!a)return!1;for(var c=0;c<a.length;c++)if(a[c].id==b.getId())return!0;return!1};var DvtBaseTreeDropTarget=function(a){this._view=a};DvtObj.createSubclass(DvtBaseTreeDropTarget,DvtDropTarget,"DvtBaseTreeDropTarget");
DvtBaseTreeDropTarget.prototype.acceptDrag=function(a,b,c){if(a=this._view.__getNodeUnderPoint(a,b))a!=this._dropSite&&(this._view.__showDropSiteFeedback(a),this._dropSite=a);else return this._view.__showDropSiteFeedback(null),null;return c[0]};DvtBaseTreeDropTarget.prototype.dragExit=function(){this._view.__showDropSiteFeedback(null);this._dropSite=null};DvtBaseTreeDropTarget.prototype.getDropSite=function(a,b){var c=this._view.__getNodeUnderPoint(a,b);return c?{clientRowKey:c.getId()}:null};
var DvtBaseTreeEventManager=function(a,b,c,d){this.Init(b,c,d);this._view=a};DvtObj.createSubclass(DvtBaseTreeEventManager,DvtEventManager,"DvtBaseTreeEventManager");DvtBaseTreeEventManager.prototype.GetView=function(){return this._view};DvtBaseTreeEventManager.prototype.OnDblClick=function(a){DvtBaseTreeEventManager.superclass.OnDblClick.call(this,a);var b=this.GetLogicalObject(a.target);b&&this._processDrill(b,a.shiftKey)};
DvtBaseTreeEventManager.prototype.OnClick=function(a){DvtBaseTreeEventManager.superclass.OnClick.call(this,a);this._processNodeLabel(this.GetLogicalObject(a.target))};DvtBaseTreeEventManager.prototype.OnMouseOver=function(a){DvtBaseTreeEventManager.superclass.OnMouseOver.call(this,a);(a=this.GetLogicalObject(a.target))&&a.handleMouseOver&&a.handleMouseOver()};
DvtBaseTreeEventManager.prototype.OnMouseOut=function(a){DvtBaseTreeEventManager.superclass.OnMouseOut.call(this,a);var b=this.GetLogicalObject(a.target);b&&b.handleMouseOut&&(a=this.GetLogicalObject(a.relatedTarget),(a&&a.getId?a.getId():null)!=b.getId()&&b.handleMouseOut())};
DvtBaseTreeEventManager.prototype.ProcessKeyboardEvent=function(a){var b=!1,b=a.keyCode,c=this.getFocus();b==DvtKeyboardEvent.ENTER&&!a.ctrlKey?(c=this.getFocus(),c.isDrillReplaceEnabled&&c.isDrillReplaceEnabled()&&(a.shiftKey&&(c=this._view.getRootNode()),this._view.__drill(c.getId(),a.shiftKey)),a.preventDefault(),b=!0):b=DvtBaseTreeEventManager.superclass.ProcessKeyboardEvent.call(this,a);return b};
DvtBaseTreeEventManager.prototype.HandleTouchClickInternal=function(a){a=this.GetLogicalObject(a.target);this._processNodeLabel(a);this._currentHoverItem&&this._currentHoverItem!=a&&(this._currentHoverItem.handleMouseOut(),this._currentHoverItem=null);a&&a instanceof DvtBaseTreeNode&&this._currentHoverItem!=a&&(this._currentHoverItem=a,a.handleMouseOver())};DvtBaseTreeEventManager.prototype.OnComponentTouchDblClick=function(a){(a=this.GetLogicalObject(a.target))&&this._processDrill(a,!1)};
DvtBaseTreeEventManager.prototype._processNodeLabel=function(a){a&&a instanceof DvtBaseTreePeer&&a.isDrillable()&&this._view.__drill(a.getId(),!1)};DvtBaseTreeEventManager.prototype._processDrill=function(a,b){a.isDrillReplaceEnabled&&a.isDrillReplaceEnabled()&&this._view.__drill(a.getId(),b)};var DvtBaseTreeParser=function(){};DvtObj.createSubclass(DvtBaseTreeParser,DvtObj,"DvtBaseTreeParser");DvtBaseTreeParser.ATTR_NODE_SELECTION="sel";DvtBaseTreeParser.ATTR_SORTING="sort";
DvtBaseTreeParser.ATTR_SELECTED_IDS="selIds";DvtBaseTreeParser.ATTR_EMPTY_TEXT="emptyText";DvtBaseTreeParser.ATTR_LEGEND_SOURCE="ls";DvtBaseTreeParser.ATTR_LEGEND_SIZE_VALUE="sv";DvtBaseTreeParser.ATTR_LEGEND_COLOR_VALUE="cv";DvtBaseTreeParser.ATTR_ANIMATION_DURATION="adu";DvtBaseTreeParser.ATTR_ANIMATION_ON_DATA_CHANGE="adc";DvtBaseTreeParser.ATTR_ANIMATION_ON_DISPLAY="adi";DvtBaseTreeParser.ATTR_DROP_SITE_FILL_COLOR="dsf";DvtBaseTreeParser.ATTR_DROP_SITE_BORDER_COLOR="dsb";
DvtBaseTreeParser.ATTR_DROP_SITE_OPACITY="dso";DvtBaseTreeParser.NODE_SELECTION_NONE="none";DvtBaseTreeParser.NODE_SELECTION_SINGLE="single";DvtBaseTreeParser.NODE_SELECTION_MULTIPLE="multiple";DvtBaseTreeParser.SORTING_ON="on";DvtBaseTreeParser.ATTR_TEMPLATE_ID="T";DvtBaseTreeParser.ATTR_MENU_ID="M";DvtBaseTreeParser.ATTR_ATTR_GROUPS_COLOR="ag";DvtBaseTreeParser.ATTR_ID="id";DvtBaseTreeParser.ATTR_SIZE="s";DvtBaseTreeParser.ATTR_COLOR="c";DvtBaseTreeParser.ATTR_PATTERN="p";
DvtBaseTreeParser.ATTR_LABEL="l";DvtBaseTreeParser.ATTR_TOOLTIP="tt";DvtBaseTreeParser.ATTR_LABEL_STYLE="ls";DvtBaseTreeParser.ATTR_LABEL_DISPLAY="ld";DvtBaseTreeParser.ATTR_INDEX_IN_PARENT="iip";DvtBaseTreeParser.ATTR_TEMPLATE_NAME="tn";DvtBaseTreeParser.ATTR_DRILLING="d";DvtBaseTreeParser.ATTR_DISCLOSED="di";DvtBaseTreeParser.ATTR_SELECTABLE="nsel";DvtBaseTreeParser.ATTR_AG_GROUP="g";DvtBaseTreeParser.ATTR_AG_GROUP_LABEL="l";DvtBaseTreeParser.ATTR_AG_COLOR="c";
DvtBaseTreeParser.ATTR_AG_PATTERN="p";DvtBaseTreeParser._ELEM_NODE="n";DvtBaseTreeParser._ELEM_F="f";DvtBaseTreeParser._ELEM_EL="el";DvtBaseTreeParser.ANIMATION_UPDATE_COLOR="-tr-animation-update-color";DvtBaseTreeParser.prototype.Init=function(a){this._view=a;this._parser=new DvtXmlParser(a.getCtx());this._minAGColor=Infinity;this._maxAGColor=-Infinity};
DvtBaseTreeParser.prototype.parse=function(a){var b=this._parser.parse(a),a=this.ParseRootAttributes(b),b=b.getChildNodes();a.templates=this._parseTemplates(b);var c;this._nodeCount=0;var d=this._getChildNodesByName(b,DvtBaseTreeParser._ELEM_NODE),e=[];for(c=0;c<d.length;c++){var g=this._parseDataNode(d[c],a.templates);g&&e.push(g)}a.nodeCount=this._nodeCount;a.root=1==e.length?e[0]:this._createArtificialRoot(this._view,e);for(c=0;c<b.length;c++)this._parseNode(b[c],a);this._applyParsedProperties(a.root,
a);return a};DvtBaseTreeParser.prototype.CreateNode=function(){return null};
DvtBaseTreeParser.prototype.ParseRootAttributes=function(a){var b={},c=a.getAttr(DvtBaseTreeParser.ATTR_NODE_SELECTION);b.nodeSelection=c==DvtBaseTreeParser.NODE_SELECTION_NONE?null:c==DvtBaseTreeParser.NODE_SELECTION_SINGLE?DvtSelectionHandler.TYPE_SINGLE:DvtSelectionHandler.TYPE_MULTIPLE;b.sorting=a.getAttr(DvtBaseTreeParser.ATTR_SORTING);if(c=a.getAttr(DvtBaseTreeParser.ATTR_SELECTED_IDS))b.selectedIds=c.split(",");b.emptyText=a.getAttr(DvtBaseTreeParser.ATTR_EMPTY_TEXT);b.legendSource=a.getAttr(DvtBaseTreeParser.ATTR_LEGEND_SOURCE);
b.sizeValueStr=a.getAttr(DvtBaseTreeParser.ATTR_LEGEND_SIZE_VALUE);b.colorValueStr=a.getAttr(DvtBaseTreeParser.ATTR_LEGEND_COLOR_VALUE);if(c=a.getAttr(DvtBaseTreeParser.ATTR_ANIMATION_DURATION))b.animationDuration=c/1E3;b.animationOnDataChange=a.getAttr(DvtBaseTreeParser.ATTR_ANIMATION_ON_DATA_CHANGE);b.animationOnDisplay=a.getAttr(DvtBaseTreeParser.ATTR_ANIMATION_ON_DISPLAY);return b};
DvtBaseTreeParser.prototype.ParseNodeAttributes=function(a){var b={};b.templateId=a.getAttr(DvtBaseTreeParser.ATTR_TEMPLATE_ID);b.menuId=a.getAttr(DvtBaseTreeParser.ATTR_MENU_ID);b.agColor=a.getAttr(DvtBaseTreeParser.ATTR_ATTR_GROUPS_COLOR);b.id=a.getAttr(DvtBaseTreeParser.ATTR_ID);b.size=Number(a.getAttr(DvtBaseTreeParser.ATTR_SIZE));b.color=a.getAttr(DvtBaseTreeParser.ATTR_COLOR);b.pattern=a.getAttr(DvtBaseTreeParser.ATTR_PATTERN);b.label=a.getAttr(DvtBaseTreeParser.ATTR_LABEL);b.tooltip=a.getAttr(DvtBaseTreeParser.ATTR_TOOLTIP);
b.labelDisplay=a.getAttr(DvtBaseTreeParser.ATTR_LABEL_DISPLAY);b.drilling=a.getAttr(DvtBaseTreeParser.ATTR_DRILLING);b.indexInParent=a.getAttr(DvtBaseTreeParser.ATTR_INDEX_IN_PARENT);b.disclosed="t"==a.getAttr(DvtBaseTreeParser.ATTR_DISCLOSED)?!0:!1;b.selectable=a.getAttr(DvtBaseTreeParser.ATTR_SELECTABLE);var c=a.getAttr(DvtBaseTreeParser.ATTR_TEMPLATE_NAME);c&&(b.templateName=c);if(a=a.getAttr(DvtBaseTreeParser.ATTR_LABEL_STYLE))b.labelStyle=new DvtCSSStyle(a);null!=b.agColor&&(this._maxAGColor=
Math.max(this._maxAGColor,b.agColor),this._minAGColor=Math.min(this._minAGColor,b.agColor));return b};DvtBaseTreeParser.prototype._createArtificialRoot=function(a,b){for(var c=0,d=0;d<b.length;d++)c+=b[d].getSize();c=this.CreateNode(a,{size:c,bArtificialRoot:!0,disclosed:!0});c.setChildNodes(b);return c};
DvtBaseTreeParser.prototype._parseDataNode=function(a,b){if(!a||a.getName()!=DvtBaseTreeParser._ELEM_NODE)return null;this._nodeCount++;var c=this.CreateNode(this._view,this.ParseNodeAttributes(a),b);c.setChildNodes(this._parseChildren(a,c,b));return c};DvtBaseTreeParser.prototype._parseChildren=function(a,b,c){for(var d=[],a=a.getChildNodes(),e=0;e<a.length;e++){var g=a[e];g&&(g.getName()==DvtBaseTreeParser._ELEM_EL?c&&this._parseELData(b,g):b.isDisclosed()&&d.push(this._parseDataNode(g,c)))}return d};
DvtBaseTreeParser.prototype._parseNode=function(a,b){if(a){var c=a.getName();"spb"==c?(c=this._parseShowPopupBehavior(a,b),b.showPopupBehaviors||(b.showPopupBehaviors=[]),b.showPopupBehaviors.push(c)):"menus"==c?(b.contextMenuHandler||(b.contextMenuHandler=new DvtContextMenuHandler(this._view.getCtx())),b.contextMenuHandler.add(a)):"ag"==c?this._parseAttrGroups(a,b):"styles"==c?b.styles=this._parseStyles(a,b):"a"==c?b.ancestors=this._parseAncestors(a):"resources"==c&&(b.resources=this._parseResources(a))}};
DvtBaseTreeParser.prototype._parseShowPopupBehavior=function(a,b){var c=DvtShowPopupBehavior.newInstance(a),d=a.getAttr(DvtBaseTreeParser.ATTR_TEMPLATE_ID);b.spb||(b.spb={});b.spb[d]||(b.spb[d]=[]);b.spb[d].push(c)};
DvtBaseTreeParser.prototype._parseAttrGroups=function(a,b){var c,d=a.getAttr(DvtBaseTreeParser.ATTR_ID),e=a.getAttr(DvtBaseTreeParser.ATTR_TEMPLATE_ID);if("continuous"==a.getAttr("t")){c=a.getAttr("minValue");var g=a.getAttr("maxValue"),h=a.getAttr("minLabel"),k=a.getAttr("maxLabel"),m=a.getAttr("ramp").split(";");null==c&&(c=this._minAGColor);null==g&&(g=this._maxAGColor);c=new DvtContinuousAttrGroups(c,g,h,k,m)}else{c=new DvtDiscreteAttrGroups;g=a.getChildNodes();for(h=0;h<g.length;h++){var n=g[h];
n&&(k=n.getAttr(DvtBaseTreeParser.ATTR_AG_GROUP),m=n.getAttr(DvtBaseTreeParser.ATTR_AG_GROUP_LABEL),n={color:n.getAttr(DvtBaseTreeParser.ATTR_AG_COLOR),pattern:n.getAttr(DvtBaseTreeParser.ATTR_AG_PATTERN)},c.add(k,m,n))}}b.attrGroups||(b.attrGroups=[]);b.attrGroups.push({attrGroups:c,templateId:e,id:d})};
DvtBaseTreeParser.prototype._applyParsedProperties=function(a,b){if(a){var c=a.getTemplateId();if(b.spb){var d=b.spb[c];d&&a.setShowPopupBehaviors(d)}if(b.attrGroups)for(d=0;d<b.attrGroups.length;d++){var e=b.attrGroups[d];if(e.templateId==c){e.attrGroups instanceof DvtContinuousAttrGroups&&a.processAttrGroups(e.attrGroups);break}}if(c=a.getChildNodes())for(d=0;d<c.length;d++)this._applyParsedProperties(c[d],b)}};
DvtBaseTreeParser.prototype._getChildNodesByName=function(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d];e&&e.getName()==b&&c.push(e)}return c};
DvtBaseTreeParser.prototype._parseStyles=function(a,b){var c={},d=new DvtCSSStyle(a.getAttr("top"));c[DvtBaseTreeView.BACKGROUND_STYLE]=d;c[DvtBaseTreeNode.ANIMATION_UPDATE_COLOR_STYLE]=d.getStyle(DvtBaseTreeParser.ANIMATION_UPDATE_COLOR);d=new DvtCSSStyle(a.getAttr("node"));c[DvtBaseTreeNode.LABEL_TEXT_DEFAULT_STYLE]=d;var e=d.clone().merge(new DvtCSSStyle(a.getAttr("node-hover"))),g=d.clone().merge(new DvtCSSStyle(a.getAttr("node-selected")));b.dropSiteFillColor=a.getAttr(DvtBaseTreeParser.ATTR_DROP_SITE_FILL_COLOR);
b.dropSiteBorderColor=a.getAttr(DvtBaseTreeParser.ATTR_DROP_SITE_BORDER_COLOR);b.dropSiteOpacity=a.getAttr(DvtBaseTreeParser.ATTR_DROP_SITE_OPACITY);this.ParseAdditionalNodeStyles(d,e,g,c);this.ParseAdditionalStyles(a,c);d=new DvtCSSStyle(a.getAttr("rootText"));c[DvtBaseTreeView.TEXT_STYLE]=d;d=new DvtCSSStyle(a.getAttr("attrType"));c[DvtBaseTreeView.ATTRIBUTE_TYPE_STYLE]=d;d=new DvtCSSStyle(a.getAttr("attrValue"));c[DvtBaseTreeView.ATTRIBUTE_VALUE_STYLE]=d;d=new DvtCSSStyle(a.getAttr("drillText"));
c[DvtBaseTreeView.DRILL_TEXT_STYLE]=d;d=new DvtCSSStyle(a.getAttr("currentText"));c[DvtBaseTreeView.CURRENT_TEXT_STYLE]=d;return c};DvtBaseTreeParser.prototype.ParseAdditionalNodeStyles=function(){};DvtBaseTreeParser.prototype.ParseAdditionalStyles=function(){};DvtBaseTreeParser.prototype._parseTemplates=function(a){var a=this._getChildNodesByName(a,DvtBaseTreeParser._ELEM_F),b=a.length;if(0<b){for(var c,d,e={},g=0;g<b;g++)c=a[g],d=c.getAttr("name"),e[d]=DvtAfComponentFactory.parseXml(c);return e}return null};
DvtBaseTreeParser.prototype._parseELData=function(a,b){a.SetElAttributes&&a.SetElAttributes(DvtPropMap.toELContext(b))};DvtBaseTreeParser.prototype._parseAncestors=function(a){for(var b=[],a=a.getChildNodes(),c=0;c<a.length;c++){var d=a[c].getAttr(DvtBaseTreeParser.ATTR_ID),e=a[c].getAttr(DvtBaseTreeParser.ATTR_LABEL);b.push({id:d,text:e})}return b};DvtBaseTreeParser.prototype._parseResources=function(a){for(var b={},a=a.getAttributes(),c=0;c<a.length;c++)b[a[c].name]=a[c].value;return b};
DvtBaseTreeParser.applyDisclosure=function(a,b,c){var d=a.indexOf('<n id="'+b),e=a.indexOf(">",d),b=a.substring(d,e),b=-1<b.indexOf(DvtBaseTreeParser.ATTR_DISCLOSED+"=")?c?b.replace(DvtBaseTreeParser.ATTR_DISCLOSED+'="f"',DvtBaseTreeParser.ATTR_DISCLOSED+'="t"'):b.replace(DvtBaseTreeParser.ATTR_DISCLOSED+'="t"',DvtBaseTreeParser.ATTR_DISCLOSED+'="f"'):b+(DvtBaseTreeParser.ATTR_DISCLOSED+(c?'="t"':'="f"')),c=a.substring(0,d),a=a.substring(e);return c+b+a};var DvtBaseTreeNode=function(){};
DvtObj.createSubclass(DvtBaseTreeNode,DvtObj,"DvtBaseTreeNode");DvtBaseTreeNode._ANIMATION_DELETE_PRIORITY=0;DvtBaseTreeNode._ANIMATION_UPDATE_PRIORITY=1;DvtBaseTreeNode._ANIMATION_INSERT_PRIORITY=2;DvtBaseTreeNode._ANIMATION_UPDATE_COLOR=null;DvtBaseTreeNode._DEFAULT_FILL_COLOR="#000000";DvtBaseTreeNode._DEFAULT_TEXT_SIZE=11;DvtBaseTreeNode._DEFAULT_TEMPLATE_NAME="content";DvtBaseTreeNode._ROOT_TEMPLATE_NAME="rootContent";DvtBaseTreeNode.__NODE_SELECTED_SHADOW=new DvtShadow("#000000",2,5,5,45,0.5);
DvtBaseTreeNode.ANIMATION_UPDATE_COLOR_STYLE="ANIMATION_UPDATE_COLOR_STYLE";DvtBaseTreeNode.LABEL_TEXT_DEFAULT_STYLE="LABEL_TEXT_DEFAULT_STYLE";
DvtBaseTreeNode.prototype.Init=function(a,b,c){this._view=a;this._templateId=b.templateId;this._menuId=b.menuId;this._agColor=b.agColor;this._id=b.id;this._size=b.size;this._color=b.color?b.color:DvtBaseTreeNode._DEFAULT_FILL_COLOR;this._pattern=b.pattern;this._textStr=b.label;this._datatip=b.tooltip;this._labelStyle=b.labelStyle;this._drilling=b.drilling;this._disclosed=b.disclosed;this._indexInParent=b.indexInParent;this._bArtificialRoot=b.bArtificialRoot;this._alpha=1;this._lastVisitedChild=null;
this._isShowingKeyboardFocusEffect=!1;this._templates=c;b.templateName?this._setTemplate(b.templateName):c&&c[DvtBaseTreeNode._DEFAULT_TEMPLATE_NAME]?this._setTemplate(DvtBaseTreeNode._DEFAULT_TEMPLATE_NAME):c&&c[DvtBaseTreeNode._ROOT_TEMPLATE_NAME]&&this._setTemplate(DvtBaseTreeNode._ROOT_TEMPLATE_NAME);this.IsHover=!1;this.Selectable=b.selectable};DvtBaseTreeNode.prototype.setChildNodes=function(a){if(null!=a)for(var b=0;b<a.length;b++)a[b]._parent=this;this._children=a};
DvtBaseTreeNode.prototype.getChildNodes=function(){return this._children};DvtBaseTreeNode.prototype.getDescendantNodes=function(){var a=[],b,c;if(!this.hasChildren())return a;for(var d=0;d<this._children.length;d++)c=this._children[d],b=c.getDescendantNodes(),a.push(c),a=a.concat(b);return a};DvtBaseTreeNode.prototype.SetLastVisitedChild=function(a){this._lastVisitedChild=a};DvtBaseTreeNode.prototype.GetLastVisitedChild=function(){return this._lastVisitedChild};
DvtBaseTreeNode.prototype.MarkAsLastVisitedChild=function(){var a=this.GetParent();a&&a.SetLastVisitedChild(this)};DvtBaseTreeNode.prototype.isDescendantOf=function(a){return!a||!this.GetParent()?!1:this.GetParent()==a?!0:this.GetParent().isDescendantOf(a)};DvtBaseTreeNode.prototype.GetNodesAtDepth=function(a,b){var c=[];if(0>b)return c;if(0==b)return[this];if(a.hasChildren())for(var d=a.getChildNodes(),e,g=0;g<d.length;g++)e=d[g],c=c.concat(e.GetNodesAtDepth(e,b-1));return c};
DvtBaseTreeNode.prototype.getLeafNodes=function(){var a=[],b;if(!this.hasChildren())return[this];for(var c=0;c<this._children.length;c++)b=this._children[c],b=b.getLeafNodes(),a=a.concat(b);return a};DvtBaseTreeNode.getNodeById=function(a,b){if(a.getId()==b)return a;for(var c=null,d=a.getChildNodes(),e=d.length,c=null,g=0;g<e;g++)if(c=d[g],c=DvtBaseTreeNode.getNodeById(c,b))return c;return null};DvtBaseTreeNode.prototype.getView=function(){return this._view};
DvtBaseTreeNode.prototype.getTemplateId=function(){return this._templateId};DvtBaseTreeNode.prototype.getId=function(){return this._id};DvtBaseTreeNode.prototype.getSize=function(){return this._size};DvtBaseTreeNode.prototype.getColor=function(){return this._color};DvtBaseTreeNode.prototype.getDatatip=function(){return this._datatip};DvtBaseTreeNode.prototype.getDatatipColor=function(){return this._color};DvtBaseTreeNode.prototype.getAlpha=function(){return this._alpha};
DvtBaseTreeNode.prototype.setAlpha=function(a){this._alpha=a;this._shape&&this._shape.setAlpha(this._alpha)};DvtBaseTreeNode.prototype.isDisclosed=function(){return this._disclosed};DvtBaseTreeNode.prototype.isArtificialRoot=function(){return this._bArtificialRoot};DvtBaseTreeNode.prototype.isDrillReplaceEnabled=function(){return"r"==this._drilling||"ir"==this._drilling};DvtBaseTreeNode.prototype.setShowPopupBehaviors=function(a){this._showPopupBehaviors=a};
DvtBaseTreeNode.prototype.getShowPopupBehaviors=function(){return this._showPopupBehaviors};DvtBaseTreeNode.prototype.getContextMenuId=function(){return this._menuId};DvtBaseTreeNode.prototype.render=function(){};DvtBaseTreeNode.prototype.renderChildren=function(a){var b=this.getChildNodes();if(null!=b)for(var c=0;c<b.length;c++)b[c].render(a)};DvtBaseTreeNode.prototype.processAttrGroups=function(a){if(a=a.get(this._agColor))this._color=a};
DvtBaseTreeNode.prototype.getNextNavigable=function(){this.MarkAsLastVisitedChild();return this};DvtBaseTreeNode.prototype.getKeyboardBoundingBox=function(){return new DvtRectangle(0,0,0,0)};DvtBaseTreeNode.prototype.showKeyboardFocusEffect=function(){this.showHoverEffect();this.handleMouseOver&&this.handleMouseOver();this._isShowingKeyboardFocusEffect=!0};
DvtBaseTreeNode.prototype.hideKeyboardFocusEffect=function(){this.isShowingKeyboardFocusEffect()&&this.hideHoverEffect();this.handleMouseOut&&this.handleMouseOut();this._isShowingKeyboardFocusEffect=!1};DvtBaseTreeNode.prototype.isShowingKeyboardFocusEffect=function(){return this._isShowingKeyboardFocusEffect};DvtBaseTreeNode.prototype.handleMouseOver=function(){this.IsHover=!0};DvtBaseTreeNode.prototype.handleMouseOut=function(){this.IsHover=!1};DvtBaseTreeNode.prototype.isSelectable=function(){return!0};
DvtBaseTreeNode.prototype.isSelected=function(){return this._selected};DvtBaseTreeNode.prototype.setSelected=function(a){this._selected=a};DvtBaseTreeNode.prototype.showHoverEffect=function(){};DvtBaseTreeNode.prototype.hideHoverEffect=function(){};DvtBaseTreeNode.prototype.isDragAvailable=function(a){return this.getView().__isDragAvailable(a)};DvtBaseTreeNode.prototype.getDragTransferable=function(){return this.getView().__getDragTransferable(this)};DvtBaseTreeNode.prototype.getDragFeedback=function(){return this.getView().__getDragFeedback()};
DvtBaseTreeNode.prototype.getDropSiteFeedback=function(){return null};DvtBaseTreeNode.prototype.__getDisplayable=function(){return this._shape};DvtBaseTreeNode.prototype.getPopupBounds=function(){return null};DvtBaseTreeNode.prototype.contains=function(){return!1};DvtBaseTreeNode.prototype.getNodeUnderPoint=function(){return null};DvtBaseTreeNode.prototype.GetAnimationParams=function(){return[]};DvtBaseTreeNode.prototype.SetAnimationParams=function(){};
DvtBaseTreeNode.prototype.animateUpdate=function(a,b){a.isDrillAnimation()||a.constructAnimation(b.getChildNodes(),this.getChildNodes());var c=b.GetAnimationParams(),d=this.GetAnimationParams(),e;if(!DvtArrayUtils.equals(c,d)&&(e=new DvtCustomAnimation(this.getView().getCtx(),this,this.getView().__getAnimationDuration()),e.getAnimator().addProp(DvtAnimator.TYPE_NUMBER_ARRAY,this,this.GetAnimationParams,this.SetAnimationParams,d),a.add(e,DvtBaseTreeNode._ANIMATION_UPDATE_PRIORITY),d=this._size!=b._size,
e=DvtColorUtils.getRGBA(this._color)!=DvtColorUtils.getRGBA(b._color),this.SetAnimationParams(c),(c=this.getResolvedColor(DvtBaseTreeNode._ANIMATION_UPDATE_COLOR,DvtBaseTreeNode.ANIMATION_UPDATE_COLOR_STYLE))&&(d||e)))this._color=c};
DvtBaseTreeNode.prototype.animateInsert=function(a){if(!a.isDrillAnimation()||!a.isAncestorInsert(this)){this.setAlpha(0);var b=new DvtAnimFadeIn(this.getView().getCtx(),this,this.getView().__getAnimationDuration());a.add(b,DvtBaseTreeNode._ANIMATION_INSERT_PRIORITY);for(b=0;b<this._children.length;b++)this._children[b].animateInsert(a)}};
DvtBaseTreeNode.prototype.animateDelete=function(a,b){b.addChild(this._shape);var c=new DvtAnimFadeOut(this.getView().getCtx(),this,this.getView().__getAnimationDuration());a.add(c,DvtBaseTreeNode._ANIMATION_DELETE_PRIORITY);if(!a.isDrillAnimation())for(c=0;c<this._children.length;c++)this._children[c].animateDelete(a,b)};DvtBaseTreeNode.prototype.hasChildren=function(){return null!=this._children&&0<this._children.length};DvtBaseTreeNode.prototype.GetParent=function(){return this._parent};
DvtBaseTreeNode.prototype.GetDepth=function(){for(var a=0,b=this.GetParent();b;)a++,b=b.GetParent();return a};DvtBaseTreeNode.prototype.GetFill=function(){return this._pattern?new DvtPatternFill(this._pattern,this._color):new DvtSolidFill(this._color)};DvtBaseTreeNode.GetNodeTextColor=function(a){if(a._pattern)return"#000000";var b=a._color,a=DvtColorUtils.getRed(b),c=DvtColorUtils.getGreen(b),b=DvtColorUtils.getBlue(b);return 128<=(299*a+587*c+114*b)/1E3?"#000000":"#FFFFFF"};
DvtBaseTreeNode.prototype.ApplyLabelTextStyle=function(a){var b=DvtBaseTreeNode.LABEL_TEXT_DEFAULT_STYLE,c=DvtBaseTreeNode.GetNodeTextColor(this);a.setSolidFill(c);c=[];c.push(this._view.__getStyles()[b]);this._labelStyle&&c.push(this._labelStyle);a.setCSSStyle(DvtCSSStyle.mergeStyles(c))};DvtBaseTreeNode.prototype.getResolvedColor=function(a,b){var c=a,d=this._view.__getStyles()[b];d&&(c=d);return c};
DvtBaseTreeNode.prototype.GetTextSize=function(){var a=DvtBaseTreeNode._DEFAULT_TEXT_SIZE,b=this._view.__getStyles()[DvtBaseTreeNode.LABEL_TEXT_DEFAULT_STYLE].getFontSize();b&&(a=parseFloat(b));return a};DvtBaseTreeNode.prototype.getIndexInParent=function(){return this._indexInParent};DvtBaseTreeNode.prototype.getDisplayable=function(){return this._shape};DvtBaseTreeNode.prototype.getLabel=function(){return this._textStr};DvtBaseTreeNode.prototype.GetAfContext=function(){return this.getView().__getAfContext()};
DvtBaseTreeNode.prototype.SetElAttributes=function(a){a&&!this._template&&this._setTemplate(DvtBaseTreeNode._DEFAULT_TEMPLATE_NAME);this._elAttributes=a};DvtBaseTreeNode.prototype.GetElAttributes=function(){return this._elAttributes};DvtBaseTreeNode.prototype._setTemplate=function(a){a&&(this._template=this._templates[a])};DvtBaseTreeNode.prototype.GetTemplate=function(){return this._template};DvtBaseTreeNode.prototype.isDoubleClickable=function(){return this.isDrillReplaceEnabled()};
var DvtBaseTreePeer=function(a,b,c,d,e){this.Init(c,d,e);this._node=a;this._id=b;this._bDrillable=!1};DvtObj.createSubclass(DvtBaseTreePeer,DvtSimpleObjPeer,"DvtBaseTreePeer");DvtBaseTreePeer.prototype.getId=function(){return this._id};DvtBaseTreePeer.prototype.isDrillable=function(){return this._bDrillable};DvtBaseTreePeer.prototype.setDrillable=function(a){this._bDrillable=a};DvtBaseTreePeer.prototype.handleMouseOut=function(){this._node&&this._node.handleMouseOut&&this._node.handleMouseOut()};
var DvtTreeBreadcrumbsRenderer=function(){};DvtObj.createSubclass(DvtTreeBreadcrumbsRenderer,DvtObj,"DvtTreeBreadcrumbsRenderer");DvtTreeBreadcrumbsRenderer._COMPONENT_GAP=6;DvtTreeBreadcrumbsRenderer._ENABLED_INLINE_STYLE="color: #003286;";
DvtTreeBreadcrumbsRenderer.render=function(a,b,c,d){var e=a.getCtx(),g=[];g.push(a.__getStyles()[DvtBaseTreeView.TEXT_STYLE]);g.push(new DvtCSSStyle(DvtTreeBreadcrumbsRenderer._ENABLED_INLINE_STYLE));g.push(a.__getStyles()[DvtBaseTreeView.DRILL_TEXT_STYLE]);var g=DvtCSSStyle.mergeStyles(g).toString(),h=g+"text-decoration: underline;",k=[];k.push(a.__getStyles()[DvtBaseTreeView.TEXT_STYLE]);k.push(a.__getStyles()[DvtBaseTreeView.CURRENT_TEXT_STYLE]);k=DvtCSSStyle.mergeStyles(k).toString();e=new DvtBreadcrumbs(e,
a.__processBreadcrumbsEvent,a,{labelStyle:g,labelStyleOver:h,labelStyleDown:h,disabledLabelStyle:k});a.addChild(e);c=c.slice(0).reverse();c.push({text:d});e.render({items:c},b.w);d=e.getDimensions();e.setTranslate(b.x,b.y);d=d.h+DvtTreeBreadcrumbsRenderer._COMPONENT_GAP;b.y+=d;b.h-=d;a.removeChild(e);return e};var DvtTreeLegendRenderer=function(){};DvtObj.createSubclass(DvtTreeLegendRenderer,DvtObj,"DvtTreeLegendRenderer");DvtTreeLegendRenderer._LEGEND_GAP=4;
DvtTreeLegendRenderer._LEGEND_LABEL_GAP=7;DvtTreeLegendRenderer._LEGEND_SECTION_GAP=24;DvtTreeLegendRenderer._LABEL_SIZE=11;DvtTreeLegendRenderer._LABEL_COLOR="#636363";DvtTreeLegendRenderer._LABEL_INLINE_STYLE="color:"+DvtTreeLegendRenderer._LABEL_COLOR+";";
DvtTreeLegendRenderer.render=function(a,b,c,d,e,g,h){var k=a.getCtx(),m=a.__getEventManager(),n=new DvtContainer(k);a.addChild(n);var o=DvtTreeLegendRenderer._renderLabels(k,a,n,b.w,c,d,e,g,h),s=a.__getResources().alta?null:"#000000",t=[];t.push(a.__getStyles()[DvtBaseTreeView.TEXT_STYLE]);var t={borderColor:s,labelStyle:DvtCSSStyle.mergeStyles(t)},s=DvtLegendAttrGroupsRenderer.renderAttrGroups(k,m,n,b.w,b.h,h,t),u=o?o.getDimensions():null,v=s?s.getDimensions():null;if(o&&!s)o.setTranslateX(b.y+(b.w-
u.w)/2);else if(s&&!o)s.setTranslateX(b.y+(b.w-v.w)/2);else if(s&&o){var w=b.w-DvtTreeLegendRenderer._LEGEND_SECTION_GAP;u.w+v.w>w&&(u.w>w/2&&v.w>w/2?(n.removeChild(o),n.removeChild(s),o=DvtTreeLegendRenderer._renderLabels(k,a,n,w/2,c,d,e,g,h),s=DvtLegendAttrGroupsRenderer.renderAttrGroups(k,m,n,w/2,b.h,h,t)):u.w>v.w?(m=w-v.w,n.removeChild(o),o=DvtTreeLegendRenderer._renderLabels(k,a,n,m,c,d,e,g,h)):(c=w-u.w,n.removeChild(s),s=DvtLegendAttrGroupsRenderer.renderAttrGroups(k,m,n,c,b.h,h,t)),u=o.getDimensions(),
v=s.getDimensions());DvtAgent.isRightToLeft(k)?(s.setTranslateX(b.x),o.setTranslateX(b.x+b.w-u.w)):(o.setTranslateX(b.x),s.setTranslateX(b.x+b.w-v.w))}h=n.getDimensions();n.setTranslateY(b.y+b.h-h.h);b.h-=h.h+DvtTreeLegendRenderer._LEGEND_GAP;a.removeChild(n);return n};
DvtTreeLegendRenderer._renderLabels=function(a,b,c,d,e,g,h,k){var m=DvtAgent.isRightToLeft(a),n=b.__getEventManager(),o=null;if(h||k){o=new DvtContainer(a);c.addChild(o);var s=[];s.push(b.__getStyles()[DvtBaseTreeView.TEXT_STYLE]);s.push(b.__getStyles()[DvtBaseTreeView.ATTRIBUTE_TYPE_STYLE]);c=DvtCSSStyle.mergeStyles(s);s=[];s.push(b.__getStyles()[DvtBaseTreeView.TEXT_STYLE]);s.push(b.__getStyles()[DvtBaseTreeView.ATTRIBUTE_VALUE_STYLE]);var s=DvtCSSStyle.mergeStyles(s),t,u,v,w,b=0;h&&(t=new DvtOutputText(a,
e,0,0),t.setCSSStyle(c),o.addChild(t),v=t.measureDimensions().w,u=new DvtOutputText(a,h,0,0),u.setCSSStyle(s),o.addChild(u),w=u.measureDimensions().w,b=v+w+DvtTreeLegendRenderer._LEGEND_LABEL_GAP);var z,A,C,D,e=0;k&&(z=new DvtOutputText(a,g,0,0),z.setCSSStyle(c),o.addChild(z),C=z.measureDimensions().w,A=new DvtOutputText(a,k,0,0),A.setCSSStyle(s),o.addChild(A),D=A.measureDimensions().w,e=C+D+DvtTreeLegendRenderer._LEGEND_LABEL_GAP);d-=DvtTreeLegendRenderer._LEGEND_SECTION_GAP;b+e>d&&(a=d/2,b>a&&e>
a?(DvtTextUtils.fitText(u,a-v-DvtTreeLegendRenderer._LEGEND_LABEL_GAP,Infinity,o)?(w=u.measureDimensions().w,n.associate(u,new DvtSimpleObjPeer(h))):(o.removeChild(t),o.removeChild(u),u=null,w=0),DvtTextUtils.fitText(A,a-C-DvtTreeLegendRenderer._LEGEND_LABEL_GAP,Infinity,o)?(D=A.measureDimensions().w,n.associate(A,new DvtSimpleObjPeer(k))):(o.removeChild(z),o.removeChild(A),A=null,D=0)):b>e?DvtTextUtils.fitText(u,d-e-v-DvtTreeLegendRenderer._LEGEND_LABEL_GAP,Infinity,o)?(w=u.measureDimensions().w,
n.associate(u,new DvtSimpleObjPeer(h))):(o.removeChild(t),o.removeChild(u),u=null,w=0):DvtTextUtils.fitText(A,d-b-C-DvtTreeLegendRenderer._LEGEND_LABEL_GAP,Infinity,o)?(D=A.measureDimensions().w,n.associate(A,new DvtSimpleObjPeer(k))):(o.removeChild(z),o.removeChild(A),A=null,D=0));d=0;m?(A&&(A.setX(d),d+=D+DvtTreeLegendRenderer._LEGEND_LABEL_GAP,z.setX(d),d+=C+DvtTreeLegendRenderer._LEGEND_SECTION_GAP),u&&(u.setX(d),d+=w+DvtTreeLegendRenderer._LEGEND_LABEL_GAP,t.setX(d))):(u&&(t.setX(d),d+=v+DvtTreeLegendRenderer._LEGEND_LABEL_GAP,
u.setX(d),d+=w+DvtTreeLegendRenderer._LEGEND_SECTION_GAP),A&&(z.setX(d),d+=C+DvtTreeLegendRenderer._LEGEND_LABEL_GAP,A.setX(d)))}return o};var DvtBaseTreeKeyboardHandler=function(a){this.Init(a)};DvtObj.createSubclass(DvtBaseTreeKeyboardHandler,DvtKeyboardHandler,"DvtBaseTreeKeyboardHandler");DvtBaseTreeKeyboardHandler.prototype.isSelectionEvent=function(a){return this.isNavigationEvent(a)&&!a.ctrlKey};
DvtBaseTreeKeyboardHandler.prototype.isMultiSelectEvent=function(a){return a.keyCode==DvtKeyboardEvent.SPACE&&a.ctrlKey};var DvtBaseTreeDefaults=function(){};DvtObj.createSubclass(DvtBaseTreeDefaults,DvtBaseComponentDefaults,"DvtBaseTreeDefaults");
DvtBaseTreeDefaults.VERSION_1={skin:DvtCSSStyle.SKIN_SKYROS,emptyText:"No data to display",nodeDefaults:{labelStyle:new DvtCSSStyle("font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 11px;")},styleDefaults:{_attributeTypeTextStyle:new DvtCSSStyle("font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:12px;font-weight:bold;color:#4F4F4F"),_attributeValueTextStyle:new DvtCSSStyle("font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;font-size:12px;")},_resources:{}};
DvtBaseTreeDefaults.prototype.Init=function(a){a={skyros:DvtJSONUtils.merge(a.skyros,DvtBaseTreeDefaults.VERSION_1),alta:DvtJSONUtils.merge(a.alta,{})};DvtBaseTreeDefaults.superclass.Init.call(this,a)};var DvtBaseTreeJsonUtils=function(){};DvtObj.createSubclass(DvtBaseTreeJsonUtils,DvtObj,"DvtBaseTreeJsonUtils");DvtBaseTreeJsonUtils.prototype.toXml=function(a){var b=this.StartComponentElement(a);if(a&&a.nodes)for(var c=a.nodes,d=0;d<c.length;d++)b+=this.WriteNodeElement(a,c[d]);return b+=this.EndComponentElement(a)};
DvtBaseTreeJsonUtils.prototype.WriteAttr=function(a,b){return null!=b?" "+a+'="'+b+'"':""};DvtBaseTreeJsonUtils.prototype.GetComponentName=function(){return null};DvtBaseTreeJsonUtils.prototype.StartComponentElement=function(a){var b="<"+this.GetComponentName(),b=b+this.WriteComponentAttributes(a);return b+">\n"};
DvtBaseTreeJsonUtils.prototype.WriteComponentAttributes=function(a){var b;b=""+this.WriteAttr("sv",a.sizeLabel);b+=this.WriteAttr("cv",a.colorLabel);var c=a.attributeGroups?a.attributeGroups[0]:null;c&&(b+=this.WriteAttr("ls",c.id));for(var c=a.selectedNodes?a.selectedNodes:[],d="",e=0;e<c.length;e++)0<d.length&&(d+=","),d+=c[e];0<d.length&&(b+=this.WriteAttr("selIds",d));b+=this.WriteAttr("adu",a.animationDuration);b+=this.WriteAttr("adc",a.animationOnDataChange);b+=this.WriteAttr("emptyText",a.emptyText);
b+=this.WriteAttr("sel",a.selection);return b+=this.WriteAttr("sort",a.sorting)};DvtBaseTreeJsonUtils.prototype.EndComponentElement=function(a){var b;b="<a/>\n"+this.WriteResourcesElement(a);b+=this.WriteStyleElement(a);b+=this.WriteAttributeGroupsElement(a);return b+="</"+this.GetComponentName()+">"};
DvtBaseTreeJsonUtils.prototype.WriteNodeElement=function(a,b){var c;c="<n"+this.WriteNodeAttributes(a,b);if(b&&b.nodes&&0<b.nodes.length){c+=this.WriteAttr("di","t");c+=">\n";for(var d=b.nodes,e=0;e<d.length;e++)c+=this.WriteNodeElement(a,d[e]);c+="</n>\n"}else c+="/>\n";return c};
DvtBaseTreeJsonUtils.prototype.WriteNodeAttributes=function(a,b){var c;c=""+this.WriteAttr("id",b.id);c+=this.WriteAttr("s",b.value);c+=this.WriteAttr("c",b.color);c+=this.WriteAttr("l",b.label);c+=this.WriteAttr("p",b.pattern);c+=this.WriteAttr("tt",b.shortDesc?b.shortDesc:b.tooltip);c+=this.WriteAttr("ls",b.labelStyle?b.labelStyle:a.nodeDefaults.labelStyle);var d=b.drilling?b.drilling:a.nodeDefaults.drilling;"insert"==d?c+=this.WriteAttr("d","i"):"replace"==d?c+=this.WriteAttr("d","r"):"insertAndReplace"==
d&&(c+=this.WriteAttr("d","ir"));return c+=this.WriteAttr("nsel",b.selectable?b.selectable:"auto")};
DvtBaseTreeJsonUtils.prototype.WriteAttributeGroupsElement=function(a){var b=a.attributeGroups?a.attributeGroups[0]:null;if(!b)return"";a='<ag id="'+b.id+'"';if("continuous"==b.attributeType)a+=this.WriteAttr("t","continuous"),a+=this.WriteAttr("ramp",b.colors.join(";")),a+=this.WriteAttr("minValue",b.min),a+=this.WriteAttr("maxValue",b.max),a+=this.WriteAttr("minLabel",b.minLabel),a+=this.WriteAttr("maxLabel",b.maxLabel),a+="/>";else{for(var a=a+">\n",b=b.groups,c=0;c<b.length;c++)a+="<i",a+=this.WriteAttr("g",
b[c].id),a+=this.WriteAttr("l",b[c].label),a+=this.WriteAttr("c",b[c].color),a+=this.WriteAttr("p",b[c].pattern),a+="/>\n";a+="</ag>\n"}return a};DvtBaseTreeJsonUtils.prototype.WriteResourcesElement=function(){};DvtBaseTreeJsonUtils.prototype.WriteStyleElement=function(a){var b;b="<styles "+this.WriteAttr("attrType",a.styleDefaults._attributeTypeTextStyle);return b+=this.WriteAttr("attrValue",a.styleDefaults._attributeValueTextStyle)};var DvtTreeAutomation=function(a){this._Init(a)};
DvtObj.createSubclass(DvtTreeAutomation,DvtObj,"DvtTreeAutomation");DvtTreeAutomation.prototype._Init=function(a){this._treeView=a};DvtTreeAutomation.NODE_ID_PREFIX="node";DvtTreeAutomation.AUTOMATION_NO_EVENT=-1;DvtTreeAutomation.AUTOMATION_MOUSE_CLICK=0;DvtTreeAutomation.prototype.getSubIdFromCoord=function(a,b){var c=this._treeView.getCtx().getDocumentUtils().elementFromPoint(a,b);return c?this.getSubIdFromObj(c):null};
DvtTreeAutomation.prototype.getSubIdFromEvent=function(a){return this.getSubId(a.pageX,a.pageY,a.target)};DvtTreeAutomation.prototype.getSubId=function(a,b,c){return this.getSubIdFromObj(c)};DvtTreeAutomation.prototype.getSubIdFromObj=function(a){a=this._treeView.getLogicalObject(a);if(!a)return null;if(a instanceof DvtBaseTreeNode){for(var b="["+a.getIndexInParent()+"]",a=a.GetParent();a;)b="["+a.getIndexInParent()+"]"+b,a=a.GetParent();return DvtTreeAutomation.NODE_ID_PREFIX+b}return null};
DvtTreeAutomation.prototype.click=function(a){this.processSubId(a,DvtTreeAutomation.AUTOMATION_MOUSE_CLICK)};
DvtTreeAutomation.prototype.processSubId=function(a,b){void 0===b&&(b=DvtTreeAutomation.AUTOMATION_NO_EVENT);if(null==a)return null;var c;if(b!=DvtTreeAutomation.AUTOMATION_NO_EVENT){if(b==DvtTreeAutomation.AUTOMATION_MOUSE_CLICK){var d=DvtTreeAutomation._convertSubIdToArray(a);d&&d[0]==DvtTreeAutomation.NODE_ID_PREFIX&&(d=DvtTreeAutomation._FindNode(this._treeView.getRootNode(),d,1))&&d.getDisplayable().dispatchDisplayableEvent(DvtMouseEvent.CLICK)}}else if((d=DvtTreeAutomation._convertSubIdToArray(a))&&
d[0]==DvtTreeAutomation.NODE_ID_PREFIX){var e=d.length-1,g=d[e];0<=g.indexOf("#")&&(d[e]=null,(d=DvtTreeAutomation._FindNode(this._treeView.getRootNode(),d,1))&&("#label"==g?c=d.getLabel():"#size"==g?c=d.getSize():"#color"==g?c=d.getColor():"#tooltip"==g&&(c=d.getDatatip())))}return c};DvtTreeAutomation._FindNode=function(a,b,c){var d=null;if(a.getIndexInParent()==b[c])if(null==b[c+1])d=a;else if(a=a.getChildNodes())for(var e=0;e<a.length&&!(d=DvtTreeAutomation._FindNode(a[e],b,c+1));e++);return d};
DvtTreeAutomation._convertSubIdToArray=function(a){for(var a=a.split("["),b=DvtTreeAutomation._parseSubSubId(a),c=a.length,d=1;d<c;d++){var e=a[d],e=e.substr(0,e.length-1);tempIdAsNumber=parseFloat(e);e=isNaN(tempIdAsNumber)?e:tempIdAsNumber;a[d]=e}b&&(a[c]=b);return a};DvtTreeAutomation._parseSubSubId=function(a){var b=null;if(a&&0<=a.length){var c=a.length-1,d=a[c],e=d.indexOf("#");0<e&&(a[c]=d.substr(0,e),b=d.substr(e))}return b};
DvtTreeAutomation.prototype.sendClickToQA=function(){null!=m_JSClickCallback&&ExternalInterface&&ExternalInterface.call(m_JSClickCallback,"")};DvtTreeAutomation.prototype.setJSClickCallback=function(a){m_JSClickCallback=a};