var DvtNBox=function(){};DvtObj.createSubclass(DvtNBox,DvtBaseComponent,"DvtNBox");DvtNBox.newInstance=function(a,b,c){return new DvtNBoxImpl(a,b,c)};DvtNBox.getDefaults=function(a){return(new DvtNBoxDefaults).getDefaults(a)};
DvtNBox.prototype.Init=function(a,b,c){DvtNBox.superclass.Init.call(this,a,b,c);this.Bundle=new DvtNBoxBundle;this.Defaults=new DvtNBoxDefaults;this.EventManager=new DvtNBoxEventManager(this);this.EventManager.addListeners(this);this._dragSource=new DvtDragSource(a);this._dropTarget=new DvtNBoxDropTarget(this);this.EventManager.setDragSource(this._dragSource);DvtAgent.isTouchDevice()||this.EventManager.setKeyboardHandler(this.CreateKeyboardHandler(this.EventManager));this.setId("nbox1000"+Math.floor(1E9*
Math.random()));this._animation=null};DvtNBox.prototype.SetOptions=function(a){a?(this.Options=this.Defaults.calcOptions(a),DvtNBoxDataUtils.processDataObject(this),DvtAgent.isEnvironmentBrowser()||(this.Options.animationOnDisplay="none",this.Options.animationOnDataChange="none")):this.Options||(this.Options=this.GetDefaults());this._displayables=[]};
DvtNBox.prototype.render=function(a,b,c){var d=DvtNBoxStyleUtils.getAnimationOnDataChange(this),e=null;this.Options&&"none"!==d&&(e={options:this.Options,getOptions:function(){return this.options},displayables:this._displayables,getDisplayables:function(){return this.displayables},id:this.getId(),getId:function(){return this.id}},e.getOptions=e.getOptions,e.getDisplayables=e.getDisplayables,e.getId=e.getId);this.__cleanUp();this.SetOptions(a);!isNaN(b)&&!isNaN(c)&&(this.Width=b,this.Height=c);b=new DvtContainer(this.getCtx());
this.addChild(b);DvtNBoxRenderer.render(this,b,new DvtRectangle(0,0,this.Width,this.Height));this._updateKeyboardFocusEffect(e);this._animation&&(this._animationStopped=!0,this._animation.stop());var g=DvtNBoxStyleUtils.getAnimationOnDisplay(this),h=DvtNBoxStyleUtils.getAnimationDuration(this),k=new DvtRectangle(0,0,this.Width,this.Height),c=!1;this._container?"none"!=d&&a&&((this._animation=DvtBlackBoxAnimationHandler.getCombinedAnimation(this.getCtx(),d,this._container,b,k,h))?c=!0:(this._deleteContainer=
new DvtContainer(this.getCtx(),"DeleteContainer"),this.addChild(this._deleteContainer),a=new DvtNBoxDataAnimationHandler(this.getCtx(),this._deleteContainer,e,this),a.constructAnimation([e],[this]),this._animation=a.getAnimation())):"none"!==g&&(this._animation=DvtBlackBoxAnimationHandler.getInAnimation(this.getCtx(),g,b,k,h));this._animation&&(this.setMouseEnabled(!1),this._animation.setOnEnd(this._onAnimationEnd,this),this._animation.play());c?this._oldContainer=this._container:this._container&&
(this.removeChild(this._container),this._container.destroy());this._container=b};DvtNBox.prototype.__cleanUp=function(){this.EventManager.hideTooltip()};DvtNBox.prototype._onAnimationEnd=function(){this._oldContainer&&(this.removeChild(this._oldContainer),this._oldContainer.destroy(),this._oldContainer=null);this._deleteContainer&&(this.removeChild(this._deleteContainer),this._deleteContainer.destroy());this._deleteContainer=null;this._animationStopped=!1;this._animation=null;this.setMouseEnabled(!0)};
DvtNBox.prototype.CreateKeyboardHandler=function(a){return new DvtNBoxKeyboardHandler(a,this)};DvtNBox.prototype.getDeleteContainer=function(){return this._deleteContainer};DvtNBox.prototype.getDisplayables=function(){return this._displayables};
DvtNBox.prototype._updateKeyboardFocusEffect=function(a){var b=this.EventManager.getFocus();if(b){var c;b instanceof DvtNBoxNode?(b=DvtNBoxDataUtils.getNode(this,b.getData().id),c=DvtNBoxDataUtils.getDisplayable(this,b),!c&&b&&DvtNBoxDataUtils.getGroupBehavior(this)!=DvtNBoxConstants.GROUP_BEHAVIOR_ACROSS_CELLS&&(c=DvtNBoxDataUtils.getCellIndex(a,b),c=DvtNBoxDataUtils.getCell(this,c),c=DvtNBoxDataUtils.getDisplayable(this,c))):b instanceof DvtNBoxCategoryNode?(a=DvtNBoxDataUtils.getDrawer(this))&&
(c=DvtNBoxDataUtils.getDisplayable(this,a)):b instanceof DvtNBoxCell?DvtNBoxDataUtils.getGroupBehavior(this)!=DvtNBoxConstants.GROUP_BEHAVIOR_ACROSS_CELLS&&(c=DvtNBoxDataUtils.getDisplayable(this,DvtNBoxDataUtils.getCell(this,DvtNBoxDataUtils.getCellIndex(this,b.getData())))):b instanceof DvtNBoxDrawer&&(c=DvtNBoxDataUtils.getCategoryNode(this,b.getData().id),c=DvtNBoxDataUtils.getDisplayable(this,c));c&&c.showKeyboardFocusEffect();this.EventManager.setFocus(c)}};
DvtNBox.prototype.isDragAvailable=function(a,b,c){return this._dragSource.isDragAvailable(c)};DvtNBox.prototype.getDragTransferable=function(a,b){return this._dragSource.getDragTransferable(a,b)};DvtNBox.prototype.getDragOverFeedback=function(a,b){return this._dragSource.getDragOverFeedback(a,b)};DvtNBox.prototype.getDragContext=function(a,b){return this._dragSource.getDragContext(a,b)};DvtNBox.prototype.getDragOffset=function(a,b){return this._dragSource.getDragOffset(a,b)};
DvtNBox.prototype.getPointerOffset=function(a,b){return this._dragSource.getPointerOffset(a,b)};DvtNBox.prototype.initiateDrag=function(){this._dragSource.initiateDrag()};DvtNBox.prototype.dragDropEnd=function(){this._dragSource.dragDropEnd()};DvtNBox.prototype.acceptDrag=function(a,b,c){return this._dropTarget.acceptDrag(a,b,c)};DvtNBox.prototype.dragEnter=function(){this._dropTarget.dragEnter()};DvtNBox.prototype.dragExit=function(){this._dropTarget.dragExit()};
DvtNBox.prototype.getDropSite=function(a,b){return this._dropTarget.getDropSite(a,b)};var DvtNBoxConstants={};DvtObj.createSubclass(DvtNBoxConstants,DvtObj,"DvtNBoxConstants");DvtNBoxConstants.COLUMNS="columns";DvtNBoxConstants.ROWS="rows";DvtNBoxConstants.CELLS="cells";DvtNBoxConstants.NODES="nodes";DvtNBoxConstants.MAXIMIZED_ROW="maximizedRow";DvtNBoxConstants.MAXIMIZED_COLUMN="maximizedColumn";DvtNBoxConstants.SELECTED_ITEMS="selectedItems";DvtNBoxConstants.SELECTION_INFO="selectionInfo";
DvtNBoxConstants.HIGHLIGHTED_ITEMS="highlightedItems";DvtNBoxConstants.ATTRIBUTE_GROUPS="attributeGroups";DvtNBoxConstants.GROUP_BY="groupBy";DvtNBoxConstants.GROUP_BEHAVIOR="groupBehavior";DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL="withinCell";DvtNBoxConstants.GROUP_BEHAVIOR_ACROSS_CELLS="acrossCells";DvtNBoxConstants.OTHER_COLOR="otherColor";DvtNBoxConstants.OTHER_THRESHOLD="otherThreshold";DvtNBoxConstants.DRAWER="_drawer";DvtNBoxConstants.LEGEND_DISPLAY="legendDisplay";
DvtNBoxConstants.LEGEND_DISCLOSURE="legendDisclosure";DvtNBoxConstants.HIDDEN_CATEGORIES="hiddenCategories";var DvtNBoxImpl=function(a,b,c){this.Init(a,b,c)};DvtObj.createSubclass(DvtNBoxImpl,DvtNBox,"DvtNBoxImpl");DvtNBoxImpl.prototype.Init=function(a,b,c){DvtNBoxImpl.superclass.Init.call(this,a,b,c);this.legend=null;this._peers=[]};
DvtNBoxImpl.prototype.SetOptions=function(a){DvtNBoxImpl.superclass.SetOptions.call(this,a);a=this.Options.selection;this._selectionHandler="single"==a?new DvtSelectionHandler(DvtSelectionHandler.TYPE_SINGLE):"multiple"==a?new DvtSelectionHandler(DvtSelectionHandler.TYPE_MULTIPLE):null;this.EventManager.setSelectionHandler(this._selectionHandler)};DvtNBoxImpl.prototype.getEventManager=function(){return this.EventManager};
DvtNBoxImpl.prototype.processEvent=function(a){var b=a.getType();if(b==DvtCategoryHideShowEvent.TYPE_HIDE||b==DvtCategoryHideShowEvent.TYPE_SHOW)a=this._processHideShowEvent(a);else if(b==DvtCategoryRolloverEvent.TYPE_OVER||b==DvtCategoryRolloverEvent.TYPE_OUT)a=this._processRolloverEvent(a);else if(b==DvtSelectionEvent.TYPE)a=this._processSelectionEvent(a);else if(b==DvtPanelDrawerEvent.TYPE){var b=this.getSanitizedOptions(),c=a.getSubType()==DvtPanelDrawerEvent.SUBTYPE_HIDE?"undisclosed":"disclosed",
a=new DvtSetPropertyEvent;a.addParam(DvtNBoxConstants.LEGEND_DISCLOSURE,c);b[DvtNBoxConstants.LEGEND_DISCLOSURE]=c;this.render(b)}a&&this.__dispatchEvent(a)};
DvtNBoxImpl.prototype._processHideShowEvent=function(a){var b=this.getSanitizedOptions(),c=b[DvtNBoxConstants.HIDDEN_CATEGORIES];c||(c=[]);var d=DvtArrayUtils.getIndex(c,a.getCategory());a.getType()==DvtCategoryHideShowEvent.TYPE_HIDE&&-1==d&&c.push(a.getCategory());a.getType()==DvtCategoryHideShowEvent.TYPE_SHOW&&-1!=d&&c.splice(d,1);0==c.length&&(c=null);a=new DvtSetPropertyEvent;a.addParam(DvtNBoxConstants.HIDDEN_CATEGORIES,c);b[DvtNBoxConstants.HIDDEN_CATEGORIES]=c;this.render(b);return a};
DvtNBoxImpl.prototype._processRolloverEvent=function(a){for(var b=[],c=DvtNBoxDataUtils.getNodeCount(this),d=0;d<c;d++)b.push(DvtNBoxDataUtils.getNode(this,d));d=DvtNBoxDataUtils.getGroupBehavior(this);if(c=this.getOptions().__groups)if(d==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL)for(var e=DvtNBoxDataUtils.getRowCount(this)*DvtNBoxDataUtils.getColumnCount(this),d=0;d<e;d++){var g=c[d+""],h;for(h in g)b.push(g[h])}else for(h in c)b.push(c[h]);h=[];for(d=0;d<b.length;d++)(c=DvtNBoxDataUtils.getDisplayable(this,
b[d]))&&h.push(c);if(a.getType()==DvtCategoryRolloverEvent.TYPE_OVER)for(d=0;d<h.length;d++){a:{b=h[d];if(b instanceof DvtNBoxNode){if(b=b.getData(),b.categories&&-1!=DvtArrayUtils.getIndex(b.categories,a.getCategory())){b=!0;break a}}else if(b instanceof DvtNBoxCategoryNode){b=b.getData();c=b.nodeIndices.length;for(e=0;e<c;e++)if(g=DvtNBoxDataUtils.getNode(this,b.nodeIndices[e]),g.categories&&-1!=DvtArrayUtils.getIndex(g.categories,a.getCategory())){b=!0;break a}}b=!1}b||h[d].setAlpha(DvtNBoxStyleUtils.getFadedNodeAlpha(this))}else if(a.getType()==
DvtCategoryRolloverEvent.TYPE_OUT)for(d=0;d<h.length;d++)h[d].setAlpha(1);return null};
DvtNBoxImpl.prototype._processSelectionEvent=function(a){var b=a.getSelection(),c=null;if(b){a={};for(c=0;c<b.length;c++)a[b[c]]=!0;var b=this.getObjects(),d=null;if((c=DvtNBoxDataUtils.getGroupBy(this))&&0<c.length)for(c=0;c<b.length;c++)if(b[c]instanceof DvtNBoxCategoryNode){if(a[b[c].getId()]){a[b[c].getId()]=!1;for(var e=b[c].getData().nodeIndices,g=0;g<e.length;g++){var h=DvtNBoxDataUtils.getNode(this,e[g]);a[h.id]=!0}}}else b[c]instanceof DvtNBoxDrawer&&(d=b[c]);var b=[],c=[],k;for(k in a)a[k]&&
(b.push(k),c.push({id:k}));a=new DvtSelectionEvent(b)}DvtNBoxDataUtils.setSelectedItems(this,c);d&&d.UpdateAccessibilityAttributes();return a};DvtNBoxImpl.prototype._distributeToChildren=function(a,b){this.legend&&this.legend!=b&&this.legend.processEvent(a,b);this.pieNBox&&this.pieNBox!=b&&this.pieNBox.processEvent(a,b)};DvtNBoxImpl.prototype.__cleanUp=function(){DvtNBoxImpl.superclass.__cleanUp.call(this);this._peers.length=0};
DvtNBoxImpl.prototype.__cleanUpAxisAndPlotArea=function(){DvtNBoxImpl.superclass.__cleanUp.call(this);this._peers.length=0;this._container.removeChild(this.xAxis);this._container.removeChild(this.yAxis);this._container.removeChild(this.y2Axis);this._container.removeChild(this._plotArea)};DvtNBoxImpl.prototype.registerObject=function(a){this._peers.push(a)};DvtNBoxImpl.prototype.getObjects=function(){return this._peers};
DvtNBoxImpl.prototype.getOptions=function(){this.Options||(this.Options=this.GetDefaults());return this.Options};DvtNBoxImpl.prototype.getWidth=function(){return this.Width};DvtNBoxImpl.prototype.getHeight=function(){return this.Height};DvtNBoxImpl.prototype.getBundle=function(){return this.Bundle};DvtNBoxImpl.prototype.getSelectionHandler=function(){return this._selectionHandler};DvtNBoxImpl.prototype.isSelectionSupported=function(){return this._selectionHandler?!0:!1};
DvtNBoxImpl.prototype.getShowPopupBehaviors=function(a){return this._popupBehaviors?this._popupBehaviors[a]:null};DvtNBoxImpl.prototype.animateUpdate=function(a,b){DvtNBoxRenderer.animateUpdate(a,b,this)};DvtNBoxImpl.prototype.getSanitizedOptions=function(){return DvtJSONUtils.clone(this.getOptions(),function(a){return 0!=a.indexOf("__")})};DvtNBoxImpl.prototype.getControlPanelStyleMap=function(){return{}};DvtNBoxImpl.prototype.__isDragAvailable=function(a){return this._selectionHandler?a[0]:null};
DvtNBoxImpl.prototype.__getDragTransferable=function(a){a.isSelected()||(this._selectionHandler.processClick(a,!1),this.EventManager.fireSelectionEvent());for(var a=[],b=this._selectionHandler.getSelection(),c=0;c<b.length;c++){var d=b[c];if(d instanceof DvtNBoxNode)a.push(d.getData().id);else if(d instanceof DvtNBoxCategoryNode)for(var d=d.getData().nodeIndices,e=0;e<d.length;e++)a.push(DvtNBoxDataUtils.getNode(this,d[e]).id)}return a};DvtNBoxImpl.prototype.__getDragFeedback=function(){return this._selectionHandler.getSelection().slice(0)};
DvtNBoxImpl.prototype.__getCellUnderPoint=function(a,b){for(var c=DvtNBoxDataUtils.getRowCount(this)*DvtNBoxDataUtils.getColumnCount(this),d=0;d<c;d++){var e=DvtNBoxDataUtils.getDisplayable(this,DvtNBoxDataUtils.getCell(this,d));if(e.contains(a,b))return e}return null};
DvtNBoxImpl.prototype.__showDropSiteFeedback=function(a){this._dropSiteFeedback&&(this._dropSiteFeedback.getParent().removeChild(this._dropSiteFeedback),this._dropSiteFeedback=null);a&&(this._dropSiteFeedback=a.renderDropSiteFeedback());return this._dropSiteFeedback};var DvtNBoxBundle=function(){};DvtObj.createSubclass(DvtNBoxBundle,DvtBundle,"DvtNBoxBundle");
DvtNBoxBundle._defaults={HIGHLIGHTED_COUNT:"{0}/{1}",COLON_SEP_LIST:"{0}: {1}",COMMA_SEP_LIST:"{0}, {1}",OTHER:"Other",LEGEND:"Legend",GROUP_NODE:"Group",STATE_SELECTED:"Selected",STATE_UNSELECTED:"Unselected",STATE_MAXIMIZED:"Maximized",STATE_MINIMIZED:"Minimized",STATE_EXPANDED:"Expanded",STATE_COLLAPSED:"Collapsed"};DvtNBoxBundle.prototype.GetDefaultStringForKey=function(a){return DvtNBoxBundle._defaults[a]};DvtNBoxBundle.prototype.GetBundlePrefix=function(){return"DvtNBoxBundle"};
var DvtNBoxDefaults=function(){this.Init({skyros:DvtNBoxDefaults.VERSION_1,alta:DvtNBoxDefaults.SKIN_ALTA})};DvtObj.createSubclass(DvtNBoxDefaults,DvtBaseComponentDefaults,"DvtNBoxDefaults");
DvtNBoxDefaults.VERSION_1={skin:DvtCSSStyle.SKIN_ALTA,emptyText:null,selection:"multiple",animationOnDataChange:"none",animationOnDisplay:"none",legendDisplay:"auto",legendDisclosure:"disclosed",groupBehavior:"withinCell",otherColor:"#636363",otherThreshold:0,columnsTitle:{style:new DvtCSSStyle('font-size: 14px; color: #252525; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif')},rowsTitle:{style:new DvtCSSStyle('font-size: 14px; color: #252525; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif')},
styleDefaults:{animationDuration:333,columnLabelStyle:new DvtCSSStyle('font-size: 12px; color: #252525; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif'),rowLabelStyle:new DvtCSSStyle('font-size: 12px; color: #252525; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif'),cell:{style:new DvtCSSStyle("background-color:#dddddd"),minimizedStyle:new DvtCSSStyle("background-color:#f0f0f0"),labelStyle:new DvtCSSStyle('font-size: 14px; color: #252525; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;font-weight:bold'),
countLabelStyle:new DvtCSSStyle('font-size: 14px; color: #252525; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif'),bodyCountLabelStyle:new DvtCSSStyle('color: #252525; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif'),dropTargetStyle:new DvtCSSStyle("background-color:rgba(217, 244, 250, .75);border-color:#ccf6ff"),showCount:"off",showMaximize:"on"},scrollbar:{scrollbarBackground:"linear-gradient(bottom, #dce2e7 0%, #f8f8f8 8%)",scrollbarBorderColor:"#dce2e7",scrollbarHandleColor:"#abb0b4",
scrollbarHandleHoverColor:"#333333",scrollbarHandleActiveColor:"#333333"},drawer:{background:"#dddddd",borderColor:"#c4ced7",borderRadius:1,headerBackground:"linear-gradient(to bottom, #f5f5f5 0%, #f0f0f0 100%)",labelStyle:new DvtCSSStyle('font-size: 14px; color: #252525; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;font-weight:bold'),countLabelStyle:new DvtCSSStyle('font-size: 14px; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif;font-weight:bold'),countBorderRadius:1},node:{color:"#FFFFFF",
labelStyle:new DvtCSSStyle('font-size: 12px; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif'),secondaryLabelStyle:new DvtCSSStyle('font-size: 11px; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif'),alphaFade:0.2,borderRadius:1,hoverColor:"#FFFFFF",selectionColor:"#000000",icon:{preferredSize:19,preferredSizeTouch:34,shapePaddingRatio:0.15,sourcePaddingRatio:0,scaleX:1,scaleY:1,gradientEffects:"none",opacity:1,fillPattern:"none",borderStyle:"none",borderWidth:1},indicator:{width:10,
height:10,scaleX:1,scaleY:1,gradientEffects:"none",opacity:1,fillPattern:"none",borderStyle:"none",borderWidth:1}},legend:{sectionStyle:'font-size: 12px; color: #252525; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif; font-weight:bold',itemStyle:'font-size: 12px; color: #252525; font-family:"Helvetica Neue", Helvetica, Arial, sans-serif',markerColor:"#808080"},categoryNode:{labelStyle:new DvtCSSStyle('font-family:"Helvetica Neue", Helvetica, Arial, sans-serif')}},__layout:{componentGap:8,
titleGap:4,titleComponentGap:4,nodeLabelOnlyStartLabelGap:5,nodeStartLabelGap:3,nodeEndLabelGap:5,nodeSingleLabelGap:2,nodeDualLabelGap:2,nodeInterLabelGap:0,nodeIndicatorGap:3,nodeSwatchSize:10,categoryNodeLabelGap:5,minimumCellSize:34,cellGap:3,gridGap:6,cellStartGap:6,cellEndGap:6,cellTopGap:6,cellBottomGap:6,cellLabelGap:6,countLabelGap:10,markerGap:3,minimumLabelWidth:55,maximumLabelWidth:148,drawerButtonGap:10,drawerCountHorizontalGap:5,drawerCountVerticalGap:3,drawerStartGap:10,drawerLabelGap:7,
drawerHeaderHeight:31}};DvtNBoxDefaults.SKIN_ALTA={};var DvtNBoxCell=function(){};DvtObj.createSubclass(DvtNBoxCell,DvtContainer,"DvtNBoxCell");DvtNBoxCell.newInstance=function(a,b){var c=new DvtNBoxCell;c.Init(a,b);return c};DvtNBoxCell.prototype.Init=function(a,b){var c=DvtNBoxDataUtils.getRowIndex(a,b.row),d=DvtNBoxDataUtils.getColumnIndex(a,b.column);DvtNBoxCell.superclass.Init.call(this,a.getCtx(),null,"c:"+c+","+d);this._nbox=a;this._data=b;this._scrollContainer=!1};
DvtNBoxCell.prototype.getData=function(){return this._data};DvtNBoxCell.prototype.render=function(a,b,c,d){a.addChild(this);DvtNBoxDataUtils.setDisplayable(this._nbox,this._data,this);DvtNBoxCellRenderer.render(this._nbox,this._data,this,b,c,d);this._nbox.EventManager.associate(this,this)};DvtNBoxCell.prototype.getChildContainer=function(){return this._childContainer};DvtNBoxCell.prototype.setChildContainer=function(a){this._childContainer=a};
DvtNBoxCell.prototype.animateUpdate=function(a,b){DvtNBoxCellRenderer.animateUpdate(a,b,this)};DvtNBoxCell.prototype.animateDelete=function(a){DvtNBoxCellRenderer.animateDelete(a,this)};DvtNBoxCell.prototype.animateInsert=function(a){DvtNBoxCellRenderer.animateInsert(a,this)};DvtNBoxCell.prototype.isDoubleClickable=function(){return!0};
DvtNBoxCell.prototype.handleDoubleClick=function(){var a=DvtNBoxDataUtils.getMaximizedRow(this._nbox),b=DvtNBoxDataUtils.getMaximizedColumn(this._nbox),c=this._nbox.getSanitizedOptions(),d=new DvtSetPropertyEvent,e=c[DvtNBoxConstants.DRAWER];c[DvtNBoxConstants.DRAWER]=null;d.addParam(DvtNBoxConstants.DRAWER,null);!e&&a==this._data.row&&b==this._data.column?(c[DvtNBoxConstants.MAXIMIZED_ROW]=null,d.addParam(DvtNBoxConstants.MAXIMIZED_ROW,null),c[DvtNBoxConstants.MAXIMIZED_COLUMN]=null,d.addParam(DvtNBoxConstants.MAXIMIZED_COLUMN,
null)):(c[DvtNBoxConstants.MAXIMIZED_ROW]=this._data.row,d.addParam(DvtNBoxConstants.MAXIMIZED_ROW,this._data.row),c[DvtNBoxConstants.MAXIMIZED_COLUMN]=this._data.column,d.addParam(DvtNBoxConstants.MAXIMIZED_COLUMN,this._data.column));this._nbox.processEvent(d);this._nbox.render(c)};
DvtNBoxCell.prototype.contains=function(a,b){var c=DvtNBoxDataUtils.getDisplayable(this._nbox,this._data,"background"),d=this.getTranslateX()+c.getX(),e=this.getTranslateY()+c.getY(),g=d+c.getWidth(),c=e+c.getHeight();return d<=a&&a<=g&&e<=b&&b<=c};DvtNBoxCell.prototype.renderDropSiteFeedback=function(){return DvtNBoxCellRenderer.renderDropSiteFeedback(this._nbox,this)};DvtNBoxCell.prototype.HandleKeyboardEvent=function(a){a.keyCode==DvtKeyboardEvent.ENTER&&(this.hideKeyboardFocusEffect(),this.handleDoubleClick())};
DvtNBoxCell.prototype.getAriaLabel=function(){var a=DvtNBoxDataUtils.getRowIndex(this._nbox,this.getData().row),b=DvtNBoxDataUtils.getColumnIndex(this._nbox,this.getData().column),a=a*DvtNBoxDataUtils.getColumnCount(this._nbox)+b;return(a=DvtNBoxDataUtils.isCellMaximized(this._nbox,a)?this._nbox.getBundle().getTranslatedString("STATE_MAXIMIZED"):DvtNBoxDataUtils.isCellMinimized(this._nbox,a)?this._nbox.getBundle().getTranslatedString("STATE_MINIMIZED"):null)?this._nbox.getBundle().getTranslatedString("COLON_SEP_LIST",
[this.getData().shortDesc,a]):this.getData().shortDesc};DvtNBoxCell.prototype.getKeyboardBoundingBox=function(){return DvtNBoxKeyboardHandler.getKeyboardBoundingBox(this)};DvtNBoxCell.prototype.showKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!0;DvtNBoxDataUtils.getDisplayable(this._nbox,this.getData(),"focusEffect").show()};
DvtNBoxCell.prototype.hideKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!1;DvtNBoxDataUtils.getDisplayable(this._nbox,this.getData(),"focusEffect").hide()};DvtNBoxCell.prototype.isShowingKeyboardFocusEffect=function(){return this._isShowingKeyboardFocusEffect};
DvtNBoxCell.prototype.getNextNavigable=function(a){var b=null;if(this._nbox.EventManager.getKeyboardHandler().isNavigationEvent(a)){var c=this._nbox.EventManager.GetPrevFocus();if(!DvtNBoxKeyboardHandler.isReverseDirection(this._nbox.EventManager.GetPrevDirection(),a.keyCode)&&(!c||c instanceof DvtNBoxCell))b=this._getFirstNavigableChild(a);if(!b||c instanceof DvtNBoxNode||c instanceof DvtNBoxCategoryNode)b=this._getNextSibling(a)}return b};
DvtNBoxCell.prototype._getNextSibling=function(a){for(var b=[],c=DvtNBoxDataUtils.getRowCount(this._nbox)*DvtNBoxDataUtils.getColumnCount(this._nbox),d=0;d<c;d++)b.push(DvtNBoxDataUtils.getDisplayable(this._nbox,DvtNBoxDataUtils.getCell(this._nbox,d)));return DvtKeyboardHandler.getNextNavigable(this,a,b)};
DvtNBoxCell.prototype._getFirstNavigableChild=function(a){var b=DvtNBoxDataUtils.getMaximizedRow(this._nbox),c=DvtNBoxDataUtils.getMaximizedColumn(this._nbox),d=DvtNBoxDataUtils.getDrawer(this._nbox);if(d&&b==this.getData().row&&c==this.getData().column)a=DvtNBoxDataUtils.getDisplayable(this._nbox,d);else{b=this.getChildContainer();c=[];for(d=0;d<b.getNumChildren();d++){var e=b.getChildAt(d);(e instanceof DvtNBoxNode||e instanceof DvtNBoxCategoryNode)&&c.push(e)}a=DvtNBoxKeyboardHandler.getFirstNavigableNode(a,
c)}return a};var DvtNBoxNode=function(){};DvtObj.createSubclass(DvtNBoxNode,DvtContainer,"DvtNBoxNode");DvtNBoxNode.newInstance=function(a,b){var c=new DvtNBoxNode;c.Init(a,b);return c};DvtNBoxNode.prototype.Init=function(a,b){DvtNBoxNode.superclass.Init.call(this,a.getCtx(),null,b.id);this._nbox=a;this._data=b;this._nbox.registerObject(this);var c=this._nbox.getOptions().selection;("single"==c||"multiple"==c)&&this.setCursor(DvtSelectionEffectUtils.getSelectingCursor());this._maxAlpha=1};
DvtNBoxNode.prototype.getData=function(){return this._data};DvtNBoxNode.prototype.render=function(a,b){DvtNBoxNodeRenderer.render(this._nbox,this._data,this,b);a.addChild(this);DvtNBoxDataUtils.setDisplayable(this._nbox,this._data,this);this._nbox.EventManager.associate(this,this)};DvtNBoxNode.prototype.isSelectable=function(){return!0};DvtNBoxNode.prototype.isSelected=function(){return this.getSelectionShape().isSelected()};
DvtNBoxNode.prototype.setSelected=function(a){this.getSelectionShape().setSelected(a);this.UpdateAccessibilityAttributes()};DvtNBoxNode.prototype.showHoverEffect=function(){this.getSelectionShape().showHoverEffect()};DvtNBoxNode.prototype.hideHoverEffect=function(){this.getSelectionShape().hideHoverEffect()};DvtNBoxNode.prototype.setSelectionShape=function(a){this._selectionShape=a};DvtNBoxNode.prototype.getSelectionShape=function(){return this._selectionShape};DvtNBoxNode.prototype.getDatatip=function(){return this._data.shortDesc};
DvtNBoxNode.prototype.getDatatipColor=function(){return DvtNBoxStyleUtils.getNodeColor(this._nbox,this._data)};DvtNBoxNode.prototype.setMaxAlpha=function(a){this._maxAlpha=a;this.setAlpha(this.getAlpha())};DvtNBoxNode.prototype.getMaxAlpha=function(){return this._maxAlpha};DvtNBoxNode.prototype.setAlpha=function(a){DvtNBoxNode.superclass.setAlpha.call(this,Math.min(a,this._maxAlpha))};DvtNBoxNode.prototype.animateUpdate=function(a,b){DvtNBoxNodeRenderer.animateUpdate(a,b,this)};
DvtNBoxNode.prototype.animateDelete=function(a){DvtNBoxNodeRenderer.animateDelete(a,this)};DvtNBoxNode.prototype.animateInsert=function(a){DvtNBoxNodeRenderer.animateInsert(a,this)};DvtNBoxNode.prototype.isDoubleClickable=function(){return!0};DvtNBoxNode.prototype.handleDoubleClick=function(){this._getParentContainer().handleDoubleClick()};
DvtNBoxNode.prototype.getShowPopupBehaviors=function(){if(!this._showPopupBehaviors){this._showPopupBehaviors=[];var a=this._data.showPopupBehaviors;if(a)for(var b=0;b<a.length;b++)this._showPopupBehaviors.push(new DvtShowPopupBehavior(a[b].popupId,a[b].triggerType,a[b].alignId,a[b].align))}return this._showPopupBehaviors};
DvtNBoxNode.prototype.getPopupBounds=function(a){if(a&&a.getAlign()){var a=DvtNBoxRenderer.getGlobalMatrix(this),b=DvtNBoxDataUtils.getDisplayable(this._nbox,this._data,"background");return new DvtRectangle(a.getTx()+b.getX(),a.getTy()+b.getY(),b.getWidth(),b.getHeight())}return null};DvtNBoxNode.prototype.isDragAvailable=function(a){return this._nbox.__isDragAvailable(a)};DvtNBoxNode.prototype.getDragTransferable=function(){return this._nbox.__getDragTransferable(this)};
DvtNBoxNode.prototype.getDragFeedback=function(){return this._nbox.__getDragFeedback()};DvtNBoxNode.prototype._getParentContainer=function(){var a;a=DvtNBoxDataUtils.getDrawer(this._nbox);a||(a=DvtNBoxDataUtils.getCellIndex(this._nbox,this._data),a=DvtNBoxDataUtils.getCell(this._nbox,a));return a=DvtNBoxDataUtils.getDisplayable(this._nbox,a)};
DvtNBoxNode.prototype.HandleKeyboardEvent=function(a){a.keyCode==DvtKeyboardEvent.ENTER&&((a=DvtNBoxDataUtils.getDrawer(this._nbox))&&this._nbox.EventManager.setFocus(DvtNBoxDataUtils.getDisplayable(this._nbox,a)),this.handleDoubleClick())};DvtNBoxNode.prototype.UpdateAccessibilityAttributes=function(){if(!DvtAgent.deferAriaCreation()){var a=this.getAriaLabel();a&&this.setAriaProperty("label",a)}};
DvtNBoxNode.prototype.getAriaLabel=function(){return DvtNBoxDataUtils.buildAriaDesc(this._nbox,this,this.getDatatip(),this.isSelected())};DvtNBoxNode.prototype.getKeyboardBoundingBox=function(){return DvtNBoxKeyboardHandler.getKeyboardBoundingBox(this)};DvtNBoxNode.prototype.showKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!0;this.showHoverEffect()};DvtNBoxNode.prototype.hideKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!1;this.hideHoverEffect()};
DvtNBoxNode.prototype.isShowingKeyboardFocusEffect=function(){return this._isShowingKeyboardFocusEffect};DvtNBoxNode.prototype.getNextNavigable=function(a){var b=null;if(a.keyCode==DvtKeyboardEvent.SPACE&&a.ctrlKey)return this;if(this._nbox.EventManager.getKeyboardHandler().isNavigationEvent(a)){for(var b=this.getParent(),c=[],d=0;d<b.getNumChildren();d++)b.getChildAt(d)instanceof DvtNBoxNode&&c.push(b.getChildAt(d));b=DvtNBoxKeyboardHandler.getNextNavigable(this,a,c);b===this&&(b=this._getParentContainer())}return b};
var DvtNBoxCategoryNode=function(){};DvtObj.createSubclass(DvtNBoxCategoryNode,DvtContainer,"DvtNBoxCategoryNode");DvtNBoxCategoryNode.newInstance=function(a,b){var c=new DvtNBoxCategoryNode;c.Init(a,b);return c};
DvtNBoxCategoryNode.prototype.Init=function(a,b){DvtNBoxCategoryNode.superclass.Init.call(this,a.getCtx(),null,isNaN(b.cell)?b.id:b.cell+":"+b.id);this._nbox=a;this._data=b;this._nbox.registerObject(this);"multiple"==this._nbox.getOptions().selection&&this.setCursor(DvtSelectionEffectUtils.getSelectingCursor());this._maxAlpha=1};DvtNBoxCategoryNode.prototype.getData=function(){return this._data};
DvtNBoxCategoryNode.prototype.render=function(a,b,c){DvtNBoxCategoryNodeRenderer.render(this._nbox,this._data,this,b,c);a.addChild(this);DvtNBoxDataUtils.setDisplayable(this._nbox,this._data,this);this._nbox.EventManager.associate(this,this)};DvtNBoxCategoryNode.prototype.isSelectable=function(){return"multiple"==this._nbox.getOptions().selection};DvtNBoxCategoryNode.prototype.isSelected=function(){return this.getSelectionShape().isSelected()};
DvtNBoxCategoryNode.prototype.setSelected=function(a){this.getSelectionShape().setSelected(a);this.UpdateAccessibilityAttributes()};DvtNBoxCategoryNode.prototype.showHoverEffect=function(){this.getSelectionShape().showHoverEffect()};DvtNBoxCategoryNode.prototype.hideHoverEffect=function(){this.getSelectionShape().hideHoverEffect()};DvtNBoxCategoryNode.prototype.setSelectionShape=function(a){this._selectionShape=a};DvtNBoxCategoryNode.prototype.getSelectionShape=function(){return this._selectionShape};
DvtNBoxCategoryNode.prototype.getDatatip=function(){return this._getCategoryLabels().join("\n")};DvtNBoxCategoryNode.prototype.getCategoryLabel=function(){for(var a=this._getCategoryLabels();1<a.length;){var b=[a[0],a[1]],b=this._nbox.getBundle().getTranslatedString("COMMA_SEP_LIST",b);a.splice(0,2,b)}return a[0]};
DvtNBoxCategoryNode.prototype._getCategoryLabels=function(){var a=[];if(this._data.otherNode)a.push(this._nbox.getBundle().getTranslatedString("OTHER"));else for(var b=DvtNBoxDataUtils.getGroupBy(this._nbox),c=0;c<b.length;c++){var d=DvtNBoxDataUtils.getCategoryLabel(this._nbox,this._data,b[c]);d&&a.push(d)}return a};DvtNBoxCategoryNode.prototype.getDatatipColor=function(){return DvtNBoxStyleUtils.getCategoryNodeColor(this._nbox,this._data)};
DvtNBoxCategoryNode.prototype.setMaxAlpha=function(a){this._maxAlpha=a;this.setAlpha(this.getAlpha())};DvtNBoxCategoryNode.prototype.getMaxAlpha=function(){return this._maxAlpha};DvtNBoxCategoryNode.prototype.setAlpha=function(a){DvtNBoxCategoryNode.superclass.setAlpha.call(this,Math.min(a,this._maxAlpha))};DvtNBoxCategoryNode.prototype.isDoubleClickable=function(){return!0};
DvtNBoxCategoryNode.prototype.handleDoubleClick=function(){var a=this._nbox.getSanitizedOptions();a[DvtNBoxConstants.DRAWER]={id:this.getId()};var b=new DvtSetPropertyEvent;b.addParam(DvtNBoxConstants.DRAWER,this.getId());this._nbox.processEvent(b);this._nbox.render(a)};DvtNBoxCategoryNode.prototype.animateUpdate=function(a,b){DvtNBoxCategoryNodeRenderer.animateUpdate(a,b,this)};DvtNBoxCategoryNode.prototype.animateDelete=function(a){DvtNBoxCategoryNodeRenderer.animateDelete(a,this)};
DvtNBoxCategoryNode.prototype.animateInsert=function(a){DvtNBoxCategoryNodeRenderer.animateInsert(a,this)};DvtNBoxCategoryNode.prototype.isDragAvailable=function(a){return this._nbox.__isDragAvailable(a)};DvtNBoxCategoryNode.prototype.getDragTransferable=function(){return this._nbox.__getDragTransferable(this)};DvtNBoxCategoryNode.prototype.getDragFeedback=function(){return this._nbox.__getDragFeedback()};
DvtNBoxCategoryNode.prototype.HandleKeyboardEvent=function(a){a.keyCode==DvtKeyboardEvent.ENTER&&this.handleDoubleClick()};DvtNBoxCategoryNode.prototype.UpdateAccessibilityAttributes=function(){if(!DvtAgent.deferAriaCreation()){var a=this.getAriaLabel();a&&this.setAriaProperty("label",a)}};DvtNBoxCategoryNode.prototype.getAriaLabel=function(){return DvtNBoxDataUtils.buildAriaDesc(this._nbox,this,this.getDatatip(),this.isSelected())};DvtNBoxCategoryNode.prototype.getKeyboardBoundingBox=function(){return DvtNBoxKeyboardHandler.getKeyboardBoundingBox(this)};
DvtNBoxCategoryNode.prototype.showKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!0;this.showHoverEffect()};DvtNBoxCategoryNode.prototype.hideKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!1;this.hideHoverEffect()};DvtNBoxCategoryNode.prototype.isShowingKeyboardFocusEffect=function(){return this._isShowingKeyboardFocusEffect};
DvtNBoxCategoryNode.prototype.getNextNavigable=function(a){var b=null;if(a.keyCode==DvtKeyboardEvent.SPACE&&a.ctrlKey)return this;if(this._nbox.EventManager.getKeyboardHandler().isNavigationEvent(a))if(DvtNBoxDataUtils.getGroupBehavior(this._nbox)==DvtNBoxConstants.GROUP_BEHAVIOR_ACROSS_CELLS){var b=this._nbox.getOptions().__groups,c=[],d;for(d in b){var e=DvtNBoxDataUtils.getDisplayable(this._nbox,b[d]);e&&c.push(e)}b=DvtNBoxKeyboardHandler.getNextNavigable(this,a,c)}else{d=this.getParent();b=[];
for(c=0;c<d.getNumChildren();c++)d.getChildAt(c)instanceof DvtNBoxCategoryNode&&b.push(d.getChildAt(c));b=DvtNBoxKeyboardHandler.getNextNavigable(this,a,b);b===this&&(a=DvtNBoxDataUtils.getCell(this._nbox,this._data.cell),b=DvtNBoxDataUtils.getDisplayable(this._nbox,a))}return b};var DvtNBoxDrawer=function(){};DvtObj.createSubclass(DvtNBoxDrawer,DvtContainer,"DvtNBoxDrawer");DvtNBoxDrawer.newInstance=function(a,b){var c=new DvtNBoxDrawer;c.Init(a,b);return c};
DvtNBoxDrawer.prototype.Init=function(a,b){DvtNBoxDrawer.superclass.Init.call(this,a.getCtx(),null,b.id+"_d");this._nbox=a;this._data=b;this._nbox.registerObject(this)};DvtNBoxDrawer.prototype.getData=function(){return this._data};DvtNBoxDrawer.prototype.render=function(a,b){a.addChild(this);DvtNBoxDataUtils.setDisplayable(this._nbox,this._data,this);DvtNBoxDrawerRenderer.render(this._nbox,this._data,this,b);this._nbox.EventManager.associate(this,this)};DvtNBoxDrawer.prototype.getChildContainer=function(){return this._childContainer};
DvtNBoxDrawer.prototype.setChildContainer=function(a){this._childContainer=a};DvtNBoxDrawer.prototype.isDoubleClickable=function(){return!0};DvtNBoxDrawer.prototype.handleDoubleClick=function(){this.closeDrawer()};DvtNBoxDrawer.prototype.closeDrawer=function(){var a=this._nbox.getSanitizedOptions();a[DvtNBoxConstants.DRAWER]=null;var b=new DvtSetPropertyEvent;b.addParam(DvtNBoxConstants.DRAWER,null);this._nbox.processEvent(b);this._nbox.render(a)};
DvtNBoxDrawer.prototype.animateUpdate=function(a,b){DvtNBoxDrawerRenderer.animateUpdate(a,b,this)};DvtNBoxDrawer.prototype.animateDelete=function(a){DvtNBoxDrawerRenderer.animateDelete(a,this)};DvtNBoxDrawer.prototype.animateInsert=function(a){DvtNBoxDrawerRenderer.animateInsert(a,this)};DvtNBoxDrawer.prototype.HandleKeyboardEvent=function(a){a.keyCode==DvtKeyboardEvent.ENTER&&(this.hideKeyboardFocusEffect(),this.closeDrawer())};
DvtNBoxDrawer.prototype.UpdateAccessibilityAttributes=function(){if(!DvtAgent.deferAriaCreation()){var a=this.getAriaLabel();a&&(DvtAgent.isTouchDevice()?DvtNBoxDataUtils.getDisplayable(this._nbox,this.getData(),"background"):this).setAriaProperty("label",a)}};
DvtNBoxDrawer.prototype.getAriaLabel=function(){var a=DvtNBoxDataUtils.getDisplayable(this._nbox,DvtNBoxDataUtils.getCategoryNode(this._nbox,this.getData().id)),b=DvtNBoxDataUtils.isDrawerSelected(this._nbox,a);return DvtNBoxDataUtils.buildAriaDesc(this._nbox,this,a.getDatatip(),b)};DvtNBoxDrawer.prototype.getKeyboardBoundingBox=function(){return DvtNBoxKeyboardHandler.getKeyboardBoundingBox(this)};
DvtNBoxDrawer.prototype.showKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!0;DvtNBoxDataUtils.getDisplayable(this._nbox,this.getData(),"focusEffect").show()};DvtNBoxDrawer.prototype.hideKeyboardFocusEffect=function(){this._isShowingKeyboardFocusEffect=!1;DvtNBoxDataUtils.getDisplayable(this._nbox,this.getData(),"focusEffect").hide()};DvtNBoxDrawer.prototype.isShowingKeyboardFocusEffect=function(){return this._isShowingKeyboardFocusEffect};
DvtNBoxDrawer.prototype.getNextNavigable=function(a){var b=null;if(this._nbox.EventManager.getKeyboardHandler().isNavigationEvent(a)){var b=DvtNBoxDataUtils.getMaximizedCellIndex(this._nbox),c=this._nbox.EventManager.GetPrevFocus(),d=DvtNBoxKeyboardHandler.isReverseDirection(this._nbox.EventManager.GetPrevDirection(),a.keyCode);if(!b||!d&&(!c||c instanceof DvtNBoxCell)){b=this.getChildContainer();c=[];for(d=0;d<b.getNumChildren();d++){var e=b.getChildAt(d);(e instanceof DvtNBoxNode||e instanceof DvtNBoxCategoryNode)&&
c.push(e)}b=DvtNBoxKeyboardHandler.getFirstNavigableNode(a,c)}else b=DvtNBoxDataUtils.getDisplayable(this._nbox,DvtNBoxDataUtils.getCell(this._nbox,b))}return b};var DvtNBoxDataAnimationHandler=function(a,b,c,d){this.Init(a,b,c,d)};DvtObj.createSubclass(DvtNBoxDataAnimationHandler,DvtDataAnimationHandler,"DvtNBoxDataAnimationHandler");DvtNBoxDataAnimationHandler.DELETE=0;DvtNBoxDataAnimationHandler.UPDATE=1;DvtNBoxDataAnimationHandler.INSERT=2;
DvtNBoxDataAnimationHandler.prototype.Init=function(a,b,c,d){DvtNBoxDataAnimationHandler.superclass.Init.call(this,a,b);this._oldNBox=c;this._newNBox=d};DvtNBoxDataAnimationHandler.prototype.getOldNBox=function(){return this._oldNBox};DvtNBoxDataAnimationHandler.prototype.getNewNBox=function(){return this._newNBox};DvtNBoxDataAnimationHandler.prototype.getAnimationDuration=function(){return DvtNBoxStyleUtils.getAnimationDuration(this._oldNBox)};var DvtNBoxDropTarget=function(a){this._view=a};
DvtObj.createSubclass(DvtNBoxDropTarget,DvtDropTarget,"DvtNBoxDropTarget");DvtNBoxDropTarget.prototype.acceptDrag=function(a,b,c){if(a=this._view.__getCellUnderPoint(a,b))a!=this._dropSite&&(this._view.__showDropSiteFeedback(a),this._dropSite=a);else return this._view.__showDropSiteFeedback(null),null;return c[0]};DvtNBoxDropTarget.prototype.dragExit=function(){this._view.__showDropSiteFeedback(null);this._dropSite=null};
DvtNBoxDropTarget.prototype.getDropSite=function(a,b){var c=this._view.__getCellUnderPoint(a,b);return c?(c=c.getData(),{row:c.row,column:c.column}):null};var DvtNBoxEventManager=function(a){this.Init(a.getCtx(),a.processEvent,a);this._nbox=a};DvtObj.createSubclass(DvtNBoxEventManager,DvtEventManager,"DvtNBoxEventManager");DvtNBoxEventManager.prototype.OnDblClick=function(a){DvtNBoxEventManager.superclass.OnDblClick.call(this,a);this._handleDblClick(this.GetCurrentTargetForEvent(a))};
DvtNBoxEventManager.prototype.OnComponentTouchDblClick=function(a){DvtNBoxEventManager.superclass.OnComponentTouchDblClick.call(this,a);this._handleDblClick(this.GetCurrentTargetForEvent(a))};DvtNBoxEventManager.prototype._handleDblClick=function(a){(a=this.GetLogicalObject(a))&&a.isDoubleClickable&&a.isDoubleClickable()&&a.handleDoubleClick&&a.handleDoubleClick()};
DvtNBoxEventManager.prototype.ProcessKeyboardEvent=function(a){var b=!1,c=a.keyCode,d=this.getFocus();if(c==DvtKeyboardEvent.ENTER)d&&d.HandleKeyboardEvent&&d.HandleKeyboardEvent(a),d=null;else if(a.keyCode==DvtKeyboardEvent.SPACE&&a.ctrlKey){if(d instanceof DvtNBoxCategoryNode||d instanceof DvtNBoxNode)b=DvtNBoxEventManager.superclass.ProcessKeyboardEvent.call(this,a)}else b=DvtNBoxEventManager.superclass.ProcessKeyboardEvent.call(this,a);this.SetPrevDirection(this.getKeyboardHandler().isNavigationEvent(a)?
c:null);this.SetPrevFocus(d);return b};DvtNBoxEventManager.prototype.SetPrevFocus=function(a){this._prevFocusedObj=a};DvtNBoxEventManager.prototype.GetPrevFocus=function(){return this._prevFocusedObj};DvtNBoxEventManager.prototype.SetPrevDirection=function(a){this._prevDirection=a};DvtNBoxEventManager.prototype.GetPrevDirection=function(){return this._prevDirection};var DvtNBoxKeyboardHandler=function(a,b){this.Init(a,b)};DvtObj.createSubclass(DvtNBoxKeyboardHandler,DvtKeyboardHandler,"DvtNBoxKeyboardHandler");
DvtNBoxKeyboardHandler.prototype.Init=function(a,b){DvtNBoxKeyboardHandler.superclass.Init.call(this,a);this._nbox=b};
DvtNBoxKeyboardHandler.prototype.processKeyDown=function(a){if(a.keyCode==DvtKeyboardEvent.TAB){var b=this._eventManager.getFocus(),c=null;a.preventDefault();if(b)c=b;else if(a=DvtNBoxDataUtils.getDrawer(this._nbox))c=DvtNBoxDataUtils.getDisplayable(this._nbox,a);else if(DvtNBoxDataUtils.getGroupBehavior(this._nbox)==DvtNBoxConstants.GROUP_BEHAVIOR_ACROSS_CELLS){var a=this._nbox.getOptions().__groups,b=[],d;for(d in a)(c=DvtNBoxDataUtils.getDisplayable(this._nbox,a[d]))&&b.push(c);c=this._nbox.EventManager.getKeyboardHandler().getDefaultNavigable(b)}else d=
DvtNBoxDataUtils.getColumnCount(this._nbox)*(DvtNBoxDataUtils.getRowCount(this._nbox)-1),c=DvtNBoxDataUtils.getDisplayable(this._nbox,DvtNBoxDataUtils.getCell(this._nbox,d));c&&this._eventManager.setFocus(c);return c}return DvtNBoxKeyboardHandler.superclass.processKeyDown.call(this,a)};DvtNBoxKeyboardHandler.prototype.isSelectionEvent=function(a){return a.keyCode==DvtKeyboardEvent.TAB?!1:this.isNavigationEvent(a)&&!a.ctrlKey};
DvtNBoxKeyboardHandler.prototype.isMultiSelectEvent=function(a){return a.keyCode==DvtKeyboardEvent.SPACE&&a.ctrlKey};
DvtNBoxKeyboardHandler.getFirstNavigableNode=function(a,b){if(!b||0>=b.length)return null;for(var c=a.keyCode,d=b[0],e=d.getKeyboardBoundingBox().getCenter(),g=1;g<b.length;g++){var h=b[g],k=h.getKeyboardBoundingBox().getCenter();if(c==DvtKeyboardEvent.RIGHT_ARROW&&k.x<=e.x&&k.y<=e.y||c==DvtKeyboardEvent.LEFT_ARROW&&k.x>=e.x&&k.y>=e.y||c==DvtKeyboardEvent.UP_ARROW&&k.x<=e.x&&k.y>=e.y||c==DvtKeyboardEvent.DOWN_ARROW&&k.x<=e.x&&k.y<=e.y)d=h,e=k}return d};
DvtNBoxKeyboardHandler.getNextNavigable=function(a,b,c){if(!c||0>=c.length)return null;for(var d,e=Number.MAX_VALUE,g=Number.MAX_VALUE,b=b.keyCode,h=b==DvtKeyboardEvent.RIGHT_ARROW||b==DvtKeyboardEvent.LEFT_ARROW?!0:!1,k=!h,m=a.getKeyboardBoundingBox().getCenter(),n=0;n<c.length;n++){var o=c[n];if(o!==a){var s=o.getKeyboardBoundingBox().getCenter(),t=h?Math.abs(s.x-m.x):Math.abs(s.y-m.y),u=k?Math.abs(s.x-m.x):Math.abs(s.y-m.y);if((b==DvtKeyboardEvent.RIGHT_ARROW&&s.x>m.x||b==DvtKeyboardEvent.LEFT_ARROW&&
s.x<m.x||b==DvtKeyboardEvent.DOWN_ARROW&&s.y>m.y||b==DvtKeyboardEvent.UP_ARROW&&s.y<m.y)&&(t<e||t===e&&u<g))d=o,e=t,g=u}}return d?d:a};DvtNBoxKeyboardHandler.getKeyboardBoundingBox=function(a){var b=a.getDimensions(),c=a.localToStage(new DvtPoint(b.x,b.y)),a=a.localToStage(new DvtPoint(b.x+b.w,b.y+b.h));return new DvtRectangle(c.x,c.y,a.x-c.x,a.y-c.y)};
DvtNBoxKeyboardHandler.isReverseDirection=function(a,b){return a===DvtKeyboardEvent.UP_ARROW&&b===DvtKeyboardEvent.DOWN_ARROW||b===DvtKeyboardEvent.UP_ARROW&&a===DvtKeyboardEvent.DOWN_ARROW||b===DvtKeyboardEvent.LEFT_ARROW&&a===DvtKeyboardEvent.RIGHT_ARROW||b===DvtKeyboardEvent.RIGHT_ARROW&&a===DvtKeyboardEvent.LEFT_ARROW};var DvtNBoxRenderer={};DvtObj.createSubclass(DvtNBoxRenderer,DvtObj,"DvtNBoxRenderer");
DvtNBoxRenderer.render=function(a,b,c){DvtNBoxRenderer._renderBackground(a,b,c);DvtNBoxRenderer._renderLegend(a,b,c);DvtNBoxRenderer._adjustAvailSpace(c);var d=DvtNBoxRenderer._calculateCellCounts(a),e=DvtNBoxCellRenderer.calculateCellLayout(a,d);DvtNBoxRenderer._renderTitles(a,b,e,c);DvtNBoxRenderer._adjustAvailSpace(c);DvtNBoxRenderer._renderCells(a,b,d,e,c);DvtNBoxRenderer._renderNodes(a,b,d,c);DvtNBoxRenderer._renderInitialSelection(a);DvtNBoxRenderer._fixZOrder(a)};
DvtNBoxRenderer._renderBackground=function(a,b,c){var d=a.getOptions(),a=new DvtRect(a.getCtx(),c.x,c.y,c.w,c.h);a.setInvisibleFill();b.addChild(a);a.setAriaRole("img");a.setAriaProperty("label",d.shortDesc)};
DvtNBoxRenderer._renderLegend=function(a,b,c){var d=DvtNBoxDataUtils.getLegend(a);if(d){var e=a.getOptions(),g=DvtAgent.isRightToLeft(a.getCtx()),h=new DvtPanelDrawer(a.getCtx(),a.processEvent,a);h.addEvtListener(DvtPanelDrawerEvent.TYPE,a.processEvent,!1,a);h.setDockSide(DvtPanelDrawer.DOCK_TOP);b.addChild(h);var k=DvtLegend.newInstance(a.getCtx(),a.processEvent,a);b.addChild(k);var m=k.getPreferredSize(d,c.w/3,c.h);k.render(d,m.w,m.h);b.removeChild(k);b=new DvtContainer(a.getCtx());m=new DvtRect(a.getCtx(),
0,0,m.w,m.h);m.setInvisibleFill();b.addChild(m);b.addChild(k);var n=e.resources.legend_ena,o=e.resources.legend_ovr,m=e.resources.legend_dwn,n=new DvtImage(a.getCtx(),n.src,0,0,n.width,n.height),o=new DvtImage(a.getCtx(),o.src,0,0,o.width,o.height),m=new DvtImage(a.getCtx(),m.src,0,0,m.width,m.height);h.addPanel(b,n,o,m,a.getBundle().getTranslatedString("LEGEND"),"legend");h.renderComponent();"disclosed"==e[DvtNBoxConstants.LEGEND_DISCLOSURE]&&(h.setDisplayedPanelId("legend"),h.setDisclosed(!0,!0));
e=h.getDimensions();h.setTranslate(g?0:c.w,0);g&&(h.setDiscloseDirection(DvtPanelDrawer.DIR_RIGHT),c.x+=e.w);c.w-=e.w;DvtNBoxDataUtils.setDisplayable(a,d,k,"legend");DvtNBoxDataUtils.setDisplayable(a,d,h,"panelDrawer")}};
DvtNBoxRenderer._renderTitles=function(a,b,c,d){var e=a.getOptions(),g=DvtNBoxDataUtils.getColumnCount(a),h=DvtNBoxDataUtils.getRowCount(a),k=e.__layout.componentGap,m=e.__layout.titleGap,n=e.__layout.titleComponentGap,o=DvtAgent.isRightToLeft(a.getCtx());d.x+=o?0:k;d.y+=k;d.w-=2*k;d.h-=2*k;var s=DvtNBoxDataUtils.getMaximizedColumn(a),k=s?DvtNBoxDataUtils.getColumnIndex(a,s):-1,t=DvtNBoxDataUtils.getMaximizedRow(a),u=t?DvtNBoxDataUtils.getRowIndex(a,t):-1,v=null,w=null,z=[],A=[],C=0,D=0,B=0,E=0,G=
0,F=0,K=0,J=0;e.columnsTitle&&e.columnsTitle.text&&(v=DvtNBoxRenderer.createText(a.getCtx(),e.columnsTitle.text,e.columnsTitle.style,DvtOutputText.H_ALIGN_CENTER,DvtOutputText.V_ALIGN_MIDDLE),b.addChild(v),C=DvtTextUtils.guessTextDimensions(v).h);e.rowsTitle&&e.rowsTitle.text&&(w=DvtNBoxRenderer.createText(a.getCtx(),e.rowsTitle.text,e.rowsTitle.style,DvtOutputText.H_ALIGN_CENTER,DvtOutputText.V_ALIGN_MIDDLE),b.addChild(w),D=DvtTextUtils.guessTextDimensions(w).h);for(var I=0;I<g;I++){var H=DvtNBoxDataUtils.getColumn(a,
I);if(H.label&&H.label.text){var M=DvtNBoxRenderer.createText(a.getCtx(),H.label.text,DvtNBoxStyleUtils.getColumnLabelStyle(a,I),DvtOutputText.H_ALIGN_CENTER,DvtOutputText.V_ALIGN_MIDDLE),G=Math.max(G,DvtTextUtils.guessTextDimensions(M).h);if(!s||s==H.value)z[I]=M,b.addChild(z[I])}}for(I=0;I<h;I++)if(s=DvtNBoxDataUtils.getRow(a,I),s.label&&s.label.text&&(H=DvtNBoxRenderer.createText(a.getCtx(),s.label.text,DvtNBoxStyleUtils.getRowLabelStyle(a,I),DvtOutputText.H_ALIGN_CENTER,DvtOutputText.V_ALIGN_MIDDLE),
F=Math.max(F,DvtTextUtils.guessTextDimensions(H).h),!t||t==s.value))A[I]=H,b.addChild(A[I]);if(D||F)K=n,D&&F&&(B=m);if(C||G)J=n,C&&G&&(E=m);m=D+B+F+K;n=C+E+G+J;d.x+=o?0:m;d.w-=m;d.h-=n;v&&DvtTextUtils.fitText(v,d.w,C,b)&&(DvtNBoxRenderer.positionText(v,d.x+d.w/2,d.y+d.h+n-C/2),DvtNBoxDataUtils.setDisplayable(a,e.columnsTitle,v));w&&DvtTextUtils.fitText(w,d.h,D,b)&&(DvtNBoxRenderer.positionText(w,d.x+(o?d.w:0)+(o?1:-1)*(m-D/2),d.y+d.h/2,o?Math.PI/2:-Math.PI/2),DvtNBoxDataUtils.setDisplayable(a,e.rowsTitle,
w));for(I=0;I<g;I++)z[I]&&(e=DvtNBoxCellRenderer.getCellDimensions(a,-1==u?0:u,I,c,d),DvtTextUtils.fitText(z[I],e.w,G,b)&&(DvtNBoxRenderer.positionText(z[I],e.x+e.w/2,d.y+d.h+J+G/2),DvtNBoxDataUtils.setDisplayable(a,DvtNBoxDataUtils.getColumn(a,I).label,z[I])));for(I=0;I<h;I++)A[I]&&(e=DvtNBoxCellRenderer.getCellDimensions(a,I,-1==k?0:k,c,d),DvtTextUtils.fitText(A[I],e.h,F,b)&&(DvtNBoxRenderer.positionText(A[I],d.x+(o?d.w:0)+(o?1:-1)*(K+F/2),e.y+e.h/2,o?Math.PI/2:-Math.PI/2),DvtNBoxDataUtils.setDisplayable(a,
DvtNBoxDataUtils.getRow(a,I).label,A[I])))};DvtNBoxRenderer.createText=function(a,b,c,d,e){a=new DvtOutputText(a,b,0,0);a.setCSSStyle(c);a.setHorizAlignment(d);a.setVertAlignment(e);return a};DvtNBoxRenderer._renderCells=function(a,b,c,d,e){for(var g=DvtNBoxDataUtils.getRowCount(a),h=DvtNBoxDataUtils.getColumnCount(a),k=0;k<g;k++)for(var m=0;m<h;m++){var n=DvtNBoxDataUtils.getCell(a,k*h+m);DvtNBoxCell.newInstance(a,n).render(b,d,c,e)}};
DvtNBoxRenderer._calculateCellCounts=function(a){var b=DvtNBoxDataUtils.getRowCount(a),c=DvtNBoxDataUtils.getColumnCount(a),d=b*c,b=[],c=null,e=DvtNBoxDataUtils.getHighlightedItems(a),g={};if(e)for(var c=[],h=0;h<e.length;h++)g[e[h].id]=!0;for(h=0;h<d;h++)b[h]=0,c&&(c[h]=0);d=DvtNBoxDataUtils.getNodeCount(a);for(h=0;h<d;h++){var e=DvtNBoxDataUtils.getNode(a,h),k=DvtNBoxDataUtils.getCellIndex(a,e);b[k]++;c&&g[e.id]&&c[k]++}a={};a.total=b;c&&(a.highlighted=c);return a};
DvtNBoxRenderer._renderNodes=function(a,b,c,d){if(0<DvtNBoxDataUtils.getNodeCount(a)){var e=DvtNBoxDataUtils.getGroupBy(a);e&&0<e.length?(DvtNBoxRenderer._renderCategoryNodes(a,b,d),DvtNBoxRenderer._renderDrawer(a,b,d)):DvtNBoxRenderer._renderIndividualNodes(a,b,c,d)}};
DvtNBoxRenderer._renderIndividualNodes=function(a,b,c){var d=a.getOptions(),b=d.__layout.gridGap,e=DvtAgent.isRightToLeft(a.getCtx()),g=DvtNBoxNodeRenderer.calculateNodeLayout(a),h=g.indicatorSectionWidth+g.iconSectionWidth+g.labelSectionWidth+b,k=g.nodeHeight+b,m=DvtNBoxDataUtils.getNodeCount(a),n=[],o=["normal"],s=DvtNBoxStyleUtils.getFadedNodeAlpha(a),t=DvtNBoxDataUtils.getHighlightedItems(a),u={};if(t){for(var v=0;v<t.length;v++)u[t[v].id]=!0;o=["highlighted","unhighlighted"]}for(var w=0;w<o.length;w++)for(var z=
0;z<m;z++){var A=DvtNBoxDataUtils.getNode(a,z);if(!DvtNBoxDataUtils.isNodeHidden(a,A)&&("normal"==o[w]||"highlighted"==o[w]&&u[A.id]||"unhighlighted"==o[w]&&!u[A.id])){var C=DvtNBoxDataUtils.getCellIndex(a,A);if(!DvtNBoxDataUtils.isCellMinimized(a,C)){t=DvtNBoxDataUtils.getCell(a,C);isNaN(n[C])&&(n[C]=0);var v=g.cellLayouts[C],D=v.cellRows,B=v.cellColumns;if(!(0==D||0==B||1==D&&1==B&&v.overflow))if(D=D*B-(v.overflow?1:0),0>D||n[C]<D){var E=DvtNBoxNode.newInstance(a,A),D=t.__childArea.x+(t.__childArea.w-
v.cellColumns*h+b)/2,A=t.__childArea.y,G=n[C]%B;e&&(G=B-G-1);v=Math.floor(n[C]/B);E.setTranslate(D+h*G,A+k*v);n[C]++;E.render(DvtNBoxDataUtils.getDisplayable(a,t).getChildContainer(),g);"unhighlighted"==o[w]&&E.setMaxAlpha(s)}}}}m=DvtNBoxDataUtils.getRowCount(a);s=DvtNBoxDataUtils.getColumnCount(a);d=d.resources.overflow;u=[];for(o=0;o<m;o++)for(w=0;w<s;w++)z=o*s+w,DvtNBoxDataUtils.isCellMinimized(a,z)||(A=DvtNBoxDataUtils.getCell(a,z),t=DvtNBoxDataUtils.getDisplayable(a,A),v=g.cellLayouts[z],v.overflow&&
(D=v.cellRows,B=v.cellColumns,0==D||0==B||1==D&&1==B&&v.overflow?u.push(z):(D=A.__childArea.x+(A.__childArea.w-v.cellColumns*h+b)/2,A=A.__childArea.y,G=n[z]%v.cellColumns,e&&(G=v.cellColumns-G-1),v=Math.floor(n[z]/v.cellColumns),B=new DvtImage(a.getCtx(),d.src,-d.width/2,-d.height/2,d.width,d.height),B.setTranslate(D+h*G+(h-b)/2,A+k*v+(k-b)/2),t.getChildContainer().addChild(B))));0<u.length&&DvtNBoxCellRenderer.renderBodyCountLabels(a,c,u)};
DvtNBoxRenderer._renderCategoryNodes=function(a,b,c){var d={},e=DvtNBoxDataUtils.getNodeCount(a),g=DvtNBoxDataUtils.getGroupBehavior(a),h=DvtAgent.isRightToLeft(a.getCtx()),k=DvtNBoxDataUtils.getHighlightedItems(a),m={};if(k)for(var n=0;n<k.length;n++)m[k[n].id]=!0;for(n=0;n<e;n++)if(k=DvtNBoxDataUtils.getNode(a,n),!DvtNBoxDataUtils.isNodeHidden(a,k)){var o=d;if(g==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL){var s=DvtNBoxDataUtils.getCellIndex(a,k)+"",o=d[s];o||(o={},d[s]=o)}var s=DvtNBoxDataUtils.getNodeGroupId(a,
k),t=o[s];t||(t={},t.id=s,t.categories=s.split(";"),g==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL&&(t.cell=DvtNBoxDataUtils.getCellIndex(a,k)),t.nodeIndices=[],t.highlightedCount=0,o[s]=t);t.nodeIndices.push(n);m[DvtNBoxDataUtils.getNode(a,n).id]&&t.highlightedCount++}if(g==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL){var n={},u;for(u in d)n[u]=DvtNBoxRenderer._processOtherThreshold(a,d[u])}else n=DvtNBoxRenderer._processOtherThreshold(a,d);d=n;a.getOptions().__groups=d;if(g==DvtNBoxConstants.GROUP_BEHAVIOR_ACROSS_CELLS){u=
[];for(t in d)u.push(t);u.sort(function(a,b){return d[a].nodeIndices.length<d[b].nodeIndices.length});g=Math.sqrt(0.15*c.w*c.h/e);for(n=0;n<u.length;n++){t=u[n];o=m=0;e=d[t].nodeIndices.length;for(s=0;s<e;s++)k=DvtNBoxDataUtils.getNode(a,d[t].nodeIndices[s]),m+=DvtNBoxDataUtils.getXPercentage(a,k),o+=DvtNBoxDataUtils.getYPercentage(a,k);m/=e;o/=e;e=DvtNBoxCategoryNode.newInstance(a,d[t]);e.setTranslate(c.x+(h?1-m:m)*c.w,c.y+(1-o)*c.h);e.render(b,g,0);e.setMaxAlpha(0.8)}}else if(g==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL){n=
DvtNBoxDataUtils.getRowCount(a);b=DvtNBoxDataUtils.getColumnCount(a);b*=n;c=[];for(n=0;n<b;n++)d[n]&&!DvtNBoxDataUtils.isCellMinimized(a,n)&&(h=DvtNBoxDataUtils.getCell(a,n),c[n]=DvtNBoxRenderer._forceLayoutGroups(d[n],h.__childArea.w,h.__childArea.h));g=40;for(n=0;n<b;n++)d[n]&&!DvtNBoxDataUtils.isCellMinimized(a,n)&&(g=Math.min(g,c[n].scale));for(n=0;n<b;n++)if(d[n]&&!DvtNBoxDataUtils.isCellMinimized(a,n))for(t in k=c[n].positions,u=c[n].center,h=DvtNBoxDataUtils.getCell(a,n),m=DvtNBoxDataUtils.getDisplayable(a,
h).getChildContainer(),k)e=DvtNBoxCategoryNode.newInstance(a,d[n][t]),e.setTranslate(h.__childArea.x+h.__childArea.w/2+g*(k[t].x-u.x),h.__childArea.y+h.__childArea.h/2+g*(k[t].y-u.y)),e.render(m,g,3)}};DvtNBoxRenderer.getRowDimensions=function(a,b,c){var a=DvtNBoxDataUtils.getRowCount(a),d=c.h/a;return new DvtRectangle(c.x,c.y+(a-b-1)*d,c.w,d)};
DvtNBoxRenderer.getColumnDimensions=function(a,b,c){var d=DvtNBoxDataUtils.getColumnCount(a),d=c.w/d,a=DvtAgent.isRightToLeft(a.getCtx());return new DvtRectangle(c.x+(a?c.w-d:0)+(a?-1:1)*b*d,c.y,d,c.h)};DvtNBoxRenderer._adjustAvailSpace=function(a){a.x=Math.round(a.x);a.y=Math.round(a.y);a.w=Math.round(a.w);a.h=Math.round(a.h)};DvtNBoxRenderer.positionText=function(a,b,c,d){a.setX(b);a.setY(c);if(d){var e=a.getMatrix();e.translate(-b,-c);e.rotate(d);e.translate(b,c);a.setMatrix(e)}};
DvtNBoxRenderer._renderInitialSelection=function(a){if(a.isSelectionSupported()){var b={},c=[],d=DvtNBoxDataUtils.getSelectedItems(a);if(d){for(var e=0;e<d.length;e++)c.push(d[e].id),b[d[e].id]=!0;var g=a.getObjects();if((e=DvtNBoxDataUtils.getGroupBy(a))&&0<e.length)for(e=0;e<g.length;e++)if(g[e]instanceof DvtNBoxCategoryNode){for(var d=g[e].getData().nodeIndices,h=!0,k=0;k<d.length;k++){var m=DvtNBoxDataUtils.getNode(a,d[k]);if(!b[m.id]){h=!1;break}}h&&c.push(g[e].getId())}}a.getSelectionHandler().processInitialSelections(c,
g)}};
DvtNBoxRenderer._forceLayoutGroups=function(a,b,c){var d=[],e;for(e in a)d.push(e);d.sort(function(b,c){return a[b].nodeIndices.length<a[c].nodeIndices.length});for(var g={},h=2*Math.PI/d.length,k=0;k<d.length;k++){var m=k*Math.cos(h*k),n=k*Math.sin(h*k);g[d[k]]=DvtVectorUtils.createVector(m,n)}h=1;m=-0.25*c/Math.max(b,c);for(n=-0.25*b/Math.max(b,c);0.0050<h;){for(var o={},k=0;k<d.length;k++){var s=d[k];e=g[s];var t=a[s].nodeIndices.length;o[s]=DvtVectorUtils.createVector(h*m*e.x,h*n*e.y);for(var u=0;u<
d.length;u++)if(k!=u){for(var v=d[u],w=a[v].nodeIndices.length,v=DvtVectorUtils.subtractVectors(e,g[v]),z=DvtVectorUtils.getMagnitude(v),A=Math.atan2(v.y,v.x);0>A;)A+=Math.PI/2;for(;A>=Math.PI/2;)A-=Math.PI/2;A=A<Math.PI/4?0.5*(Math.sqrt(t)+Math.sqrt(w))/Math.cos(A):0.5*(Math.sqrt(t)+Math.sqrt(w))/Math.sin(A);z<A&&(o[s]=DvtVectorUtils.addVectors(o[s],DvtVectorUtils.scaleVector(v,(1-h)*w/(t+w)*((A-z)/z))))}}for(k=0;k<d.length;k++)s=d[k],g[s]=DvtVectorUtils.addVectors(g[s],o[s]);h*=0.98}h=Number.MAX_VALUE;
m=-Number.MAX_VALUE;n=Number.MAX_VALUE;o=-Number.MAX_VALUE;for(k=0;k<d.length;k++)e=d[k],s=Math.sqrt(a[e].nodeIndices.length),e=g[e],h=Math.min(h,e.x-s/2),m=Math.max(m,e.x+s/2),n=Math.min(n,e.y-s/2),o=Math.max(o,e.y+s/2);return{scale:Math.min(b/(m-h),c/(o-n)),center:new DvtPoint((h+m)/2,(n+o)/2),positions:g}};
DvtNBoxRenderer._processOtherThreshold=function(a,b){var c=DvtNBoxDataUtils.getNodeCount(a),c=DvtNBoxDataUtils.getOtherThreshold(a)*c;if(1>=c)return b;var d={},e={};if(DvtNBoxDataUtils.getGroupBehavior(a)==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL)for(var g in b){var h=b[g];e.cell=h.cell;break}e.id="other";e.categories=[];e.nodeIndices=[];e.otherNode=!0;for(g in b)if(h=b[g],h.nodeIndices.length<c)for(var k=0;k<h.nodeIndices.length;k++)e.nodeIndices.push(h.nodeIndices[k]);else d[g]=h;0<e.nodeIndices.length&&
(d.other=e);return d};DvtNBoxRenderer._renderDrawer=function(a,b,c){var d=DvtNBoxDataUtils.getDrawer(a);d&&(DvtNBoxDataUtils.getCategoryNode(a,d.id)?DvtNBoxDrawer.newInstance(a,d).render(b,c):(a.getOptions()[DvtNBoxConstants.DRAWER]=null,b=new DvtSetPropertyEvent,b.addParam(DvtNBoxConstants.DRAWER,null),a.processEvent(b)))};DvtNBoxRenderer.getGlobalMatrix=function(a){for(var b=a.getMatrix().clone(),a=a.getParent();a;){var c=a.getMatrix();b.translate(c.getTx(),c.getTy());a=a.getParent()}return b};
DvtNBoxRenderer.animateUpdate=function(a,b,c){DvtNBoxRenderer._animateCells(a,b,c);var d=DvtNBoxDataUtils.getDrawer(b),d=d?d.id:null,e=DvtNBoxDataUtils.getDrawer(c),e=e?e.id:null;d==e?DvtNBoxRenderer._animateNodes(a,b,c):DvtNBoxRenderer._animateDrawer(a,b,c)};
DvtNBoxRenderer._animateCells=function(a,b,c){for(var d=DvtNBoxDataUtils.getRowCount(b),e=DvtNBoxDataUtils.getRowCount(c),g=DvtNBoxDataUtils.getColumnCount(b),h=DvtNBoxDataUtils.getColumnCount(c),k=d*g,m=e*h,n=[],o=[],s=0;s<k;s++)n.push(DvtNBoxDataUtils.getDisplayable(b,DvtNBoxDataUtils.getCell(b,s)));for(s=0;s<m;s++)o.push(DvtNBoxDataUtils.getDisplayable(c,DvtNBoxDataUtils.getCell(c,s)));if(d==e&&g==h){d=!0;for(s=0;s<e;s++)if(g=DvtNBoxDataUtils.getRow(b,s).value,k=DvtNBoxDataUtils.getRow(c,s).value,
g!=k){d=!1;break}if(d)for(s=0;s<h;s++)if(e=DvtNBoxDataUtils.getColumn(b,s).value,g=DvtNBoxDataUtils.getColumn(c,s).value,e!=g){d=!1;break}if(d){a.constructAnimation(n,o);return}}a.constructAnimation(n,[]);a.constructAnimation([],o)};
DvtNBoxRenderer._animateNodes=function(a,b,c){for(var d=DvtNBoxDataUtils.getNodeCount(b),e=DvtNBoxDataUtils.getNodeCount(c),g=[],h=[],k=0;k<d;k++)g.push(DvtNBoxDataUtils.getDisplayable(b,DvtNBoxDataUtils.getNode(b,k)));for(k=0;k<e;k++)h.push(DvtNBoxDataUtils.getDisplayable(c,DvtNBoxDataUtils.getNode(c,k)));a.constructAnimation(g,h);DvtNBoxDataUtils.getDrawer(c)||(b=DvtNBoxRenderer._getSortedGroups(b),c=DvtNBoxRenderer._getSortedGroups(c),a.constructAnimation(b,c))};
DvtNBoxRenderer._getSortedGroups=function(a){var b=DvtNBoxDataUtils.getGroupBehavior(a),c=a.getOptions().__groups,d=[];if(c)if(b==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL)for(var b=DvtNBoxDataUtils.getRowCount(a),e=DvtNBoxDataUtils.getColumnCount(a),b=b*e,e=0;e<b;e++)for(var g=DvtNBoxRenderer._getSortedGroupsFromContainer(a,c[e+""]),h=0;h<g.length;h++)d.push(g[h]);else d=DvtNBoxRenderer._getSortedGroupsFromContainer(a,c);return d};
DvtNBoxRenderer._getSortedGroupsFromContainer=function(a,b){var c=[],d;for(d in b){var e=DvtNBoxDataUtils.getDisplayable(a,b[d]);e&&c.push(e)}c.sort(function(a,b){var c=a.getId(),d=b.getId();return c==d?0:c<d?-1:1});return c};DvtNBoxRenderer._animateDrawer=function(a,b,c){var d=DvtNBoxDataUtils.getDrawer(b),d=d?[DvtNBoxDataUtils.getDisplayable(b,d)]:null,b=(b=DvtNBoxDataUtils.getDrawer(c))?[DvtNBoxDataUtils.getDisplayable(c,b)]:[];a.constructAnimation(d,b)};
DvtNBoxRenderer.setFill=function(a,b){if(0==b.indexOf("linear-gradient")){var c=DvtGradientParser.parseCSSGradient(b);c&&a.setFill(new DvtLinearGradientFill(c.getAngle(),c.getColors(),c.getAlphas(),c.getRatios()))}else a.setSolidFill(b)};DvtNBoxRenderer._fixZOrder=function(a){var b=DvtNBoxDataUtils.getLegend(a);b&&(a=DvtNBoxDataUtils.getDisplayable(a,b,"panelDrawer"))&&a.getParent().addChild(a)};var DvtNBoxCellRenderer={};DvtObj.createSubclass(DvtNBoxCellRenderer,DvtObj,"DvtNBoxCellRenderer");
DvtNBoxCellRenderer.render=function(a,b,c,d,e,g){var h=a.getOptions(),k=h.__layout.cellGap,m=h.__layout.cellStartGap,n=h.__layout.cellEndGap,o=h.__layout.cellTopGap,h=h.__layout.cellBottomGap,s=DvtNBoxDataUtils.getRowIndex(a,b.row),t=DvtNBoxDataUtils.getColumnIndex(a,b.column),g=DvtNBoxCellRenderer.getCellDimensions(a,s,t,d,g);c.setTranslate(g.x+k/2,g.y+k/2);s=s*DvtNBoxDataUtils.getColumnCount(a)+t;k=new DvtRect(a.getCtx(),0,0,g.w-k,g.h-k);k.setPixelHinting(!0);g=DvtNBoxStyleUtils.getCellStyle(a,
s);DvtNBoxCellRenderer._applyStyleToRect(k,g);c.addChild(k);DvtNBoxDataUtils.setDisplayable(a,b,k,"background");g=new DvtKeyboardFocusEffect(a.getCtx(),c,new DvtRectangle(-1,-1,k.getWidth()+2,k.getHeight()+2));DvtNBoxDataUtils.setDisplayable(a,b,g,"focusEffect");g=null;g=DvtNBoxCellRenderer.renderHeader(a,b,c,e,!1)?DvtNBoxCellRenderer._isLabelVertical(a,b)?new DvtRectangle(d.headerSize,o,k.getWidth()-d.headerSize-n,k.getHeight()-o-h):new DvtRectangle(m,d.headerSize,k.getWidth()-m-n,k.getHeight()-
d.headerSize-h):new DvtRectangle(m,o,k.getWidth()-m-n,k.getHeight()-o-h);a=new DvtContainer(a.getCtx());c.addChild(a);c.setChildContainer(a);b.__childArea=g};
DvtNBoxCellRenderer.renderHeader=function(a,b,c,d,e){var g=DvtNBoxDataUtils.getDisplayable(a,b,"label");g&&(g.getParent().removeChild(g),DvtNBoxDataUtils.setDisplayable(a,b,null,"label"));if(g=DvtNBoxDataUtils.getDisplayable(a,b,"countLabel"))g.getParent().removeChild(g),DvtNBoxDataUtils.setDisplayable(a,b,null,"countLabel");g=!1;if(b.label){var h=a.getOptions(),k=h.__layout.countLabelGap,m=h.__layout.cellStartGap,n=h.__layout.cellEndGap,o=h.__layout.cellTopGap,s=h.__layout.__cellLayout,h=DvtNBoxDataUtils.getRowIndex(a,
b.row),t=DvtNBoxDataUtils.getColumnIndex(a,b.column),u=h*DvtNBoxDataUtils.getColumnCount(a)+t,t=DvtNBoxDataUtils.getDisplayable(a,b,"background"),h=DvtAgent.isRightToLeft(a.getCtx()),s=s.labelHeight,v=!1,w=DvtNBoxStyleUtils.getHalign(a,b.label),z=0,A=0,C=null,D=z=0,B=null;!e&&"on"==b.showCount&&(B=""+d.total[u],d.highlighted&&(B=a.getBundle().getTranslatedString("HIGHLIGHTED_COUNT",[d.highlighted[u],B])));DvtNBoxCellRenderer._isLabelVertical(a,b)?(B&&(C=DvtNBoxRenderer.createText(a.getCtx(),B,DvtNBoxStyleUtils.getCellCountLabelStyle(a),
DvtOutputText.H_ALIGN_CENTER,DvtOutputText.V_ALIGN_MIDDLE),DvtTextUtils.fitText(C,t.getHeight()-m-n,s,c)?(DvtNBoxDataUtils.setDisplayable(a,b,C,"countLabel"),g=!0,z=C.getDimensions().w,A=z+k,D=t.getHeight()/2,z=o+s/2):v=!0),d=0,v||(e=DvtNBoxRenderer.createText(a.getCtx(),b.label.text,DvtNBoxStyleUtils.getCellLabelStyle(a,u),DvtOutputText.H_ALIGN_CENTER,DvtOutputText.V_ALIGN_MIDDLE),DvtTextUtils.fitText(e,t.getHeight()-m-n-A,s,c)&&(DvtNBoxDataUtils.setDisplayable(a,b,e,"label"),d=e.getDimensions().w,
g=!0,DvtNBoxRenderer.positionText(e,o+s/2,(t.getHeight()+A)/2,h?Math.PI/2:-Math.PI/2),d=(d+k)/2)),C&&DvtNBoxRenderer.positionText(C,z,D-d,h?Math.PI/2:-Math.PI/2)):(B&&(C=DvtNBoxRenderer.createText(a.getCtx(),B,DvtNBoxStyleUtils.getCellCountLabelStyle(a),w,DvtOutputText.V_ALIGN_MIDDLE),DvtTextUtils.fitText(C,t.getWidth()-m-n,s,c)?(DvtNBoxDataUtils.setDisplayable(a,b,C,"countLabel"),g=!0,z=C.getDimensions().w,A=z+k,z=w==DvtOutputText.H_ALIGN_CENTER?t.getWidth()/2:w==DvtOutputText.H_ALIGN_RIGHT?t.getWidth()-
n:m,D=o+s/2,DvtNBoxRenderer.positionText(C,z,D)):v=!0),d=0,v||(e=DvtNBoxRenderer.createText(a.getCtx(),b.label.text,DvtNBoxStyleUtils.getCellLabelStyle(a,u),w,DvtOutputText.V_ALIGN_MIDDLE),DvtTextUtils.fitText(e,t.getWidth()-m-n-A,s,c)&&(DvtNBoxDataUtils.setDisplayable(a,b,e,"label"),d=e.getDimensions().w,g=!0,w==DvtOutputText.H_ALIGN_CENTER?(m=(t.getWidth()-(h?-1:1)*A)/2,d=(h?-1:1)*(d+k)/2):w==DvtOutputText.H_ALIGN_RIGHT?(m=t.getWidth()-n-(h?0:1)*A,d=(h?-1:0)*(d+k)):(m+=(h?1:0)*A,d=(h?0:1)*(d+k)),
DvtNBoxRenderer.positionText(e,m,o+s/2))),C&&d&&DvtNBoxRenderer.positionText(C,z+d,D))}DvtNBoxCellRenderer._addAccessibilityAttributes(a,b,c);return g};
DvtNBoxCellRenderer.renderBodyCountLabels=function(a,b,c){for(var d=[],e=Number.MAX_VALUE,g=0;g<c.length;g++){var h=c[g],k=b.total[h],m=DvtNBoxDataUtils.getCell(a,h),h=m.__childArea,k=DvtNBoxRenderer.createText(a.getCtx(),""+k,DvtNBoxStyleUtils.getCellBodyCountLabelStyle(a),DvtOutputText.H_ALIGN_CENTER,DvtOutputText.V_ALIGN_MIDDLE);d.push(k);e=Math.min(e,k.getOptimalFontSize(h))}for(g=0;g<c.length;g++)d[g].setFontSize(e),h=c[g],m=DvtNBoxDataUtils.getCell(a,h),k=DvtNBoxDataUtils.getDisplayable(a,m),
h=m.__childArea,DvtTextUtils.fitText(d[g],h.w,h.h,k)&&(DvtNBoxCellRenderer.renderHeader(a,m,k,b,!0),DvtNBoxRenderer.positionText(d[g],h.x+h.w/2,h.y+h.h/2))};DvtNBoxCellRenderer._isLabelVertical=function(a,b){var c=DvtNBoxDataUtils.getMaximizedColumn(a),d=DvtNBoxDataUtils.getMaximizedRow(a);return c&&c!=b.column&&(!d||d==b.row)?!0:!1};
DvtNBoxCellRenderer.getCellDimensions=function(a,b,c,d,e){var g=a.getOptions().__layout.cellGap,h=DvtAgent.isRightToLeft(a.getCtx()),d=g+d.minimumCellSize,k=DvtNBoxDataUtils.getRowCount(a),g=DvtNBoxDataUtils.getColumnCount(a),m=DvtNBoxRenderer.getRowDimensions(a,b,e),n=DvtNBoxRenderer.getColumnDimensions(a,c,e),o=DvtNBoxDataUtils.getMaximizedRow(a),s=DvtNBoxDataUtils.getMaximizedColumn(a),t=n.x,u=m.y,n=n.w,m=m.h,v=!0;o&&(u=DvtNBoxDataUtils.getRowIndex(a,o),b<u?(u=e.y+e.h-(b+1)*d,m=d,v=!1):b==u?(u=
e.y+(k-b-1)*d,m=e.h-(k-1)*d):(u=e.y+(k-b-1)*d,m=d,v=!1));s&&v&&(a=DvtNBoxDataUtils.getColumnIndex(a,s),c<a?(n=d,t=e.x+(h?e.w-d:0)+(h?-1:1)*c*d):c==a?(n=e.w-(g-1)*d,t=e.x+(h?e.w-n:0)+(h?-1:1)*c*d):(n=d,t=e.x+(h?-d:e.w)+(h?1:-1)*(g-c)*d));return new DvtRectangle(t,u,n,m)};
DvtNBoxCellRenderer.calculateCellLayout=function(a,b){var c=a.getOptions(),d=c.__layout.cellTopGap,e=c.__layout.cellBottomGap,g=c.__layout.cellLabelGap,h=c.__layout.minimumCellSize,k=0,m=DvtNBoxDataUtils.getCell(a,0);if(m.label){var n=m.label.halign,k=DvtNBoxRenderer.createText(a.getCtx(),m.label.text,DvtNBoxStyleUtils.getCellLabelStyle(a,0),n,DvtOutputText.V_ALIGN_MIDDLE),k=DvtTextUtils.guessTextDimensions(k).h;"on"==m.showCount&&(m=DvtNBoxRenderer.createText(a.getCtx(),b.total[0],DvtNBoxStyleUtils.getCellCountLabelStyle(a),
n,DvtOutputText.V_ALIGN_MIDDLE),m=DvtTextUtils.guessTextDimensions(m).h,k=Math.max(k,m))}e=k+d+e;d=k+d+g;h=Math.max(e,h);h={labelHeight:k,headerSize:d,minimizedHeaderSize:e,minimumCellSize:h};return c.__layout.__cellLayout=h};
DvtNBoxCellRenderer.enableScrolling=function(a,b){var c=b.__childArea,d=new DvtScrollableContainer(a.getCtx(),c.w-10,c.h,c.w,c.h,0);d.setSkinName(a.getOptions().skin);d.setStyleMap(DvtNBoxStyleUtils.getScrollbarStyleMap(a));d.setTranslate(c.x,c.y);var e=DvtNBoxDataUtils.getDisplayable(a,b);e.removeChild(e.getChildContainer());e.addChild(d);e.setChildContainer(d);b.__childArea=new DvtRectangle(0,0,c.w-d.getScrollbarWidth(),c.h)};
DvtNBoxCellRenderer.animateUpdate=function(a,b,c){var d=a.getOldNBox(),e=a.getNewNBox(),g=new DvtCustomAnimation(e.getCtx(),c,a.getAnimationDuration()),h=c.getChildContainer(),k=h.getMatrix();h.setMatrix(DvtNBoxRenderer.getGlobalMatrix(h));var m=c.getParent();m.addChildAt(h,m.getChildIndex(c)+1);g.getAnimator().addProp(DvtAnimator.TYPE_MATRIX,c,c.getMatrix,c.setMatrix,c.getMatrix());c.setMatrix(b.getMatrix());d=DvtNBoxDataUtils.getDisplayable(d,b.getData(),"background");m=DvtNBoxDataUtils.getDisplayable(e,
c.getData(),"background");g.getAnimator().addProp(DvtAnimator.TYPE_FILL,m,m.getFill,m.setFill,m.getFill());m.setFill(d.getFill());g.getAnimator().addProp(DvtAnimator.TYPE_NUMBER,m,m.getWidth,m.setWidth,m.getWidth());m.setWidth(d.getWidth());g.getAnimator().addProp(DvtAnimator.TYPE_NUMBER,m,m.getHeight,m.setHeight,m.getHeight());m.setHeight(d.getHeight());if(c.isShowingKeyboardFocusEffect()&&(e=DvtNBoxDataUtils.getDisplayable(e,c.getData(),"focusEffect").getEffect()))g.getAnimator().addProp(DvtAnimator.TYPE_NUMBER,
e,e.getWidth,e.setWidth,e.getWidth()),e.setWidth(d.getWidth()+2),g.getAnimator().addProp(DvtAnimator.TYPE_NUMBER,e,e.getHeight,e.setHeight,e.getHeight()),e.setHeight(d.getHeight()+2);DvtNBoxCellRenderer._animateLabels(a,b,c,"countLabel");DvtNBoxCellRenderer._animateLabels(a,b,c,"label");DvtPlayable.appendOnEnd(g,function(){c.addChild(h);h.setMatrix(k)});a.add(g,DvtNBoxDataAnimationHandler.UPDATE)};
DvtNBoxCellRenderer._animateLabels=function(a,b,c,d){var e=a.getOldNBox(),g=a.getNewNBox(),h=DvtNBoxDataUtils.getDisplayable(e,b.getData(),d),d=DvtNBoxDataUtils.getDisplayable(g,c.getData(),d),b=DvtNBoxCellRenderer._isLabelVertical(e,b.getData()),c=DvtNBoxCellRenderer._isLabelVertical(g,c.getData());if(h||d)h&&d&&b==c?(g=new DvtCustomAnimation(g.getCtx(),d,a.getAnimationDuration()),g.getAnimator().addProp(DvtAnimator.TYPE_NUMBER,d,d.getX,d.setX,d.getX()),d.setX(h.getX()),g.getAnimator().addProp(DvtAnimator.TYPE_NUMBER,
d,d.getY,d.setY,d.getY()),d.setY(h.getY()),g.getAnimator().addProp(DvtAnimator.TYPE_MATRIX,d,d.getMatrix,d.setMatrix,d.getMatrix()),d.setMatrix(h.getMatrix()),a.add(g,DvtNBoxDataAnimationHandler.UPDATE)):(h&&(h.setMatrix(DvtNBoxRenderer.getGlobalMatrix(h)),g.getDeleteContainer().addChild(h),a.add(new DvtAnimFadeOut(g.getCtx(),h,a.getAnimationDuration()),DvtNBoxDataAnimationHandler.UPDATE)),d&&(d.setAlpha(0),a.add(new DvtAnimFadeIn(g.getCtx(),d,a.getAnimationDuration()),DvtNBoxDataAnimationHandler.UPDATE)))};
DvtNBoxCellRenderer.animateDelete=function(a,b){var c=a.getNewNBox(),d=b.getChildContainer();if(d){var e=DvtNBoxRenderer.getGlobalMatrix(d),g=b.getParent();g.addChildAt(d,g.getChildIndex(b)+1);d.setMatrix(e)}c.getDeleteContainer().addChild(b);a.add(new DvtAnimFadeOut(c.getCtx(),b,a.getAnimationDuration()),DvtNBoxDataAnimationHandler.UPDATE)};
DvtNBoxCellRenderer.animateInsert=function(a,b){var c=a.getNewNBox(),d=b.getChildContainer(),e=null;if(d){var e=d.getMatrix(),g=DvtNBoxRenderer.getGlobalMatrix(b),h=b.getParent();h.addChildAt(d,h.getChildIndex(b)+1);d.setMatrix(g)}b.setAlpha(0);c=new DvtAnimFadeIn(c.getCtx(),b,a.getAnimationDuration());d&&DvtPlayable.appendOnEnd(c,function(){b.addChild(d);d.setMatrix(e)});a.add(c,DvtNBoxDataAnimationHandler.UPDATE)};
DvtNBoxCellRenderer.renderDropSiteFeedback=function(a,b){var c=DvtNBoxDataUtils.getDisplayable(a,b.getData(),"background"),d=new DvtRect(a.getCtx(),c.getX(),c.getY(),c.getWidth(),c.getHeight());d.setPixelHinting(!0);var e=DvtNBoxStyleUtils.getCellDropTargetStyle(a);DvtNBoxCellRenderer._applyStyleToRect(d,e);b.addChildAt(d,b.getChildIndex(c)+1);return d};
DvtNBoxCellRenderer._applyStyleToRect=function(a,b){var c=b.getStyle(DvtCSSStyle.BACKGROUND),d=b.getStyle(DvtCSSStyle.BACKGROUND_COLOR);(c=c?c:d)&&DvtNBoxRenderer.setFill(a,c);"solid"==b.getStyle("border-style")&&(c=(c=b.getStyle(DvtCSSStyle.BORDER_COLOR))?c:"#000000",d=b.getStyle(DvtCSSStyle.BORDER_WIDTH),a.setSolidStroke(c,null,null==d?1:d))};
DvtNBoxCellRenderer._addAccessibilityAttributes=function(a,b,c){if(!DvtAgent.deferAriaCreation()){var d=c.getAriaLabel();d&&(a=DvtAgent.isTouchDevice()?DvtNBoxDataUtils.getDisplayable(a,b,"background"):c,a.setAriaRole("img"),a.setAriaProperty("label",d))}};var DvtNBoxNodeRenderer={};DvtObj.createSubclass(DvtNBoxNodeRenderer,DvtObj,"DvtNBoxNodeRenderer");
DvtNBoxNodeRenderer.render=function(a,b,c,d){DvtNBoxNodeRenderer._renderNodeBackground(a,b,c,d);DvtNBoxNodeRenderer._renderNodeIndicator(a,b,c,d);DvtNBoxNodeRenderer._renderNodeIcon(a,b,c,d);DvtNBoxNodeRenderer._renderNodeLabels(a,b,c,d);DvtNBoxNodeRenderer._addAccessibilityAttributes(a,c)};
DvtNBoxNodeRenderer.calculateNodeLayout=function(a){for(var b=a.getOptions(),c=b.__layout.gridGap,d=b.__layout.nodeStartLabelGap,e=b.__layout.nodeLabelOnlyStartLabelGap,g=b.__layout.nodeEndLabelGap,h=DvtNBoxNodeRenderer._calculateSimpleNodeLayout(a),k=h.nodeHeight,m=h.indicatorSectionWidth,n=h.iconSectionWidth,o=m||n?d:e,s=0,d=[],t=0,u=0,v=DvtNBoxDataUtils.getMaximizedRow(a),t=DvtNBoxDataUtils.getMaximizedColumn(a),s=DvtNBoxDataUtils.getRowCount(a),u=DvtNBoxDataUtils.getColumnCount(a),w=0;w<s;w++)for(var z=
0;z<u;z++)d.push({cellRows:0,cellColumns:0,overflow:!1});for(var e=[],A=DvtNBoxDataUtils.getNodeCount(a),w=0;w<A;w++)z=DvtNBoxDataUtils.getNode(a,w),z=DvtNBoxDataUtils.getCellIndex(a,z),isNaN(e[z])&&(e[z]=0),e[z]++;if(v&&t)s=null!=h.labelSectionWidth?h.labelSectionWidth:b.__layout.maximumLabelWidth+o+g,g=DvtNBoxDataUtils.getColumnIndex(a,t)+u*DvtNBoxDataUtils.getRowIndex(a,v),t=DvtNBoxDataUtils.getCell(a,g),v=t.__childArea,u=Math.floor((v.w+c)/(m+n+s+c)),0==u&&null==h.labelSectionWidth&&(o=v.w-m-
n,o>=b.__layout.minimumLabelWidth&&(s=o,u=Math.floor((v.w+c)/(m+n+s+c)))),o=Math.floor((v.h+c)/(k+c)),!isNaN(e[g])&&e[g]>u*o&&(DvtNBoxCellRenderer.enableScrolling(a,t),v=t.__childArea,u=Math.floor((v.w+c)/(m+n+s+c)),0==u&&null==h.labelSectionWidth&&(s=o=Math.max(0,v.w-m-n),u=Math.floor((v.w+c)/(m+n+s+c)))),d[g]={cellRows:-1,cellColumns:u,overflow:!1};else{A=[];if(v){s=DvtNBoxDataUtils.getRowIndex(a,v);for(z=0;z<u;z++)A.push(z+s*u)}else if(t){v=DvtNBoxDataUtils.getColumnIndex(a,t);for(w=0;w<s;w++)A.push(v+
w*u)}else for(s=0;s<d.length;s++)A.push(s);if(null!=h.labelSectionWidth)s=h.labelSectionWidth,t=DvtNBoxDataUtils.getCell(a,A[0]),v=t.__childArea,t=Math.floor((v.h+c)/(k+c)),u=Math.floor((v.w+c)/(m+n+s+c));else{for(v=h=0;v<A.length;v++)!isNaN(e[A[v]])&&e[A[v]]>e[h]&&(h=A[v]);t=DvtNBoxDataUtils.getCell(a,h);v=t.__childArea;a=Math.floor((v.h+c)/(k+c));u=Math.floor((v.w+c)/(m+n+b.__layout.minimumLabelWidth+o+g+c));if(a*u<e[h])s=Math.floor(Math.min(b.__layout.maximumLabelWidth+o+g,(v.w+c)/u-(m+n+c)));
else for(s=Math.floor(Math.min(b.__layout.maximumLabelWidth+o+g,(v.w+c)/u-(m+n+c)));s<b.__layout.maximumLabelWidth+o+g;)if((u-1)*a>=e[h])u--,s=Math.floor(Math.min(b.__layout.maximumLabelWidth+o+g,(v.w+c)/u-(m+n+c)));else break;t=a}for(v=0;v<A.length;v++)c=A[v],a=!1,e[c]>t*u&&(a=!0),d[c]={cellRows:t,cellColumns:u,overflow:a}}k={nodeHeight:k,indicatorSectionWidth:m,iconSectionWidth:n,labelSectionWidth:s,cellLayouts:d};return b.__layout.__nodeLayout=k};
DvtNBoxNodeRenderer.calculateNodeDrawerLayout=function(a,b){var c=a.getOptions(),d=c.__layout.gridGap,e=c.__layout.nodeStartLabelGap,g=c.__layout.nodeLabelOnlyStartLabelGap,h=c.__layout.nodeEndLabelGap,k=DvtNBoxNodeRenderer._calculateSimpleNodeLayout(a),m=k.nodeHeight,n=k.indicatorSectionWidth,o=k.iconSectionWidth,e=null!=k.labelSectionWidth?k.labelSectionWidth:c.__layout.maximumLabelWidth+(n||o?e:g)+h,h=b.__childArea,g=Math.floor(h.w/(n+o+e+d)),h=Math.floor(h.h/(m+d));DvtNBoxDataUtils.getCategoryNode(a,
b.id).nodeIndices.length>g*h&&(DvtNBoxDrawerRenderer.enableScrolling(a,b),h=b.__childArea,g=Math.floor(h.w/(n+o+e+d)));d={nodeHeight:m,indicatorSectionWidth:n,iconSectionWidth:o,labelSectionWidth:e,drawerLayout:{rows:-1,columns:g}};return c.__layout.__nodeDrawerLayout=d};
DvtNBoxNodeRenderer._calculateSimpleNodeLayout=function(a){var b=a.getOptions(),c=b.__layout.nodeIndicatorGap,d=b.__layout.nodeSingleLabelGap,e=b.__layout.nodeDualLabelGap,g=b.__layout.nodeInterLabelGap,h=b.__layout.nodeSwatchSize,k=DvtNBoxDataUtils.getNode(a,0),m=b=0,n=0,o=null,s=DvtNBoxDataUtils.getIndicator(a,k),t=DvtNBoxStyleUtils.getNodeIndicatorColor(a,k),u=DvtNBoxDataUtils.getIcon(a,k);s?(t=s.height*s.scaleY,m=s.width*s.scaleX+2*c,b=Math.max(b,t+2*c)):t&&(m=h);if(k.label)c=DvtNBoxRenderer.createText(a.getCtx(),
k.label.text,DvtNBoxStyleUtils.getNodeLabelStyle(a,k),DvtOutputText.H_ALIGN_LEFT,DvtOutputText.V_ALIGN_MIDDLE),c=DvtTextUtils.guessTextDimensions(c).h,b=Math.max(b,c+2*d),k.secondaryLabel&&(a=DvtNBoxRenderer.createText(a.getCtx(),k.secondaryLabel.text,DvtNBoxStyleUtils.getNodeSecondaryLabelStyle(a,k),DvtOutputText.H_ALIGN_LEFT,DvtOutputText.V_ALIGN_MIDDLE),a=DvtTextUtils.guessTextDimensions(a).h,b=Math.max(b,c+a+2*e+g));else if(o=0,k.color||DvtNBoxDataUtils.getAttributeGroup(a,k,"color"))if((!s||
DvtNBoxStyleUtils.getNodeIndicatorColor(a,k))&&(!u||u.source))o=m?m:h;u&&(n=Math.max(b,DvtAgent.isTouchDevice()?u.preferredSizeTouch:u.preferredSize),e=(u.source?u.sourcePaddingRatio:u.shapePaddingRatio)*n,g=(u.height?u.height:n-2*e)*u.scaleY,n=(u.width?u.width:n-2*e)*u.scaleX+2*e,b=Math.max(b,g+2*e));return{nodeHeight:b,indicatorSectionWidth:m,iconSectionWidth:n,labelSectionWidth:o}};
DvtNBoxNodeRenderer._renderNodeBackground=function(a,b,c,d){var e=d.indicatorSectionWidth+d.iconSectionWidth+d.labelSectionWidth,g=d.nodeHeight,d=DvtNBoxStyleUtils.getNodeBorderRadius(a),h=DvtNBoxStyleUtils.getNodeHoverColor(a),k=DvtNBoxStyleUtils.getNodeSelectionColor(a),m=new DvtRect(a.getCtx(),0,0,e,g);m.setFill(null);d&&(m.setRx(d),m.setRy(d));m.setHoverStroke(new DvtSolidStroke(h,null,2),new DvtSolidStroke(k,null,4));m.setSelectedStroke(new DvtSolidStroke(k,null,4),null);m.setSelectedHoverStroke(new DvtSolidStroke(h,
null,2),new DvtSolidStroke(k,null,6));c.addChild(m);c.setSelectionShape(m);e=new DvtRect(a.getCtx(),0,0,e,g);d&&(e.setRx(d),e.setRy(d));d=DvtNBoxStyleUtils.getNodeColor(a,b);e.setSolidFill(d);c.addChild(e);DvtNBoxDataUtils.setDisplayable(a,b,e,"background")};
DvtNBoxNodeRenderer._renderNodeIndicator=function(a,b,c,d){var e=DvtNBoxStyleUtils.getNodeColor(a,b),g=DvtColorUtils.getContrastingTextColor(e),h=DvtAgent.isRightToLeft(a.getCtx())?d.labelSectionWidth+d.iconSectionWidth:0,k=DvtNBoxStyleUtils.getNodeIndicatorColor(a,b);if(k){var g=DvtColorUtils.getContrastingTextColor(k),m=new DvtRect(a.getCtx(),h,0,d.indicatorSectionWidth,d.nodeHeight);m.setSolidFill(k);DvtNBoxNodeRenderer._clipIfNecessary(a,m,d);c.addChild(m);DvtNBoxDataUtils.setDisplayable(a,b,
m,"indicatorBackground")}if(k=DvtNBoxDataUtils.getIndicator(a,b))g=k.color?k.color:g,d=new DvtMarker(a.getCtx(),k.source?[k.source]:k.shape,DvtCSSStyle.SKIN_ALTA,h+(d.indicatorSectionWidth-k.width*k.scaleX)/2,(d.nodeHeight-k.height*k.scaleY)/2,k.width,k.height,null,k.scaleX,k.scaleY),"none"!=k.fillPattern?d.setFill(new DvtPatternFill(k.fillPattern,g,e)):d.setSolidFill(g),c.addChild(d),DvtNBoxDataUtils.setDisplayable(a,b,d,"indicatorMarker")};
DvtNBoxNodeRenderer._renderNodeIcon=function(a,b,c,d){var e=DvtNBoxStyleUtils.getNodeColor(a,b),g=DvtColorUtils.getContrastingTextColor(e),h=DvtAgent.isRightToLeft(a.getCtx()),k=DvtNBoxDataUtils.getIcon(a,b);if(k){var m=(k.source?k.sourcePaddingRatio:k.shapePaddingRatio)*d.nodeHeight,n=k.width?k.width:(d.iconSectionWidth-2*m)/k.scaleX,m=k.height?k.height:(d.nodeHeight-2*m)/k.scaleY,g=k.color?k.color:g,n=new DvtMarker(a.getCtx(),k.source?[k.source]:k.shape,DvtCSSStyle.SKIN_ALTA,d[h?"labelSectionWidth":
"indicatorSectionWidth"]+(d.iconSectionWidth-n*k.scaleX)/2,(d.nodeHeight-m*k.scaleY)/2,n,m,null,k.scaleX,k.scaleY);"none"!=k.fillPattern?n.setFill(new DvtPatternFill(k.fillPattern,g,e)):n.setSolidFill(g);(0==d.indicatorSectionWidth||0==d.labelSectionWidth)&&DvtNBoxNodeRenderer._clipIfNecessary(a,n,d);c.addChild(n)}DvtNBoxDataUtils.setDisplayable(a,b,n,"iconMarker")};
DvtNBoxNodeRenderer._renderNodeLabels=function(a,b,c,d){var e=a.getOptions(),g=e.__layout.nodeInterLabelGap,h=e.__layout.nodeLabelOnlyStartLabelGap,k=e.__layout.nodeStartLabelGap,e=e.__layout.nodeEndLabelGap,h=d.indicatorSectionWidth||d.iconSectionWidth?k:h,k=DvtNBoxStyleUtils.getNodeColor(a,b),k=DvtColorUtils.getContrastingTextColor(k),m=DvtAgent.isRightToLeft(a.getCtx()),n=m?DvtOutputText.H_ALIGN_RIGHT:DvtOutputText.H_ALIGN_LEFT,m=m?d.labelSectionWidth-h:d.indicatorSectionWidth+d.iconSectionWidth+
h;if(b.label){var o=DvtNBoxRenderer.createText(a.getCtx(),b.label.text,DvtNBoxStyleUtils.getNodeLabelStyle(a,b),n,DvtOutputText.V_ALIGN_MIDDLE),s=DvtTextUtils.guessTextDimensions(o).h;DvtTextUtils.fitText(o,d.labelSectionWidth-h-e,s,c)&&(DvtNBoxRenderer.positionText(o,m,d.nodeHeight/2),o.setSolidFill(k),DvtNBoxDataUtils.setDisplayable(a,b,o,"label"));if(b.secondaryLabel){var n=DvtNBoxRenderer.createText(a.getCtx(),b.secondaryLabel.text,DvtNBoxStyleUtils.getNodeSecondaryLabelStyle(a,b),n,DvtOutputText.V_ALIGN_MIDDLE),
t=DvtTextUtils.guessTextDimensions(n).h;DvtTextUtils.fitText(n,d.labelSectionWidth-h-e,t,c)&&(c=(d.nodeHeight-s-t-g)/2,DvtNBoxRenderer.positionText(o,m,c+s/2),DvtNBoxRenderer.positionText(n,m,c+s+g+t/2),n.setSolidFill(k),DvtNBoxDataUtils.setDisplayable(a,b,n,"secondaryLabel"))}}};
DvtNBoxNodeRenderer._clipIfNecessary=function(a,b,c){if(a=DvtNBoxStyleUtils.getNodeBorderRadius(a)){var d=c.indicatorSectionWidth+c.iconSectionWidth+c.labelSectionWidth,c=c.nodeHeight,e=new DvtClipPath;e.addRect(0,0,d,c,a,a);b.setClipPath(e)}};
DvtNBoxNodeRenderer.animateUpdate=function(a,b,c){var d=a.getOldNBox(),e=a.getNewNBox(),g=DvtNBoxRenderer.getGlobalMatrix(b),h=DvtNBoxRenderer.getGlobalMatrix(c),k=c.getMatrix(),m=c.getParent();b.setAlpha(0);a.getNewNBox().addChild(c);c.setMatrix(g);g=new DvtAnimMoveTo(c.getCtx(),c,new DvtPoint(h.getTx(),h.getTy()),a.getAnimationDuration());DvtPlayable.appendOnEnd(g,function(){m.addChild(c);c.setMatrix(k)});a.add(g,DvtNBoxDataAnimationHandler.UPDATE);g=new DvtCustomAnimation(e.getCtx(),c,a.getAnimationDuration());
DvtNBoxNodeRenderer._animateFill(g,d,e,b,c,"background");DvtNBoxNodeRenderer._animateFill(g,d,e,b,c,"label");DvtNBoxNodeRenderer._animateFill(g,d,e,b,c,"secondaryLabel");DvtNBoxNodeRenderer._animateFill(g,d,e,b,c,"indicatorBackground");DvtNBoxNodeRenderer._animateFill(g,d,e,b,c,"indicatorMarker");DvtNBoxNodeRenderer._animateFill(g,d,e,b,c,"iconMarker");a.add(g,DvtNBoxDataAnimationHandler.UPDATE)};
DvtNBoxNodeRenderer._animateFill=function(a,b,c,d,e,g){b=DvtNBoxDataUtils.getDisplayable(b,d.getData(),g);c=DvtNBoxDataUtils.getDisplayable(c,e.getData(),g);b&&c&&(a.getAnimator().addProp(DvtAnimator.TYPE_FILL,c,c.getFill,c.setFill,c.getFill()),c.setFill(b.getFill()))};
DvtNBoxNodeRenderer.animateDelete=function(a,b){var c=DvtNBoxDataAnimationHandler.DELETE,d=a.getOldNBox(),e=a.getNewNBox(),g=b.getData().id,g=DvtNBoxDataUtils.getNodeIndex(e,g);if(!isNaN(g)&&(g=DvtNBoxDataUtils.getNode(e,g),!DvtNBoxDataUtils.isNodeHidden(e,g))){var c=DvtNBoxDataAnimationHandler.UPDATE,h=DvtNBoxDataUtils.getGroupBy(e);if(h&&0<h.length&&(h=e.getOptions().__groups,DvtNBoxDataUtils.getGroupBehavior(e)==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL&&(h=h[DvtNBoxDataUtils.getCellIndex(e,
g)]),g=h[DvtNBoxDataUtils.getNodeGroupId(e,g)]))if(g=DvtNBoxDataUtils.getDisplayable(e,g))g=DvtNBoxRenderer.getGlobalMatrix(g),d=d.getOptions().__layout.__nodeLayout,d=new DvtPoint((d.indicatorSectionWidth+d.iconSectionWidth+d.labelSectionWidth)/2,d.nodeHeight/2),a.add(new DvtAnimMoveTo(e.getCtx(),b,new DvtPoint(g.getTx()-d.x,g.getTy()-d.y),a.getAnimationDuration()),c)}b.setMatrix(DvtNBoxRenderer.getGlobalMatrix(b));e.getDeleteContainer().addChild(b);a.add(new DvtAnimFadeOut(e.getCtx(),b,a.getAnimationDuration()),
c)};
DvtNBoxNodeRenderer.animateInsert=function(a,b){var c=DvtNBoxDataAnimationHandler.INSERT,d=a.getOldNBox(),e=a.getNewNBox(),g=b.getData().id,g=DvtNBoxDataUtils.getNodeIndex(d,g);if(!isNaN(g)&&(g=DvtNBoxDataUtils.getNode(d,g),!DvtNBoxDataUtils.isNodeHidden(d,g))){var c=DvtNBoxDataAnimationHandler.UPDATE,h=DvtNBoxDataUtils.getGroupBy(d);if(h&&0<h.length&&(h=d.getOptions().__groups,DvtNBoxDataUtils.getGroupBehavior(d)==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL&&(h=h[DvtNBoxDataUtils.getCellIndex(d,g)]),
g=h[DvtNBoxDataUtils.getNodeGroupId(d,g)]))if(g=DvtNBoxDataUtils.getDisplayable(d,g)){var k=b.getMatrix(),m=b.getParent(),d=DvtNBoxRenderer.getGlobalMatrix(b),g=DvtNBoxRenderer.getGlobalMatrix(g),h=e.getOptions().__layout.__nodeLayout,h=new DvtPoint((h.indicatorSectionWidth+h.iconSectionWidth+h.labelSectionWidth)/2,h.nodeHeight/2);g.translate(-h.x,-h.y);e.addChild(b);b.setMatrix(g);d=new DvtAnimMoveTo(e.getCtx(),b,new DvtPoint(d.getTx(),d.getTy()),a.getAnimationDuration());DvtPlayable.appendOnEnd(d,
function(){b.setMatrix(k);m.addChild(b)});a.add(d,c)}}b.setAlpha(0);e=new DvtAnimFadeIn(e.getCtx(),b,a.getAnimationDuration());a.add(e,c)};DvtNBoxNodeRenderer._addAccessibilityAttributes=function(a,b){if(!DvtAgent.deferAriaCreation()){var c=b.getAriaLabel();c&&(b.setAriaRole("img"),b.setAriaProperty("label",c))}};var DvtNBoxCategoryNodeRenderer={};DvtObj.createSubclass(DvtNBoxCategoryNodeRenderer,DvtObj,"DvtNBoxCategoryNodeRenderer");
DvtNBoxCategoryNodeRenderer.render=function(a,b,c,d,e){DvtNBoxCategoryNodeRenderer._renderNodeBackground(a,b,c,d,e);var g=DvtNBoxCategoryNodeRenderer._renderNodeIndicator(a,b,c,d,e);DvtNBoxCategoryNodeRenderer._renderNodeCount(a,b,c,d,g,e);DvtNBoxCategoryNodeRenderer._addAccessibilityAttributes(a,c)};
DvtNBoxCategoryNodeRenderer._renderNodeBackground=function(a,b,c,d,e){b.__scale=d;b.__gap=e;var e=DvtNBoxCategoryNodeRenderer.getSideLength(b),d=DvtNBoxStyleUtils.getNodeBorderRadius(a),g=DvtNBoxStyleUtils.getNodeHoverColor(a),h=DvtNBoxStyleUtils.getNodeSelectionColor(a),k=new DvtRect(a.getCtx(),-e/2,-e/2,e,e);k.setFill(null);d&&(k.setRx(d),k.setRy(d));k.setHoverStroke(new DvtSolidStroke(g,null,2),new DvtSolidStroke(h,null,4));k.setSelectedStroke(new DvtSolidStroke(h,null,4),null);k.setSelectedHoverStroke(new DvtSolidStroke(g,
null,2),new DvtSolidStroke(h,null,6));c.addChild(k);c.setSelectionShape(k);e=new DvtRect(a.getCtx(),-e/2,-e/2,e,e);d&&(e.setRx(d),e.setRy(d));a=DvtNBoxStyleUtils.getCategoryNodeColor(a,b);e.setSolidFill(a);c.addChild(e)};DvtNBoxCategoryNodeRenderer.getSideLength=function(a){return a.__scale*Math.sqrt(a.nodeIndices.length)-a.__gap};
DvtNBoxCategoryNodeRenderer._renderNodeIndicator=function(a,b,c,d,e){var g=!1,h=a.getOptions().__layout.markerGap,k=DvtAgent.isRightToLeft(a.getCtx()),e=d*Math.sqrt(b.nodeIndices.length)-e,d=DvtNBoxStyleUtils.getCategoryNodeColor(a,b),m=DvtColorUtils.getContrastingTextColor(d),n=e/4,o=1,s=k?e/2-n:-e/2;(k=DvtNBoxStyleUtils.getStyledCategoryIndicator(a,b))&&(o=Math.min(n/(k.width*k.scaleX+2*h),e/(k.height*k.scaleY+2*h)));if(b=DvtNBoxStyleUtils.getCategoryNodeIndicatorColor(a,b))m=DvtColorUtils.getContrastingTextColor(b),
g=new DvtRect(a.getCtx(),s,-e/2,n,e),g.setSolidFill(b),c.addChild(g),g=!0;k&&(g=k.color?k.color:m,a=new DvtMarker(a.getCtx(),k.shape,DvtCSSStyle.SKIN_ALTA,s+(n-o*k.width*k.scaleX)/2,-e/2+(e-o*k.height*k.scaleY)/2,k.width,k.height,null,o*k.scaleX,o*k.scaleY),"none"!=k.fillPattern?a.setFill(new DvtPatternFill(k.fillPattern,g,d)):a.setSolidFill(g),c.addChild(a),g=!0);return g};
DvtNBoxCategoryNodeRenderer._renderNodeCount=function(a,b,c,d,e,g){var h=a.getOptions().__layout.categoryNodeLabelGap,k=DvtAgent.isRightToLeft(a.getCtx()),m=DvtNBoxStyleUtils.getFadedNodeAlpha(a),n;if(DvtNBoxDataUtils.getHighlightedItems(a)){if(n=b.highlightedCount,0==n){c.setMaxAlpha(m);return}}else n=b.nodeIndices.length;d=d*Math.sqrt(b.nodeIndices.length)-g;e=e?0.75*d:d;k=(k?-1:1)*(d-e)/2;b=DvtNBoxStyleUtils.getCategoryNodeColor(a,b);b=DvtColorUtils.getContrastingTextColor(b);g=new DvtRectangle(0,
0,e-2*h,d-2*h);a=DvtNBoxRenderer.createText(a.getCtx(),""+n,DvtNBoxStyleUtils.getCategoryNodeLabelStyle(a),DvtOutputText.H_ALIGN_CENTER,DvtOutputText.V_ALIGN_MIDDLE);n=a.getOptimalFontSize(g);a.setFontSize(n);DvtTextUtils.fitText(a,e-2*h,d-2*h,c)&&(DvtNBoxRenderer.positionText(a,k,0),a.setSolidFill(b))};
DvtNBoxCategoryNodeRenderer.animateUpdate=function(a,b,c){var d=DvtNBoxRenderer.getGlobalMatrix(b),e=DvtNBoxRenderer.getGlobalMatrix(c),g=c.getMatrix(),h=c.getParent();b.setAlpha(0);a.getNewNBox().addChild(c);c.setMatrix(d);b=new DvtAnimMoveTo(c.getCtx(),c,new DvtPoint(e.getTx(),e.getTy()),a.getAnimationDuration());DvtPlayable.appendOnEnd(b,function(){h.addChild(c);c.setMatrix(g)});a.add(b,DvtNBoxDataAnimationHandler.UPDATE)};
DvtNBoxCategoryNodeRenderer.animateDelete=function(a,b){var c=DvtNBoxDataAnimationHandler.UPDATE,d=a.getOldNBox(),e=a.getNewNBox();DvtNBoxCategoryNodeRenderer.isMaximizeEqual(d,e)&&DvtNBoxCategoryNodeRenderer.isGroupingEqual(d,e)&&(c=DvtNBoxDataAnimationHandler.DELETE);d=new DvtAnimScaleTo(e.getCtx(),b,new DvtPoint(0.01,0.01),a.getAnimationDuration());a.add(d,c);d=new DvtAnimFadeOut(e.getCtx(),b,a.getAnimationDuration());a.add(d,c);b.setMatrix(DvtNBoxRenderer.getGlobalMatrix(b));e.getDeleteContainer().addChild(b)};
DvtNBoxCategoryNodeRenderer.animateInsert=function(a,b){var c=DvtNBoxDataAnimationHandler.UPDATE,d=a.getOldNBox(),e=a.getNewNBox();DvtNBoxCategoryNodeRenderer.isMaximizeEqual(d,e)&&DvtNBoxCategoryNodeRenderer.isGroupingEqual(d,e)&&(c=DvtNBoxDataAnimationHandler.INSERT);b.setScaleX(0.01);b.setScaleY(0.01);d=new DvtAnimScaleTo(e.getCtx(),b,new DvtPoint(1,1),a.getAnimationDuration());a.add(d,c);b.setAlpha(0);e=new DvtAnimFadeIn(e.getCtx(),b,a.getAnimationDuration());a.add(e,c)};
DvtNBoxCategoryNodeRenderer.isGroupingEqual=function(a,b){var c=DvtNBoxDataUtils.getGroupBehavior(a),d=DvtNBoxDataUtils.getGroupBehavior(b),e=DvtNBoxDataUtils.getGroupBy(a),g=DvtNBoxDataUtils.getGroupBy(b),h=!1;if(c==d&&e&&g&&e.length==g.length){h=!0;for(c=0;c<g.length;c++)if(g[c]!=e[c]){h=!1;break}}return h};
DvtNBoxCategoryNodeRenderer.isMaximizeEqual=function(a,b){var c=DvtNBoxDataUtils.getMaximizedRow(a),d=DvtNBoxDataUtils.getMaximizedColumn(a),e=DvtNBoxDataUtils.getMaximizedRow(b),g=DvtNBoxDataUtils.getMaximizedColumn(b);return c==e&&d==g};DvtNBoxCategoryNodeRenderer._addAccessibilityAttributes=function(a,b){if(!DvtAgent.deferAriaCreation()){var c=b.getAriaLabel();c&&(b.setAriaRole("img"),b.setAriaProperty("label",c))}};var DvtNBoxDrawerRenderer={};
DvtObj.createSubclass(DvtNBoxDrawerRenderer,DvtObj,"DvtNBoxDrawerRenderer");DvtNBoxDrawerRenderer.render=function(a,b,c,d){d=DvtNBoxDrawerRenderer.getDrawerBounds(a,b,d);b.__drawerBounds=d;c.setTranslate(d.x,d.y);d=new DvtKeyboardFocusEffect(a.getCtx(),c,new DvtRectangle(-1,-1,d.w+2,d.h+2));DvtNBoxDataUtils.setDisplayable(a,b,d,"focusEffect");DvtNBoxDrawerRenderer._renderHeader(a,b,c);DvtNBoxDrawerRenderer._renderBody(a,b,c);DvtNBoxDrawerRenderer._addAccessibilityAttributes(a,b,c)};
DvtNBoxDrawerRenderer._renderHeader=function(a,b,c){var d=a.getOptions(),e=d.__layout.drawerButtonGap,g=d.__layout.drawerStartGap,h=d.__layout.drawerLabelGap,k=d.__layout.drawerCountHorizontalGap,m=d.__layout.drawerCountVerticalGap,n=d.__layout.drawerHeaderHeight,o=d.__layout.nodeIndicatorGap,s=d.__layout.nodeSwatchSize,t=DvtAgent.isRightToLeft(a.getCtx()),u=DvtNBoxDataUtils.getCategoryNode(a,b.id),v=u.nodeIndices.length,b=b.__drawerBounds,w=DvtNBoxStyleUtils.getDrawerBorderRadius(a),z=DvtNBoxStyleUtils.getDrawerBorderColor(a),
w=DvtPathUtils.roundedRectangle(0,0,b.w,n,w,w,0,0),w=new DvtPath(a.getCtx(),w);w.setSolidStroke(z);z=DvtNBoxStyleUtils.getDrawerHeaderBackground(a);DvtNBoxRenderer.setFill(w,z);c.addChild(w);var A=d.resources.close_ena,w=d.resources.close_ovr,C=d.resources.close_dwn,d=A.width,z=A.height,A=new DvtImage(a.getCtx(),A.src,0,0,A.width,A.height),w=new DvtImage(a.getCtx(),w.src,0,0,w.width,w.height),C=new DvtImage(a.getCtx(),C.src,0,0,C.width,C.height),w=new DvtButton(a.getCtx(),A,w,C,null,null,c.closeDrawer,
c);w.setTranslate(t?e:b.w-e-d,n/2-z/2);c.addChild(w);var z=DvtNBoxStyleUtils.getCategoryNodeColor(a,u),w=DvtColorUtils.getContrastingTextColor(z),A=(C=DvtNBoxStyleUtils.getCategoryNodeIndicatorColor(a,u))?DvtColorUtils.getContrastingTextColor(C):w,D=DvtNBoxStyleUtils.getStyledCategoryIndicator(a,u),B=s,E=1;if(D)var G=D.width*D.scaleX,E=s/(D.height*D.scaleY),B=E*G,A=D.color?D.color:A;var F=DvtNBoxStyleUtils.getDrawerCountBorderRadius(a),G=t?DvtOutputText.H_ALIGN_RIGHT:DvtOutputText.H_ALIGN_LEFT,v=
DvtNBoxRenderer.createText(a.getCtx(),""+v,DvtNBoxStyleUtils.getDrawerCountLabelStyle(a),G,DvtOutputText.V_ALIGN_MIDDLE),K=v.measureDimensions(),m=K.h+2*m,B=D?B+2*o:C?s:0,K=K.w+2*k,o=B+K,s=DvtPathUtils.roundedRectangle(0,0,o,m,F,F,F,F),s=new DvtPath(a.getCtx(),s);s.setSolidFill(z);c.addChild(s);var J=t?K:0;0<B&&(C&&(F=DvtPathUtils.roundedRectangle(J,0,B,m,t?0:F,t?F:0,t?F:0,t?0:F),F=new DvtPath(a.getCtx(),F),F.setSolidFill(C),s.addChild(F)),D&&(E=new DvtMarker(a.getCtx(),D.shape,DvtCSSStyle.SKIN_ALTA,
J+(B-E*D.width*D.scaleX)/2,(m-E*D.height*D.scaleY)/2,D.width,D.height,null,E*D.scaleX,E*D.scaleY),"none"!=D.fillPattern?E.setFill(new DvtPatternFill(D.fillPattern,A,C?C:z)):E.setSolidFill(A),s.addChild(E)));s.addChild(v);v.setSolidFill(w);DvtNBoxRenderer.positionText(v,t?K-k:B+k,m/2);k=DvtNBoxDataUtils.getDisplayable(a,u).getCategoryLabel();a=DvtNBoxRenderer.createText(a.getCtx(),k,DvtNBoxStyleUtils.getDrawerLabelStyle(a),G,DvtOutputText.V_ALIGN_MIDDLE);k=0;DvtTextUtils.fitText(a,b.w-g-h-o-e-d,n,
c)&&(DvtNBoxRenderer.positionText(a,t?b.w-g:g,n/2),k=a.measureDimensions().w+h);s.setTranslate(t?b.w-g-o-k:g+k,(n-m)/2)};
DvtNBoxDrawerRenderer._renderBody=function(a,b,c){var d=a.getOptions(),e=d.__layout.gridGap,g=d.__layout.drawerHeaderHeight,h=b.__drawerBounds,d=DvtAgent.isRightToLeft(a.getCtx()),k=DvtNBoxStyleUtils.getDrawerBorderRadius(a),m=DvtNBoxStyleUtils.getDrawerBorderColor(a),k=DvtPathUtils.roundedRectangle(0,g,h.w,h.h-g,0,0,k,k),k=new DvtPath(a.getCtx(),k);DvtNBoxRenderer.setFill(k,DvtNBoxStyleUtils.getDrawerBackground(a));k.setSolidStroke(m);c.addChild(k);DvtNBoxDataUtils.setDisplayable(a,b,k,"background");
b.__childArea=new DvtRectangle(0,g,h.w,h.h-g);g=new DvtContainer(a.getCtx());c.addChild(g);c.setChildContainer(g);var c=DvtNBoxNodeRenderer.calculateNodeDrawerLayout(a,b),g=c.indicatorSectionWidth+c.iconSectionWidth+c.labelSectionWidth+e,h=c.nodeHeight+e,m=0,n=["normal"],k=DvtNBoxStyleUtils.getFadedNodeAlpha(a),o=DvtNBoxDataUtils.getHighlightedItems(a),s={};if(o){for(n=0;n<o.length;n++)s[o[n].id]=!0;n=["highlighted","unhighlighted"]}for(var o=DvtNBoxDataUtils.getCategoryNode(a,b.id),t=o.nodeIndices.length,
u=0;u<n.length;u++)for(var v=0;v<t;v++){var w=DvtNBoxDataUtils.getNode(a,o.nodeIndices[v]);if("normal"==n[u]||"highlighted"==n[u]&&s[w.id]||"unhighlighted"==n[u]&&!s[w.id]){var w=DvtNBoxNode.newInstance(a,w),z=b.__childArea.x+(b.__childArea.w-c.drawerLayout.columns*g)/2,A=b.__childArea.y,C=m%c.drawerLayout.columns;d&&(C=c.drawerLayout.columns-C-1);w.setTranslate(z+e/2+g*C,A+e/2+h*Math.floor(m/c.drawerLayout.columns));m++;w.render(DvtNBoxDataUtils.getDisplayable(a,b).getChildContainer(),c);"unhighlighted"==
n[u]&&w.setMaxAlpha(k)}}};
DvtNBoxDrawerRenderer.getDrawerBounds=function(a,b,c){var d=a.getOptions(),e=d.__layout.gridGap,d=d.__layout.__cellLayout,g=new DvtRectangle(c.x+e/2,c.y+e/2,c.w-e,c.h-e);DvtNBoxDataUtils.getGroupBehavior(a)==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL&&(b=parseInt(b.id.substring(0,b.id.indexOf(":"))),DvtNBoxDataUtils.isCellMaximized(a,b)&&(g=DvtNBoxDataUtils.getCell(a,b),b=DvtNBoxDataUtils.getRowIndex(a,g.row),g=DvtNBoxDataUtils.getColumnIndex(a,g.column),a=DvtNBoxCellRenderer.getCellDimensions(a,b,
g,d,c),g=new DvtRectangle(a.x+e/2,a.y+e/2+d.headerSize,a.w-e,a.h-d.headerSize-e)));return g};
DvtNBoxDrawerRenderer.enableScrolling=function(a,b){var c=b.__childArea,d=new DvtScrollableContainer(a.getCtx(),c.w-10,c.h,c.w,c.h,0);d.setSkinName(a.getOptions().skin);d.setStyleMap(DvtNBoxStyleUtils.getScrollbarStyleMap(a));d.setTranslate(c.x,c.y);var e=DvtNBoxDataUtils.getDisplayable(a,b);e.removeChild(e.getChildContainer());e.addChild(d);e.setChildContainer(d);b.__childArea=new DvtRectangle(0,0,c.w-d.getScrollbarWidth(),c.h)};DvtNBoxDrawerRenderer.animateUpdate=function(){console.log("********************* DvtNBoxDrawerRenderer.animateUpdate *********************")};
DvtNBoxDrawerRenderer.animateDelete=function(a,b){var c=DvtNBoxDataAnimationHandler.UPDATE,d=a.getNewNBox(),e=b.getData().__drawerBounds,g=b.getData().id,h=DvtNBoxDataUtils.getCategoryNode(d,g);if(h){var g=DvtNBoxCategoryNodeRenderer.getSideLength(h),k=g/e.w,e=g/e.h;if(h=DvtNBoxDataUtils.getDisplayable(d,h))h=DvtNBoxRenderer.getGlobalMatrix(h),g=new DvtMatrix(k,0,0,e,h.getTx()-g/2,h.getTy()-g/2),k=new DvtCustomAnimation(d.getCtx(),b,a.getAnimationDuration()),k.getAnimator().addProp(DvtAnimator.TYPE_MATRIX,
b,b.getMatrix,b.setMatrix,g),a.add(k,c)}d.getDeleteContainer().addChild(b);d=new DvtAnimFadeOut(d.getCtx(),b,a.getAnimationDuration());a.add(d,c)};
DvtNBoxDrawerRenderer.animateInsert=function(a,b){var c=DvtNBoxDataAnimationHandler.UPDATE,d=a.getNewNBox(),e=b.getData().__drawerBounds,g=b.getData().id,h=DvtNBoxDataUtils.getCategoryNode(d,g);if(h){var g=DvtNBoxCategoryNodeRenderer.getSideLength(h),k=g/e.w,e=g/e.h;if(h=DvtNBoxDataUtils.getDisplayable(d,h)){h=DvtNBoxRenderer.getGlobalMatrix(h);g=new DvtMatrix(k,0,0,e,h.getTx()-g/2,h.getTy()-g/2);k=new DvtCustomAnimation(d.getCtx(),b,a.getAnimationDuration());k.getAnimator().addProp(DvtAnimator.TYPE_MATRIX,
b,b.getMatrix,b.setMatrix,b.getMatrix());var m=b.getParent();d.addChild(b);DvtPlayable.appendOnEnd(k,function(){m.addChild(b)});b.setMatrix(g);a.add(k,c)}}b.setAlpha(0);d=new DvtAnimFadeIn(d.getCtx(),b,a.getAnimationDuration());a.add(d,c)};DvtNBoxDrawerRenderer._addAccessibilityAttributes=function(a,b,c){if(!DvtAgent.deferAriaCreation()){var d=c.getAriaLabel();d&&(a=DvtAgent.isTouchDevice()?DvtNBoxDataUtils.getDisplayable(a,b,"background"):c,a.setAriaRole("img"),a.setAriaProperty("label",d))}};
var DvtNBoxDataUtils={};DvtObj.createSubclass(DvtNBoxDataUtils,DvtObj,"DvtNBoxDataUtils");
DvtNBoxDataUtils.processDataObject=function(a){var b=a.getOptions(),c=b[DvtNBoxConstants.CELLS],d={};if(c)for(var e=0;e<c.length;e++){var g=c[e],h=g.row;d[h]||(d[h]={});var k=g.column;d[h][k]=g}for(var g=[],e={},c={},m=0;m<DvtNBoxDataUtils.getRowCount(a);m++)h=DvtNBoxDataUtils.getRow(a,m),e[h.value]=m;b.__rowMap=e;for(var n=0;n<DvtNBoxDataUtils.getColumnCount(a);n++)k=DvtNBoxDataUtils.getColumn(a,n),c[k.value]=n;b.__columnMap=c;for(m=0;m<DvtNBoxDataUtils.getRowCount(a);m++){h=DvtNBoxDataUtils.getRow(a,
m);h=h.value;for(n=0;n<DvtNBoxDataUtils.getColumnCount(a);n++)k=DvtNBoxDataUtils.getColumn(a,n),k=k.value,d[h]&&d[h][k]?g.push(d[h][k]):g.push({row:h,column:k})}b[DvtNBoxConstants.CELLS]=g;d={};for(h=0;h<DvtNBoxDataUtils.getNodeCount(a);h++)k=DvtNBoxDataUtils.getNode(a,h),d[k.id]=h;b.__nodeMap=d;DvtNBoxDataUtils.getGroupBy(a)&&DvtNBoxDataUtils.getGroupBehavior(a)==DvtNBoxConstants.GROUP_BEHAVIOR_ACROSS_CELLS&&(b[DvtNBoxConstants.MAXIMIZED_ROW]=null,DvtNBoxDataUtils.fireSetPropertyEvent(a,DvtNBoxConstants.MAXIMIZED_ROW,
null),b[DvtNBoxConstants.MAXIMIZED_COLUMN]=null,DvtNBoxDataUtils.fireSetPropertyEvent(a,DvtNBoxConstants.MAXIMIZED_COLUMN,null));if(b[DvtNBoxConstants.MAXIMIZED_ROW]&&isNaN(e[b[DvtNBoxConstants.MAXIMIZED_ROW]])||b[DvtNBoxConstants.MAXIMIZED_COLUMN]&&isNaN(c[b[DvtNBoxConstants.MAXIMIZED_COLUMN]]))b[DvtNBoxConstants.MAXIMIZED_ROW]=null,DvtNBoxDataUtils.fireSetPropertyEvent(a,DvtNBoxConstants.MAXIMIZED_ROW,null),b[DvtNBoxConstants.MAXIMIZED_COLUMN]=null,DvtNBoxDataUtils.fireSetPropertyEvent(a,DvtNBoxConstants.MAXIMIZED_COLUMN,
null);if("auto"==b[DvtNBoxConstants.LEGEND_DISPLAY]){var o="color,iconFill,iconShape,iconPattern,indicatorColor,indicatorFill,indicatorShape,indicatorPattern".split(",");if(d=b[DvtNBoxConstants.ATTRIBUTE_GROUPS]){d=d.slice(0);d.sort(function(a,b){return DvtArrayUtils.getIndex(o,a.type)-DvtArrayUtils.getIndex(o,b.type)});(c=b[DvtNBoxConstants.HIDDEN_CATEGORIES])||(c=[]);for(e=c.length-1;0<=e;e--){k=c[e].substring(0,c[e].indexOf(":"));g=!1;for(h=0;h<d.length;h++)if(d[h].id==k){g=!0;break}g||c.splice(e,
1)}b[DvtNBoxConstants.HIDDEN_CATEGORIES]=0==c.length?null:c;DvtNBoxDataUtils.fireSetPropertyEvent(a,DvtNBoxConstants.HIDDEN_CATEGORIES,b[DvtNBoxConstants.HIDDEN_CATEGORIES]);a={hideAndShowBehavior:"on"};a.textStyle=b.styleDefaults.legend.itemStyle;a.layout={markerSize:16,rowGap:6};k=[];a.sections=k;for(e=0;e<d.length;e++){g=d[e];m={};m.id=g.id;m.title=g.label;m.titleStyle=b.styleDefaults.legend.sectionStyle;var n=g.groups,s=[];m.items=s;for(h=0;h<n.length;h++){var t=n[h],u={};u.id=g.id+":"+t.id;-1!=
DvtArrayUtils.getIndex(c,u.id)&&(u.categoryVisibility="hidden");u.text=t.label;t.color&&(u.color=t.color);t.indicatorColor&&(u.color=t.indicatorColor);u.color||(u.color=b.styleDefaults.legend.markerColor);t.shape&&(u.markerShape=t.shape);t.pattern&&(u.pattern=t.pattern);s.push(u)}k.push(m)}b.__legend=a}else b[DvtNBoxConstants.HIDDEN_CATEGORIES]=null,DvtNBoxDataUtils.fireSetPropertyEvent(a,DvtNBoxConstants.HIDDEN_CATEGORIES,null)}};DvtNBoxDataUtils.getColumnCount=function(a){return a.getOptions()[DvtNBoxConstants.COLUMNS].length};
DvtNBoxDataUtils.getRowCount=function(a){return a.getOptions()[DvtNBoxConstants.ROWS].length};DvtNBoxDataUtils.getColumn=function(a,b){return a.getOptions()[DvtNBoxConstants.COLUMNS][b]};DvtNBoxDataUtils.getRow=function(a,b){return a.getOptions()[DvtNBoxConstants.ROWS][b]};DvtNBoxDataUtils.getMaximizedRow=function(a){return a.getOptions()[DvtNBoxConstants.MAXIMIZED_ROW]};DvtNBoxDataUtils.getMaximizedColumn=function(a){return a.getOptions()[DvtNBoxConstants.MAXIMIZED_COLUMN]};
DvtNBoxDataUtils.getRowIndex=function(a,b){return a.getOptions().__rowMap[b]};DvtNBoxDataUtils.getColumnIndex=function(a,b){return a.getOptions().__columnMap[b]};DvtNBoxDataUtils.getCell=function(a,b){return a.getOptions()[DvtNBoxConstants.CELLS][b]};DvtNBoxDataUtils.getNodeCount=function(a){return a.getOptions()[DvtNBoxConstants.NODES]?a.getOptions()[DvtNBoxConstants.NODES].length:0};DvtNBoxDataUtils.getNode=function(a,b){return a.getOptions()[DvtNBoxConstants.NODES][b]};
DvtNBoxDataUtils.getNodeIndex=function(a,b){return a.getOptions().__nodeMap[b]};DvtNBoxDataUtils.getCellIndex=function(a,b){var c=DvtNBoxDataUtils.getRowIndex(a,b.row),d=DvtNBoxDataUtils.getColumnIndex(a,b.column),e=DvtNBoxDataUtils.getColumnCount(a);return d+c*e};DvtNBoxDataUtils.getIcon=function(a,b){return b.icon?DvtNBoxStyleUtils.getStyledIcon(a,b,b.icon):null};DvtNBoxDataUtils.getIndicator=function(a,b){return b.indicator?DvtNBoxStyleUtils.getStyledIndicator(a,b,b.indicator):null};
DvtNBoxDataUtils.getSelectedItems=function(a){return a.getOptions()[DvtNBoxConstants.SELECTED_ITEMS]};DvtNBoxDataUtils.setSelectedItems=function(a,b){a.getOptions()[DvtNBoxConstants.SELECTED_ITEMS]=b};DvtNBoxDataUtils.getHighlightedItems=function(a){return a.getOptions()[DvtNBoxConstants.HIGHLIGHTED_ITEMS]};
DvtNBoxDataUtils.getAttributeGroup=function(a,b,c){var b=b.categories,d=a.getOptions()[DvtNBoxConstants.ATTRIBUTE_GROUPS];if(b&&d)for(var e=0;e<b.length;e++)for(var a=b[e].split(":"),g=0;g<d.length;g++){var h=d[g];if(a[0]==h.id&&c==h.type){c=h.groups;for(b=0;b<c.length;b++)if(d=c[b],d.id==a[1])return d;return null}}return null};DvtNBoxDataUtils.getGroupBy=function(a){return a.getOptions()[DvtNBoxConstants.GROUP_BY]};DvtNBoxDataUtils.getGroupBehavior=function(a){return a.getOptions()[DvtNBoxConstants.GROUP_BEHAVIOR]};
DvtNBoxDataUtils.getNodeGroupId=function(a,b){for(var c="",d=DvtNBoxDataUtils.getGroupBy(a),e=b.categories,g=0;g<d.length;g++)for(var h=0;h<e.length;h++)if(e[h].split(":")[0]==d[g]){c+=e[h]+";";break}return c.slice(0,-1)};DvtNBoxDataUtils.getXPercentage=function(a,b){if(!isNaN(b.xPercentage))return b.xPercentage;var c=DvtNBoxDataUtils.getColumnCount(a);return(DvtNBoxDataUtils.getColumnIndex(a,b.column)+0.5)/c};
DvtNBoxDataUtils.getYPercentage=function(a,b){if(!isNaN(b.yPercentage))return b.yPercentage;var c=DvtNBoxDataUtils.getRowCount(a);return(DvtNBoxDataUtils.getRowIndex(a,b.row)+0.5)/c};DvtNBoxDataUtils.getOtherThreshold=function(a){return a.getOptions()[DvtNBoxConstants.OTHER_THRESHOLD]};DvtNBoxDataUtils.getOtherColor=function(a){return a.getOptions()[DvtNBoxConstants.OTHER_COLOR]};DvtNBoxDataUtils.getDrawer=function(a){return a.getOptions()[DvtNBoxConstants.DRAWER]};
DvtNBoxDataUtils.getCategoryNode=function(a,b){var c=DvtNBoxDataUtils.getGroupBehavior(a),d=a.getOptions().__groups,e=b;c==DvtNBoxConstants.GROUP_BEHAVIOR_WITHIN_CELL&&(c=b.substring(0,b.indexOf(":")),e=b.substring(b.indexOf(":")+1),d=d[c]);return d?d[e]:null};DvtNBoxDataUtils.setDisplayable=function(a,b,c,d){a=a.getDisplayables();d=d?"__displayable:"+d:"__displayable";b[d]?a[b[d]]=c:(b[d]=a.length,a.push(c))};
DvtNBoxDataUtils.getDisplayable=function(a,b,c){b=b[c?"__displayable:"+c:"__displayable"];a=a.getDisplayables();return null==b?null:a[b]};DvtNBoxDataUtils.isCellMinimized=function(a,b){var c=DvtNBoxDataUtils.getMaximizedRow(a),d=DvtNBoxDataUtils.getMaximizedColumn(a);if(!c&&!d)return!1;var e=DvtNBoxDataUtils.getCell(a,b),g=e.row,e=e.column;return c&&d?c!=g||d!=e:c!=g&&d!=e};
DvtNBoxDataUtils.isCellMaximized=function(a,b){var c=DvtNBoxDataUtils.getMaximizedRow(a),d=DvtNBoxDataUtils.getMaximizedColumn(a),e=DvtNBoxDataUtils.getCell(a,b),g=e.column;return c==e.row&&d==g};
DvtNBoxDataUtils.getCategoryLabel=function(a,b,c){for(var d=a.getOptions()[DvtNBoxConstants.ATTRIBUTE_GROUPS],e,g=[],h=0;h<d.length;h++){var k=d[h];if(c==k.id){g.push(k.label);e=k.groups;break}}d=b.categories;for(h=0;h<d.length;h++)if(b=d[h].split(":"),b[0]==c){for(h=0;h<e.length;h++)if(c=e[h],b[1]==c.id){g.push(c.label);break}break}return g[1]?g[0]?a.getBundle().getTranslatedString("COLON_SEP_LIST",g):g[1]:null};DvtNBoxDataUtils.getLegend=function(a){return a.getOptions().__legend};
DvtNBoxDataUtils.isNodeHidden=function(a,b){var c=a.getOptions()[DvtNBoxConstants.HIDDEN_CATEGORIES];if(c){var d=b.categories;if(d)for(var e=0;e<d.length;e++)if(-1!=DvtArrayUtils.getIndex(c,d[e]))return!0}return!1};DvtNBoxDataUtils.fireSetPropertyEvent=function(a,b,c){var d=new DvtSetPropertyEvent;d.addParam(b,c);a.processEvent(d)};
DvtNBoxDataUtils.getMaximizedCellIndex=function(a){var b=null,c=DvtNBoxDataUtils.getMaximizedRow(a),d=DvtNBoxDataUtils.getMaximizedColumn(a);c&&d&&(b=DvtNBoxDataUtils.getColumnCount(a),b=DvtNBoxDataUtils.getColumnIndex(a,d)+b*DvtNBoxDataUtils.getRowIndex(a,c));return b};
DvtNBoxDataUtils.isDrawerSelected=function(a,b){var c=!1,d=DvtNBoxDataUtils.getSelectedItems(a);if(d){for(var e={},c=0;c<d.length;c++)e[d[c].id]=!0;for(var d=b.getData().nodeIndices,c=!0,g=0;g<d.length;g++){var h=DvtNBoxDataUtils.getNode(a,d[g]);if(!e[h.id]){c=!1;break}}}return c};
DvtNBoxDataUtils.buildAriaDesc=function(a,b,c,d){c=b instanceof DvtNBoxCategoryNode||b instanceof DvtNBoxDrawer?a.getBundle().getTranslatedString("COLON_SEP_LIST",[a.getBundle().getTranslatedString("GROUP_NODE"),c]):c;d=d?a.getBundle().getTranslatedString("STATE_SELECTED"):a.getBundle().getTranslatedString("STATE_UNSELECTED");b=(b=b instanceof DvtNBoxCategoryNode?a.getBundle().getTranslatedString("STATE_COLLAPSED"):b instanceof DvtNBoxDrawer?a.getBundle().getTranslatedString("STATE_EXPANDED"):null)?
a.getBundle().getTranslatedString("COMMA_SEP_LIST",[b,d]):d;return a.getBundle().getTranslatedString("COLON_SEP_LIST",[c,b])};var DvtNBoxStyleUtils={};DvtObj.createSubclass(DvtNBoxStyleUtils,DvtObj,"DvtNBoxStyleUtils");DvtNBoxStyleUtils.getAnimationOnDisplay=function(a){a=a.getOptions().animationOnDisplay;"auto"==a&&(a=DvtBlackBoxAnimationHandler.ALPHA_FADE);return a};DvtNBoxStyleUtils.getAnimationOnDataChange=function(a){return a.getOptions().animationOnDataChange};
DvtNBoxStyleUtils.getAnimationDuration=function(a){return a.getOptions().styleDefaults.animationDuration/1E3};DvtNBoxStyleUtils.getColumnLabelStyle=function(a,b){var c=a.getOptions().styleDefaults.columnLabelStyle,d=DvtNBoxDataUtils.getColumn(a,b);return d.label&&d.label.style?DvtJSONUtils.merge(new DvtCSSStyle(d.label.style),c):c};
DvtNBoxStyleUtils.getRowLabelStyle=function(a,b){var c=a.getOptions().styleDefaults.rowLabelStyle,d=DvtNBoxDataUtils.getRow(a,b);return d.label&&d.label.style?DvtJSONUtils.merge(new DvtCSSStyle(d.label.style),c):c};DvtNBoxStyleUtils.getCellStyle=function(a,b){var c=a.getOptions(),d=DvtNBoxDataUtils.isCellMinimized(a,b)?"minimizedStyle":"style",c=c.styleDefaults.cell[d],e=DvtNBoxDataUtils.getCell(a,b);return e[d]?DvtJSONUtils.merge(new DvtCSSStyle(e[d]),c):c};
DvtNBoxStyleUtils.getCellLabelStyle=function(a,b){var c=a.getOptions().styleDefaults.cell.labelStyle,d=DvtNBoxDataUtils.getCell(a,b);return d.label&&d.label.style?DvtJSONUtils.merge(new DvtCSSStyle(d.label.style),c):c};DvtNBoxStyleUtils.getCellCountLabelStyle=function(a){return a.getOptions().styleDefaults.cell.countLabelStyle};DvtNBoxStyleUtils.getCellBodyCountLabelStyle=function(a){return a.getOptions().styleDefaults.cell.bodyCountLabelStyle};DvtNBoxStyleUtils.getCellDropTargetStyle=function(a){return a.getOptions().styleDefaults.cell.dropTargetStyle};
DvtNBoxStyleUtils.getNodeLabelStyle=function(a,b){var c=a.getOptions().styleDefaults.node.labelStyle;return b.label&&b.label.style?DvtJSONUtils.merge(new DvtCSSStyle(b.label.style),c):c};DvtNBoxStyleUtils.getNodeSecondaryLabelStyle=function(a,b){var c=a.getOptions().styleDefaults.node.secondaryLabelStyle;return b.secondaryLabel&&b.secondaryLabel.style?DvtJSONUtils.merge(new DvtCSSStyle(b.secondaryLabel.style),c):c};
DvtNBoxStyleUtils.getNodeColor=function(a,b){if(b.color)return b.color;var c=DvtNBoxDataUtils.getAttributeGroup(a,b,"color");return c?c.color:a.getOptions().styleDefaults.node.color};DvtNBoxStyleUtils.getNodeIndicatorColor=function(a,b){if(b.indicatorColor)return b.indicatorColor;var c=DvtNBoxDataUtils.getAttributeGroup(a,b,"indicatorColor");return c?c.indicatorColor:null};
DvtNBoxStyleUtils.getStyledIcon=function(a,b,c){var d={},e=DvtNBoxDataUtils.getAttributeGroup(a,b,"iconShape");e&&(d.shape=e.shape);(e=DvtNBoxDataUtils.getAttributeGroup(a,b,"iconFill"))&&(d.color=e.color);(b=DvtNBoxDataUtils.getAttributeGroup(a,b,"iconPattern"))&&(d.fillPattern=b.pattern);c=DvtJSONUtils.merge(c,d);return c=DvtJSONUtils.merge(c,a.getOptions().styleDefaults.node.icon)};
DvtNBoxStyleUtils.getStyledIndicator=function(a,b,c){var d={},e=DvtNBoxDataUtils.getAttributeGroup(a,b,"indicatorShape");e&&(d.shape=e.shape);(e=DvtNBoxDataUtils.getAttributeGroup(a,b,"indicatorFill"))&&(d.color=e.color);(b=DvtNBoxDataUtils.getAttributeGroup(a,b,"indicatorPattern"))&&(d.fillPattern=b.pattern);c=DvtJSONUtils.merge(c,d);return c=DvtJSONUtils.merge(c,a.getOptions().styleDefaults.node.indicator)};DvtNBoxStyleUtils.getFadedNodeAlpha=function(a){return a.getOptions().styleDefaults.node.alphaFade};
DvtNBoxStyleUtils.getScrollbarStyleMap=function(a){return a.getOptions().styleDefaults.scrollbar};DvtNBoxStyleUtils.getCategoryNodeColor=function(a,b){var c=DvtNBoxDataUtils.getAttributeGroup(a,b,"color");return c?c.color:b.otherNode?DvtNBoxDataUtils.getOtherColor(a):a.getOptions().styleDefaults.node.color};DvtNBoxStyleUtils.getCategoryNodeIndicatorColor=function(a,b){var c=DvtNBoxDataUtils.getAttributeGroup(a,b,"indicatorColor");return c?c.indicatorColor:null};
DvtNBoxStyleUtils.getStyledCategoryIndicator=function(a,b){var c={},d=DvtNBoxDataUtils.getAttributeGroup(a,b,"indicatorShape");d&&(c.shape=d.shape);var e=DvtNBoxDataUtils.getAttributeGroup(a,b,"indicatorFill");e&&(c.color=e.color);var g=DvtNBoxDataUtils.getAttributeGroup(a,b,"indicatorPattern");g&&(c.fillPattern=g.pattern);return!d&&!e&&!g?null:DvtJSONUtils.merge(c,a.getOptions().styleDefaults.node.indicator)};DvtNBoxStyleUtils.getDrawerBackground=function(a){return a.getOptions().styleDefaults.drawer.background};
DvtNBoxStyleUtils.getDrawerHeaderBackground=function(a){return a.getOptions().styleDefaults.drawer.headerBackground};DvtNBoxStyleUtils.getDrawerBorderColor=function(a){return a.getOptions().styleDefaults.drawer.borderColor};DvtNBoxStyleUtils.getDrawerBorderRadius=function(a){return a.getOptions().styleDefaults.drawer.borderRadius};DvtNBoxStyleUtils.getDrawerLabelStyle=function(a){return a.getOptions().styleDefaults.drawer.labelStyle};DvtNBoxStyleUtils.getDrawerCountLabelStyle=function(a){return a.getOptions().styleDefaults.drawer.countLabelStyle};
DvtNBoxStyleUtils.getDrawerCountBorderRadius=function(a){return a.getOptions().styleDefaults.drawer.countBorderRadius};DvtNBoxStyleUtils.getCategoryNodeLabelStyle=function(a){return a.getOptions().styleDefaults.categoryNode.labelStyle};DvtNBoxStyleUtils.getNodeBorderRadius=function(a){return a.getOptions().styleDefaults.node.borderRadius};DvtNBoxStyleUtils.getNodeHoverColor=function(a){return a.getOptions().styleDefaults.node.hoverColor};DvtNBoxStyleUtils.getNodeSelectionColor=function(a){return a.getOptions().styleDefaults.node.selectionColor};
DvtNBoxStyleUtils.getHalign=function(a,b){var c=b.halign,d=DvtAgent.isRightToLeft(a.getCtx());return"end"==c?d?DvtOutputText.H_ALIGN_LEFT:DvtOutputText.H_ALIGN_RIGHT:"center"==c?DvtOutputText.H_ALIGN_CENTER:d?DvtOutputText.H_ALIGN_RIGHT:DvtOutputText.H_ALIGN_LEFT};